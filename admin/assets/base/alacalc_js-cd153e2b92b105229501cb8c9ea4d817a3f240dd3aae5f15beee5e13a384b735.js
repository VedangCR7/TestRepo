function RecipeData(){this.traffic_light_limits={Lipid_Tot:[3,17.5],FA_Sat:[1.5,5],Sugar_Tot:[5,22.5],Salt:[.3,1.5]},this.traffic_light_portion_limit={Lipid_Tot:[-1,21],FA_Sat:[-1,6],Sugar_Tot:[-1,27],Salt:[-1,1.8]},this.traffic_light_drink_limits={Lipid_Tot:[1.5,8.75],FA_Sat:[.75,2.5],Sugar_Tot:[2.5,11.25],Salt:[.3,.75]},this.traffic_light_drink_portion_limit={Lipid_Tot:[-1,10.5],FA_Sat:[-1,3],Sugar_Tot:[-1,13.5],Salt:[-1,.9]}}function InputFields(t){this.recipe_data=t,$("body").bind("targets_changed",function(){this.redraw()}.bind(this))}function create_new_target_field(t,n,e){var r="de"==e?"weniger als":"less than",i="de"==e?"mehr als":"more than",a="de"==e?"gleich":"equal to",o="de"==e?"Ziel hinzuf\xfcgen":"Add goal",u="<div class='col-lg-3'>";u+="<select id='new_target_form_nutrient' class='form-control input-sm'>";for(var s=0;s<nutrients.length;s++)nutrient=nutrients[s],u+="<option value='"+nutrient+"'>"+("de"==e?translate_de[nutrient]:translate[nutrient])+" in "+nutrient_unit[nutrient]+"</option>";u+="</select>",u+="</div>",u+="<div class='col-lg-3'>",u+="<select id='new_target_form_op' class='form-control input-sm'>",u+="<option value='less than'>"+r+"</option>",u+="<option value='more than'>"+i+"</option>",u+="<option value='equal to'>"+a+"</option>",u+="</select>",u+="</div>",u+="<div class='col-lg-3'>",u+="<input id='new_target_form_val' min='0' class='form-control input-sm'>",u+="</div>",u+="<div class='col-lg-3'>",u+='<input type="submit" value="'+o+'" class="btn btn-sm btn-default" />',u+="</div>",$("<form/>",{html:u,id:"new_target_form","class":"form-horizontal",role:"form"}).appendTo("#new_target"),$("#new_target_form").submit(function(){var t=$("#new_target_form_nutrient").val(),n=$("#new_target_form_op").val(),e=$("#new_target_form_val").val();return t in targets||(targets[t]=[]),targets[t].push([n,e]),$("body").trigger("targets_changed"),!1})}function update_targets(s){function n(t,n){return"less than"==n[0]?s.nutritional_value_per_serving(t)<=n[1]:"equal to"==n[0]?Math.abs(s.nutritional_value_per_serving(t)-n[1])<.2:"more than"==n[0]&&s.nutritional_value_per_serving(t)>=n[1]}$.each(targets,function(u,t){$.each(t,function(a,o){n(u,o)?($("#header_"+u+a).css("color","green"),s.ingredient_items.map(function(t){$("#target_"+u+a+"_ing_"+t.id).html("")})):($("#header_"+u+a).css("color","red"),s.ingredient_items.map(function(t,n){if(0<s.nutritional_value_of_ingredient_per_serving(t,u)){orig_quantity=t.quantity;var e=parseFloat(orig_quantity);do{var r=s.nutritional_value_per_serving(u)-o[1],i=s.derivative_of_nutritional_value_per_serving_wrt_ingredient_quantity(t,u);if(console.log("Gradient for "+t.ingredient.Long_Desc+" is "+i),e=Math.max(0,e-r/i),t.quantity=e,10<++n)break}while(1e-12<i);t.quantity=orig_quantity,e<=.1?$("#target_"+u+a+"_ing_"+t.id).html("Set to 0 "+t.quantity_unit.desc):e<orig_quantity?$("#target_"+u+a+"_ing_"+t.id).html("Decrease to "+format_number(e-.1,digits=1)+" "+t.quantity_unit.desc):100<e-orig_quantity?$("#target_"+u+a+"_ing_"+t.id).html("Increase by more than 100 "+t.quantity_unit.desc):$("#target_"+u+a+"_ing_"+t.id).html("Increase to "+format_number(e+.1,digits=1)+" "+t.quantity_unit.desc)}else $("#target_"+u+a+"_ing_"+t.id).html("--")}))})})}function Plot(t){this.plot_functions={"traffic-lights-combined":create_traffic_light_combined_plot,"traffic-light-bars":create_traffic_light_bar_plot,"traffic-lights":create_traffic_light_plot,"traffic-light-pies":create_traffic_light_pie_plot,"declaration-names":create_declaration_names_plot,fda:create_fda_plot,pies:create_pie_plot,targets:create_target_plot,"fda-svg":create_fda_svg_plot,"eu-svg":create_eu_svg_plot,"de-svg":create_de_svg_plot,"de-breakdown-svg":create_de_breakdown_svg_plot},this.recipe_data=t,this.current_style=undefined;var n=this;$("body").bind("targets_changed",function(){n.redraw()})}function create_traffic_light_plot(e,r,t){t==undefined&&(t="#viz"),$(t).find(".graph-section-label").css({position:"absolute",display:"inline-block",left:20,top:40,width:100,"font-weight":"bold","font-size":"18px"});var n=100,i=100,a=5,o=5,u=d3.select(t).append("div").attr("style","display: inline").attr("class","traffic-light-chart").append("svg").attr({width:n,height:i,"text-anchor":"middle"}),s=u.append("rect").attr({x:a,y:o,rx:10,ry:10,r:0,width:n-2*a,height:i-2*o,fill:"#939598"});u.append("text").attr({x:n/2,y:.1*i+15}).text(translate[r]).style({"font-size":"13px","font-weight":"bold"});var l=u.append("text").attr("x",n/2).attr("y",.3*i+15).style("font-size","16px");if(e.traffic_light_limits[r]!=undefined){u.append("rect").attr("x",2*a).attr("y",.5*i).attr("rx",2).attr("ry",2).attr("width",n-4*a).attr("height",20).attr("fill","white");var c=u.append("text").attr("x",n/2).attr("y",.5*i+15).style({"font-size":"13px","font-weight":"bold"})}var f=["red","orange","green"],h=function(){var t=e.traffic_light_color(r);f.indexOf(t);t!=undefined&&(s.attr("fill",t[0]),c.text(t[1]));var n=e.nutritional_value_per_serving(r);l.text(format_number(n)+nutrient_unit[r])};h(),$("body").bind("ingredient_values_changed",function(){h()})}function create_target_plot(n,r){function i(){return[[format_number(n.nutritional_value_per_serving(r)),nutrient_unit[r]]]}var a=function(){return n.ingredient_items.map(function(t){return[{x:0,y:n.nutritional_value_of_ingredient_per_serving(t,r),dbid:t.id}]})},t=170,e=200,o=d3.select("#viz").append("svg").attr("class","chart").attr("width",t).attr("height",e).append("g").attr("transform","translate(10,180)"),u=d3.scale.ordinal().rangeRoundBands([0,t-10]),s=d3.scale.linear().range([0,e-50]),l=color_code,c=d3.layout.stack()(a());u.domain(c[0].map(function(t){return t.x}));var f=[];f.push(d3.max(c[c.length-1],function(t){return t.y0+t.y})),targets[r]&&f.push.apply(f,targets[r].map(function(t){return t[1]})),s.domain([0,Math.max.apply(Math,f)]);var h=o.selectAll("g.valgroup").data(c).enter().append("g").attr("class","valgroup").style("fill",function(t,n){return l(n)}),g=h.selectAll("rect").data(function(t){return t}).enter().append("rect").attr("x",function(t){return u(t.x)}).attr("y",function(t){return-s(t.y0)-s(t.y)}).attr("height",function(t){return s(t.y)}).attr("width",u.rangeBand()-20).attr("class",function(t){return"ing_"+t.dbid}).on("mouseover",function(t){d3.selectAll("rect").transition().duration(400).attr("fill-opacity",.3),d3.selectAll(".ing_"+t.dbid).transition().duration(400).attr("fill-opacity",1),$(".input_ing").css("opacity",.2),$(".input_ing_"+t.dbid).css("opacity",1)}).on("mouseout",function(){d3.selectAll("rect").transition().duration(400).attr("fill-opacity",1),$(".input_ing").css("opacity",1)}),d=o.selectAll("text").data(i()).enter().append("text").text(function(t){return t.join(" ")}).attr("text-anchor","middle").attr("x",function(t,n){return(n+.5)*u.rangeBand()}).attr("y",function(){return 18}),p=function(){return translate[r]},_=d3.svg.axis().scale(u).tickSize(0).tickFormat(p).orient("bottom");o.append("g").attr("class","x axis").call(_);var v=o.append("svg:defs");v.append("svg:marker").attr("id","green_arrow").attr("viewBox","0 0 10 10").attr("refX","0").attr("refY","5").attr("markerUnits","strokeWidth").attr("markerWidth","9").attr("markerHeight","5").attr("orient","auto").append("svg:path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("fill","green"),v.append("svg:marker").attr("id","orange_arrow").attr("viewBox","0 0 10 10").attr("refX","0").attr("refY","5").attr("markerUnits","strokeWidth").attr("markerWidth","9").attr("markerHeight","5").attr("orient","auto").append("svg:path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("fill","orange"),v.append("svg:marker").attr("id","red_arrow").attr("viewBox","0 0 10 10").attr("refX","0").attr("refY","5").attr("markerUnits","strokeWidth").attr("markerWidth","9").attr("markerHeight","5").attr("orient","auto").append("svg:path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("fill","red"),v.append("svg:marker").attr("id","target_arrow").attr("viewBox","0 0 10 10").attr("refX","0").attr("refY","5").attr("markerUnits","strokeWidth").attr("markerWidth","9").attr("markerHeight","5").attr("orient","auto").append("svg:path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("fill","black");var y=new Array;if(targets[r])for(var m=0;m<targets[r].length;m++)y[m]=o.append("line").attr("x1",u.rangeBand()).attr("y1",-s(targets[r][m][1])).attr("x2",u.rangeBand()-1).attr("y2",-s(targets[r][m][1])).attr("marker-end",function(){return"url(#target_arrow)"}).style("stroke","black").style("stroke-width",4);$("body").bind("ingredient_values_changed",function(){var t=d3.layout.stack()(a());h.data(t),u.domain(t[0].map(function(t){return t.x}));var n=[];if(n.push(d3.max(t[t.length-1],function(t){return t.y0+t.y})),targets[r]&&n.push.apply(n,targets[r].map(function(t){return t[1]})),s.domain([0,Math.max.apply(Math,n)]),g.data(function(t){return t}).transition().duration(50).attr("y",function(t){return-s(t.y0)-s(t.y)}).attr("height",function(t){return s(t.y)}),d.data(i()).text(function(t){return t.join(" ")}),targets[r])for(var e=0;e<y.length;e++)y[e].attr("y1",-s(targets[r][e][1])).attr("y2",-s(targets[r][e][1]))})}function create_pie_plot(n,e){$("#viz").find(".graph-section-label").css({position:"absolute",display:"inline-block",left:20,top:20,width:100,"font-weight":"bold","font-size":"18px"});var t=100,r=100,a=5,o=Math.min(t,r)/2-a,u=d3.svg.arc().outerRadius(o-10).innerRadius(0),s=d3.layout.pie().value(function(t){return n.nutritional_value_of_ingredient_per_serving(t,e)}),l=d3.select("#viz").append("div").attr("style","display: inline").attr("class","pie-chart").append("svg").attr("width",t).attr("height",r).append("g").attr("transform","translate("+t/2+","+r/2+")").selectAll("g.valgroup").data(s(n.ingredient_items)).enter().append("g").attr("class",function(t){return"arc ing_"+t.data.id}).on("mouseover",function(t){d3.selectAll(".arc").transition().duration(400).attr("fill-opacity",.1),d3.selectAll(".ing_"+t.data.id).transition().duration(400).attr("fill-opacity",1),$(".input_ing").css("opacity",.2),$(".input_ing_"+t.data.id).css("opacity",1)}).on("mouseout",function(){d3.selectAll(".arc").transition().duration(400).attr("fill-opacity",1),$(".input_ing").css("opacity",1)}).append("path").attr("d",u).attr("fill",function(t){return i=n.ingredient_items.indexOf(t.data),color_code(i)});$("body").bind("ingredient_values_changed",function(){(l=l.data(s(n.ingredient_items))).attr("d",u)})}function create_traffic_light_bar_plot(u,s,t){t==undefined&&(t="#viz"),$(t).find(".graph-section-label").css({position:"absolute",display:"inline-block",left:20,top:20,width:100,"font-weight":"bold","font-size":"18px"});var l=100,c=100,f=38,r=20,h=0,i=d3.select(t).append("div").attr("style","display: inline").attr("class","traffic-light-bar-chart").append("svg:svg").attr("width",l).attr("height",c);if(u.has_traffic_light_color(s)){var n=["#ef4044","#faa61c","#82c55b"],g=["red","orange","green"];$.each(n,function(t,n){var e=t*(c-2*h)/3;i.append("rect").attr("x",f).attr("y",h+e).attr("width",l-f-r).attr("height",(c-2*h)/3).attr("fill",n).append("svg:g")}),$.each([1,2],function(t,n){var e=n*(c-2*h)/3,r=u.traffic_light_limits[s][2-n];i.append("text").attr({"text-anchor":"end",x:f-1,y:h+e+5}).text(r+"g").style("font-size","10px")});var e=1,d=6,p=i.append("polygon").style({"stroke-width":e,stroke:"black","padding-top":0}).attr({opacity:.7,fill:"black"}),a=function(){var t,n,e=u.traffic_light_color(s)[0],r=u.nutritional_value_per_100g(s),i=2-g.indexOf(e);t=0==i?0:u.traffic_light_limits[s][i-1],n=2==i?2*t:u.traffic_light_limits[s][i];var a=Math.min(1,(r-t)/(n-t)),o=c-2*h-(i+a)*((c-2*h)/3);p.attr("points",f+","+o+" "+(l-10)+","+o+" "+l+","+(o-d)+" "+l+","+(o+d)+" "+(l-10)+","+o)};a(),$("body").bind("ingredient_values_changed",function(){a()})}}function create_traffic_light_pie_plot(t,n){create_traffic_light_plot(t,n,"#viz_top"),create_traffic_light_bar_plot(t,n,"#viz_middle"),create_pie_plot(t,n);var e=10;parseInt($(".traffic-light-chart").width()),parseInt($(".traffic-light-bar-chart").width()),parseInt($(".pie-chart").width());$(".viz-content").css({padding:"0 20px 0 135px",width:"660px"}),$(".viz-content:first").css({"padding-top":"20px"}),$(".viz-content:last").css({"padding-bottom":"20px"});var r=$("#graph-background").height();$(".inner").attr("height",r-2*e)}function create_traffic_light_combined_plot(t,n){create_traffic_light_plot(t,n,"#viz_top"),create_traffic_light_bar_plot(t,n,"#viz_middle")}function create_declaration_names_plot(e,r){function u(t){var e=!1;return 0<=$.inArray("gluten",t)&&0<=t.toString().indexOf("gluten_from")&&(e=!0),new_allergens=new Array,$.each(t,function(t,n){"gluten"!=(n=(n=n.replace(/^\s/,"")).replace("gluten_from_",""))?new_allergens.push(n):e||new_allergens.push(n)}),new_allergens}function i(t,e){return found=!1,$.each(t,function(t,n){JSON.stringify(n)===JSON.stringify(e)&&(found=!0)}),found}function a(t){return unique_array=[],$.each(t,function(t,n){i(unique_array,n)||unique_array.push(n)}),unique_array}function s(t){var r="",i=!1;return $.each(t,function(t,n){i?r+=", ":i=!0;var a=n.name.capitalize();if(allergens=n.allergens,allergens!=undefined){allergens=u(allergens);var o=new Array;if($.each(allergens,function(t,n){var e=a.toLowerCase().indexOf(n.toLowerCase());if(0==e||1<e&&" "==a[e-1]||1<e&&"("==a[e-1]&&")"==a[e+n.length]){var r=new RegExp(n,"ig"),i="<b>"+n.capitalize()+"</b>";a=a.replace(r,i)}else o.push(n)}),0<o.length){var e=o.join(", ");a+=" (<b>"+e.capitalize()+"</b>)"}}r+=a,"sub_names"in n&&(r+=" ("+s(n.sub_names)+")")}),r}r==undefined&&(r="#viz");var t=function(){var t=e.declaration_names(),n=s(t=a(t));window.location.href.includes("locale=de")&&(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=n.replace(/(<b>[^<]*)(Celery)([^<]*<\/b>)/g,"$1Sellerie$3")).replace(/(<b>[^<]*)(Crustaceans)([^<]*<\/b>)/g,"$1Krustentiere$3")).replace(/(<b>[^<]*)(Dioxide)([^<]*<\/b>)/g,"$1Dioxyd$3")).replace(/(<b>[^<]*)(Egg)([^<]*<\/b>)/g,"$1Ei$3")).replace(/(<b>[^<]*)(Fish)([^<]*<\/b>)/g,"$1Fisch$3")).replace(/(<b>[^<]*)(Gluten)([^<]*<\/b>)/g,"$1Gluten$3")).replace(/(<b>[^<]*)(Barley)([^<]*<\/b>)/g,"$1Gerste$3")).replace(/(<b>[^<]*)(Millet)([^<]*<\/b>)/g,"$1Hirse$3")).replace(/(<b>[^<]*)(Oats)([^<]*<\/b>)/g,"$1Hafer$3")).replace(/(<b>[^<]*)(Rye)([^<]*<\/b>)/g,"$1Roggen$3")).replace(/(<b>[^<]*)(Wheat)([^<]*<\/b>)/g,"$1Weizen$3")).replace(/(<b>[^<]*)(Lupin)([^<]*<\/b>)/g,"$1Lupine$3")).replace(/(<b>[^<]*)(Milk)([^<]*<\/b>)/g,"$1Milch$3")).replace(/(<b>[^<]*)(Molluscs)([^<]*<\/b>)/g,"$1Weichtiere$3")).replace(/(<b>[^<]*)(Mustard)([^<]*<\/b>)/g,"$1Senf$3")).replace(/(<b>[^<]*)(Nuts)([^<]*<\/b>)/g,"$1N&uuml;sse$3")).replace(/(<b>[^<]*)(Peanuts)([^<]*<\/b>)/g,"$1Erd&uuml;sse$3")).replace(/(<b>[^<]*)(Sesame)([^<]*<\/b>)/g,"$1Sesam$3")).replace(/(<b>[^<]*)(Soya)([^<]*<\/b>)/g,"$1Soja$3")).replace(/(<b>[^<]*)(Sulphites)([^<]*<\/b>)/g,"$1Sulfite$3")),$(r).html(n+".")};$("body").bind("ingredient_values_changed",function(){t()}),t()}function create_fda_plot(M,t,n){n==undefined&&(n="#viz"),$("head").append("<link>"),$("head").children(":last").attr({rel:"stylesheet",type:"text/css",href:"alacalc-fda-label.css"});var e=function(){var t=M.serving_size("oz");$("#serving_size").text(t.toFixed(1)+" oz");var n=M.serving_size();$("#serving_size_g").text("("+Math.round(n)+"g)");var e=M.nutritional_value_per_serving("Energ_Kcal_from_Fat");$("#calories_from_fat").text(Math.round(e));var r=M.nutritional_value_per_serving("Energ_Kcal");$("#calories").text(Math.round(r));var i=M.nutritional_value_per_serving("Lipid_Tot");$("#total_fat").text(Math.round(i)+"g");var a=M.daily_value("Lipid_Tot");$("#total_fat_dv").text(Math.round(a));var o=M.nutritional_value_per_serving("FA_Sat");$("#sat_fat").text(Math.round(o)+"g");var u=M.daily_value("FA_Sat");$("#sat_fat_dv").text(Math.round(u));var s=M.nutritional_value_per_serving("FA_Trans");$("#trans_fat").text(Math.round(s)+"g");var l=M.nutritional_value_per_serving("Cholestrl");$("#cholesterol").text(Math.round(l)+"g");var c=M.daily_value("Cholestrl");$("#cholesterol_dv").text(Math.round(c));var f=M.nutritional_value_per_serving("Sodium");$("#sodium").text(Math.round(f)+"mg");var h=M.daily_value("Sodium");$("#sodium_dv").text(Math.round(h));var g=M.nutritional_value_per_serving("Carbohydrt");$("#carbohydrate").text(Math.round(g)+"g");var d=M.daily_value("Carbohydrt");$("#carbohydrate_dv").text(Math.round(d));var p=M.nutritional_value_per_serving("Fiber_TD");$("#fibre").text(Math.round(p)+"g");var _=M.daily_value("Fiber_TD");$("#fibre_dv").text(Math.round(_));M.nutritional_value_per_serving("Sugar_Tot");$("#sugar").text(Math.round(p)+"g");var v=M.nutritional_value_per_serving("Protein");$("#protein_dv").text(Math.round(v)+"g");var y=M.nutritional_value_per_serving("Vit_C");$("#vitamin_c_dv").text(Math.round(y)+"%");var m=M.nutritional_value_per_serving("Vit_A_IU");$("#vitamin_a_dv").text(Math.round(m)+"%");var x=M.nutritional_value_per_serving("Iron");$("#iron_dv").text(Math.round(x)+"%");var b=M.nutritional_value_per_serving("Calcium");$("#calcium_dv").text(Math.round(b)+"%")};$(n).load("alacalc-plot-fda-label.html",function(){e()}),$("body").bind("ingredient_values_changed",function(){e()})}function calRound(t){return t<5?"0":t<50?(.2*t).toFixed(0)/.2:(.1*t).toFixed(0)/.1}function fatRound(t){return t<.5?"0":t<5?(2*t).toFixed(0)/2:t.toFixed(0)}function cholRound(t){return t<2?"0":t<5?"less than 5":(.2*t).toFixed(0)/.2}function sodiumRound(t){return t<5?"0":t<140?(.2*t).toFixed(0)/.2:(.1*t).toFixed(0)/.1}function carbRound(t){return t<.5?"0":t<1?"< 1":t.toFixed(0)}function fibreRound(t){return t<.5?"0":t<1?"less than 1":t.toFixed(0)}function proteinRound(t){return t<.5?"0":t<1?"less than 1":t.toFixed(0)}function dvRound(t){return t.toFixed(0)}function vitaminRound(t){return t<=10?(.5*t).toFixed(0)/.5:t<=50?(.2*t).toFixed(0)/.2:(.1*t).toFixed(0)/.1}function create_fda_svg_plot(D,q,P){var t=function(){$(q).svg("get");nb_servings=D.number_of_servings(),nb_servings_orig=nb_servings,5<nb_servings?(nb_servings=D.number_of_servings().toFixed(0),.2<Math.abs(nb_servings_orig-nb_servings)&&(nb_servings="about "+nb_servings)):2<=nb_servings?(nb_servings=(2*D.number_of_servings()).toFixed(0)/2,.1<Math.abs(nb_servings_orig-nb_servings)&&(nb_servings="about "+nb_servings)):(nb_servings=(10*D.number_of_servings()).toFixed(0)/10,.01<Math.abs(nb_servings_orig-nb_servings)&&(nb_servings="about "+nb_servings)),$(".fda_svg_number_of_servings").text(nb_servings);var t=D.serving_size("oz"),n=D.serving_size();$(".fda_svg_serving_size").text(t.toFixed(0)+"oz ("+n.toFixed(0)+"g)");var e=D.nutritional_value_per_serving("Energ_Kcal");$(".fda_svg_calories").text(calRound(e));var r=D.nutritional_value_per_serving("Energ_Kcal_from_Fat");$(".fda_svg_calories_from_fat").text("Calories from fat "+calRound(r));var i=D.nutritional_value_per_serving("Lipid_Tot");$(".fda_svg_total_fat").text(fatRound(i)+"g");var a=D.daily_value("Lipid_Tot");$(".fda_svg_total_fat_dv").text(dvRound(a));var o=D.nutritional_value_per_serving("FA_Sat");$(".fda_svg_sat_fat").text(fatRound(o)+"g");var u=D.daily_value("FA_Sat");$(".fda_svg_sat_fat_dv").text(dvRound(u));var s=D.nutritional_value_per_serving("FA_Trans");$(".fda_svg_trans_fat").text(fatRound(s)+"g");var l=D.daily_value("FA_Trans");$(".fda_svg_trans_fat_dv").text(dvRound(l));var c=D.nutritional_value_per_serving("Cholestrl");$(".fda_svg_cholesterol").text(cholRound(c)+"mg");var f=D.daily_value("Cholestrl");$(".fda_svg_cholesterol_dv").text(dvRound(f));var h=D.nutritional_value_per_serving("Sodium");$(".fda_svg_sodium").text(sodiumRound(h)+"mg");var g=D.daily_value("Sodium");$(".fda_svg_sodium_dv").text(dvRound(g));var d=D.nutritional_value_per_serving("Carbohydrt");$(".fda_svg_carbohydrate").text(carbRound(d)+"g");var p=D.daily_value("Carbohydrt");$(".fda_svg_carbohydrate_dv").text(dvRound(p));var _=D.nutritional_value_per_serving("Fiber_TD");$(".fda_svg_fibre").text(fibreRound(_)+"g");var v=D.daily_value("Fiber_TD");$(".fda_svg_fibre_dv").text(dvRound(v));var y=D.nutritional_value_per_serving("Sugar_Tot");P.includes("facts_up_front")?$(".fda_svg_sugar_up_front").text(fibreRound(y).replace("less than","<")+"g"):$(".fda_svg_sugar").text(fibreRound(y)+"g");var m=D.nutritional_value_per_serving("Sugar_Added");$(".fda_svg_sugar_added_value").text(dvRound(m)+"g");var x=D.daily_value("Sugar_Added");$(".fda_svg_sugar_added_dv").text(dvRound(x));var b=D.nutritional_value_per_serving("Protein");$(".fda_svg_protein").text(proteinRound(b)+"g");var M=D.daily_value("Vit_C");$(".fda_svg_vitamin_c_dv").text(vitaminRound(M));var w=D.daily_value("Vit_A_RAE");$(".fda_svg_vitamin_a_dv").text(vitaminRound(w));var k=D.nutritional_value_per_serving("Vit_D_mcg");$(".fda_svg_vitamin_d").text(vitaminRound(k)+"mcg");var S=D.daily_value("Vit_D_mcg");$(".fda_svg_vitamin_d_dv").text(vitaminRound(S));var N=D.nutritional_value_per_serving("Iron");$(".fda_svg_iron").text(vitaminRound(N)+"mg");var A=D.daily_value("Iron");$(".fda_svg_iron_dv").text(vitaminRound(A));var E=D.nutritional_value_per_serving("Potassium");$(".fda_svg_potassium").text(vitaminRound(E)+"mg");var C=D.daily_value("Potassium");$(".fda_svg_potassium_dv").text(vitaminRound(C));var L=D.nutritional_value_per_serving("Calcium");$(".fda_svg_calcium").text(vitaminRound(L)+"mg");var R=D.daily_value("Calcium");$(".fda_svg_calcium_dv").text(vitaminRound(R));var T=D.daily_value("Thiamin");$(".fda_svg_thiamin_dv").text(dvRound(T));var z=D.daily_value("Riboflavin");$(".fda_svg_riboflavin_dv").text(dvRound(z));var F=D.daily_value("Niacin");$(".fda_svg_niacin_dv").text(dvRound(F))};$(q).svg(),path="/others",$(q).load(path+"/"+P,function(){t()}),$("body").bind("ingredient_values_changed",function(){t()})}function stdRounding(t,n,e){return 10<=t?t.toFixed(0):toLocalNumber(1==n&&t<1?t.toFixed(2):t.toFixed(1),e)}function toLocalNumber(t,n){return"de"==n?String(t).replace(".",","):String(t)}function toLocalLevel(t,n){var e={de:{LOW:"Niedrig",MED:"Mittel",HIGH:"Hoch"}};return n in e?e[n][t]:t}function create_eu_svg_plot(v,y,t){t==undefined&&console.error("Called create_eu_svg_plot without an undefined svg_template");var m=-1<t.indexOf(".de.svg")?"de":"en",n=function(){var t=["#ef3340","#efb22d","#97d700"],n=["red","orange","green"];$(y).svg("get");$(".eu_svg_per_serving").text("per "+v.serving_size().toFixed(0)+"g"),$(".eu_svg_serving_size").text("("+v.serving_size().toFixed(0)+"g)"),$(".eu_svg_serving_size_drinks").text("("+v.serving_size().toFixed(0)+"ml)"),nb_servings=v.number_of_servings(),5<nb_servings?nb_servings=v.number_of_servings().toFixed(0):nb_servings=toLocalNumber((2*v.number_of_servings()).toFixed(0)/2,m),$(".eu_svg_serving_value").text(nb_servings),$(".eu_svg_energy_kj").text(v.nutritional_value_per_serving("Energ_KJ").toFixed(0)+"kJ"),$(".eu_svg_energy_kj_100g").text(v.nutritional_value_per_100g("Energ_KJ").toFixed(0)+"kJ"),$(".eu_svg_energy_kcal").text(v.nutritional_value_per_serving("Energ_Kcal").toFixed(0)+"kcal"),$(".eu_svg_energy_kcal_100g").text(v.nutritional_value_per_100g("Energ_Kcal").toFixed(0)+"kcal"),$(".eu_svg_energy_perc").text(v.reference_intake("Energ_Kcal").toFixed(0)+"%"),$(".eu_svg_typical_values_per_100g").text(v.nutritional_value_per_100g("Energ_KJ").toFixed(0)+"kJ/"+v.nutritional_value_per_100g("Energ_Kcal").toFixed(0)+"kcal"),l=10<=(l=v.nutritional_value_per_serving("Lipid_Tot"))?l.toFixed(0):.5<l?toLocalNumber(l.toFixed(1),m):"0",$(".eu_svg_fat_g").text(l+"g"),$(".eu_svg_fat_perc").text(v.reference_intake("Lipid_Tot").toFixed(0)+"%");var e=v.traffic_light_color("Lipid_Tot"),r=toLocalLevel(e[1],m),i=e[0],a=t[n.indexOf(i)];$(".eu_svg_fat_level").text(r);try{$(".eu_svg_fat1_color").attr("stroke",a),$(".eu_svg_fat1_color").attr("fill",a),$(".eu_svg_fat2_color").attr("stroke",a),$(".eu_svg_fat2_color").attr("fill",a)}catch(_){}e=v.traffic_light_color_drink("Lipid_Tot"),r=toLocalLevel(e[1],m),i=e[0],a=t[n.indexOf(i)];$(".eu_svg_fat_level_drink").text(r);try{$(".eu_svg_fat1_color_drink").attr("stroke",a),$(".eu_svg_fat1_color_drink").attr("fill",a),$(".eu_svg_fat2_color_drink").attr("stroke",a),$(".eu_svg_fat2_color_drink").attr("fill",a)}catch(_){}c=10<=(c=v.nutritional_value_per_serving("FA_Sat"))?c.toFixed(0):.1<c?toLocalNumber(c.toFixed(1),m):"0",$(".eu_svg_sat_g").text(c+"g"),$(".eu_svg_sat_perc").text(v.reference_intake("FA_Sat").toFixed(0)+"%");var o=v.traffic_light_color("FA_Sat");r=toLocalLevel(o[1],m),i=o[0],a=t[n.indexOf(i)];$(".eu_svg_sat_level").text(r);try{$(".eu_svg_sat1_color").attr("stroke",a),$(".eu_svg_sat1_color").attr("fill",a),$(".eu_svg_sat2_color").attr("stroke",a),$(".eu_svg_sat2_color").attr("fill",a)}catch(_){}o=v.traffic_light_color("FA_Sat"),r=toLocalLevel(o[1],m),i=o[0],a=t[n.indexOf(i)];$(".eu_svg_sat_level_drink").text(r);try{$(".eu_svg_sat1_color_drink").attr("stroke",a),$(".eu_svg_sat1_color_drink").attr("fill",a),$(".eu_svg_sat2_color_drink").attr("stroke",a),$(".eu_svg_sat2_color_drink").attr("fill",a)}catch(_){}f=10<=(f=v.nutritional_value_per_serving("Sugar_Tot"))?f.toFixed(0):.5<f?toLocalNumber(f.toFixed(1),m):"0",$(".eu_svg_sugar_g").text(f+"g"),$(".eu_svg_sugar_perc").text(v.reference_intake("Sugar_Tot").toFixed(0)+"%");var u=v.traffic_light_color("Sugar_Tot");r=toLocalLevel(u[1],m),i=u[0],a=t[n.indexOf(i)];$(".eu_svg_sugar_level").text(r);try{$(".eu_svg_sugar1_color").attr("stroke",a),$(".eu_svg_sugar1_color").attr("fill",a),$(".eu_svg_sugar2_color").attr("stroke",a),$(".eu_svg_sugar2_color").attr("fill",a)}catch(_){}u=v.traffic_light_color("Sugar_Tot"),r=toLocalLevel(u[1],m),i=u[0],a=t[n.indexOf(i)];$(".eu_svg_sugar_level_drink").text(r);try{$(".eu_svg_sugar1_color_drink").attr("stroke",a),$(".eu_svg_sugar1_color_drink").attr("fill",a),$(".eu_svg_sugar2_color_drink").attr("stroke",a),$(".eu_svg_sugar2_color_drink").attr("fill",a)}catch(_){}h=1<=(h=v.nutritional_value_per_serving("Salt"))?toLocalNumber(h.toFixed(1),m):.0125<h?toLocalNumber(h.toFixed(2),m):"0",$(".eu_svg_salt_g").text(h+"g"),$(".eu_svg_salt_perc").text(v.reference_intake("Salt").toFixed(0)+"%");var s=v.traffic_light_color("Salt");r=toLocalLevel(s[1],m),i=s[0],a=t[n.indexOf(i)];$(".eu_svg_salt_level").text(r);try{$(".eu_svg_salt1_color").attr("stroke",a),$(".eu_svg_salt1_color").attr("fill",a),$(".eu_svg_salt2_color").attr("stroke",a),$(".eu_svg_salt2_color").attr("fill",a)}catch(_){}s=v.traffic_light_color("Salt"),r=toLocalLevel(s[1],m),i=s[0],a=t[n.indexOf(i)];$(".eu_svg_salt_level_drink").text(r);try{$(".eu_svg_salt1_color_drink").attr("stroke",a),$(".eu_svg_salt1_color_drink").attr("fill",a),$(".eu_svg_salt2_color_drink").attr("stroke",a),$(".eu_svg_salt2_color_drink").attr("fill",a)}catch(_){}var l=v.nutritional_value_per_serving("Lipid_Tot");$(".eu_svg_fat_g_serving_std_rnd").text(stdRounding(l,!1,m)+"g");l=v.nutritional_value_per_100g("Lipid_Tot");$(".eu_svg_fat_g_100g_std_rnd").text(stdRounding(l,!1,m)+"g");var c=v.nutritional_value_per_serving("FA_Sat");$(".eu_svg_satfat_g_serving_std_rnd").text(stdRounding(c,!1,m)+"g");c=v.nutritional_value_per_100g("FA_Sat");$(".eu_svg_satfat_g_100g_std_rnd").text(stdRounding(c,!1,m)+"g");var f=v.nutritional_value_per_serving("Sugar_Tot");$(".eu_svg_sugar_g_serving_std_rnd").text(stdRounding(f,!1,m)+"g");f=v.nutritional_value_per_100g("Sugar_Tot");$(".eu_svg_sugar_g_100g_std_rnd").text(stdRounding(f,!1,m)+"g");var h=v.nutritional_value_per_serving("Salt");$(".eu_svg_salt_g_serving_std_rnd").text(stdRounding(h,!0,m)+"g");h=v.nutritional_value_per_100g("Salt");$(".eu_svg_salt_g_100g_std_rnd").text(stdRounding(h,!0,m)+"g");var g=v.nutritional_value_per_serving("Carbohydrt");$(".eu_svg_carbohydrate_g_serving_std_rnd").text(stdRounding(g,!1,m)+"g");g=v.nutritional_value_per_100g("Carbohydrt");$(".eu_svg_carbohydrate_g_100g_std_rnd").text(stdRounding(g,!1,m)+"g");var d=v.nutritional_value_per_serving("Protein");$(".eu_svg_protein_g_serving_std_rnd").text(stdRounding(d,!1,m)+"g");d=v.nutritional_value_per_100g("Protein");$(".eu_svg_protein_g_100g_std_rnd").text(stdRounding(d,!1,m)+"g");var p=v.nutritional_value_per_serving("Fiber_TD");$(".eu_svg_fibre_g_serving_std_rnd").text(stdRounding(p,!1,m)+"g");p=v.nutritional_value_per_100g("Fiber_TD");$(".eu_svg_fibre_g_100g_std_rnd").text(stdRounding(p,!1,m)+"g")};$(y).svg(),path="/others",$(y).load(path+"/"+t,function(){n()}),$("body").bind("ingredient_values_changed",function(){n()})}function create_de_svg_plot(l,c,f){var t=function(){var t=0,n=l.nutritional_value_per_100g("Energ_Kcal");800<n?t+=10:720<n?t+=9:640<n?t+=8:560<n?t+=7:480<n?t+=6:400<n?t+=5:320<n?t+=4:240<n?t+=3:160<n?t+=2:80<n&&(t+=1);var e=l.nutritional_value_per_100g("Sugar_Tot");45<e?t+=10:40<e?t+=9:36<e?t+=8:31<e?t+=7:27<e?t+=6:22.5<e?t+=5:18<e?t+=4:13.5<e?t+=3:9<e?t+=2:4.5<e&&(t+=1);var r=l.nutritional_value_per_100g("FA_Sat");10<r?t+=10:9<r?t+=9:8<r?t+=8:7<r?t+=7:6<r?t+=6:5<r?t+=5:4<r?t+=4:3<r?t+=3:2<r?t+=2:1<r&&(t+=1);var i=l.nutritional_value_per_100g("Salt")/2.5;900<i?t+=10:810<i?t+=9:720<i?t+=8:630<i?t+=7:540<i?t+=6:450<i?t+=5:360<i?t+=4:270<i?t+=3:180<i?t+=2:90<i&&(t+=1);var a=l.nutritional_value_per_100g("Protein");8<a?t-=5:6.4<a?t-=4:4.8<a?t-=3:3.2<a?t-=2:1.6<a&&(t-=1);var o=l.nutritional_value_per_100g("Fiber_TD");4.7<o?t-=5:3.7<o?t-=4:2.8<o?t-=3:1.9<o?t-=2:.9<o&&(t-=1);var u,s=0;80<s?t-=5:60<s?t-=2:40<s&&(t-=1),u=f.includes("drinks")?t<2?"B":t<6?"C":t<10?"D":"E":t<0?"A":t<3?"B":t<11?"C":t<19?"D":"E",$(c).load("/others/nutri-score-"+u+".svg")};$(c).svg(),t(),$("body").bind("ingredient_values_changed",function(){t()})}function stdRounding(t,n,e){return 10<=t?t.toFixed(0):toLocalNumber(1==n&&t<1?t.toFixed(2):t.toFixed(1),e)}function toLocalNumber(t,n){return"de"==n?String(t).replace(".",","):String(t)}function toLocalLevel(t,n){var e={de:{LOW:"Niedrig",MED:"Mittel",HIGH:"Hoch"}};return n in e?e[n][t]:t}function create_de_breakdown_svg_plot(x,b,M){M==undefined&&console.error("Called create_eu_svg_plot without an undefined svg_template");var w=-1<M.indexOf(".de.svg")?"de":"en",t=function(){$(b).svg("get");$("#de_svg_energy_kcal_100g").text(x.nutritional_value_per_100g("Energ_Kcal").toFixed(0));var t=x.nutritional_value_per_100g("FA_Sat");t=10<=t?t.toFixed(0):.1<t?toLocalNumber(t.toFixed(1),w):"0",$("#de_svg_sat_g_100g").text(t);var n=x.nutritional_value_per_100g("Sugar_Tot");n=10<=n?n.toFixed(0):.5<n?toLocalNumber(n.toFixed(1),w):"0",$("#de_svg_sugar_g_100g").text(n);var e=x.nutritional_value_per_serving("Salt"),r=e/2.5;r=1<=r?toLocalNumber(r.toFixed(1),w):.0125<e?toLocalNumber(r.toFixed(2),w):"0",$("#de_svg_natrium_g_100g").text(r);var i=x.nutritional_value_per_100g("Protein");$("#de_svg_protein_g_100g").text(stdRounding(i,!1,w));var a=x.nutritional_value_per_100g("Fiber_TD");$("#de_svg_fibre_g_100g").text(stdRounding(a,!1,w));var o=0;$("#de_svg_fruit_perc_100g").text(o);var u=0;energy=x.nutritional_value_per_100g("Energ_Kcal"),800<energy?u=10:720<energy?u=9:640<energy?u=8:560<energy?u=7:480<energy?u=6:400<energy?u=5:320<energy?u=4:240<energy?u=3:160<energy?u=2:80<energy&&(u=1);var s=0,l=x.nutritional_value_per_100g("Sugar_Tot");45<l?s+=10:40<l?s+=9:36<l?s+=8:31<l?s+=7:27<l?s+=6:22.5<l?s+=5:18<l?s+=4:13.5<l?s+=3:9<l?s+=2:4.5<l&&(s+=1);var c=0,f=x.nutritional_value_per_100g("FA_Sat");10<f?c+=10:9<f?c+=9:8<f?c+=8:7<f?c+=7:6<f?c+=6:5<f?c+=5:4<f?c+=4:3<f?c+=3:2<f?c+=2:1<f&&(c+=1),natrium_points=0;var h=x.nutritional_value_per_100g("Salt")/2.5;900<h?natrium_points+=10:810<h?natrium_points+=9:720<h?natrium_points+=8:630<h?natrium_points+=7:540<h?natrium_points+=6:450<h?natrium_points+=5:360<h?natrium_points+=4:270<h?natrium_points+=3:180<h?natrium_points+=2:90<h&&(natrium_points+=1);var g=0,d=x.nutritional_value_per_100g("Protein");8<d?g-=5:6.4<d?g-=4:4.8<d?g-=3:3.2<d?g-=2:1.6<d&&(g-=1);var p=0,_=x.nutritional_value_per_100g("Fiber_TD");4.7<_?p-=5:3.7<_?p-=4:2.8<_?p-=3:1.9<_?p-=2:.9<_&&(p-=1);var v,y=0;80<o?y-=5:60<o?y-=2:40<o&&(y-=1);var m=u+s+c+natrium_points+g+p+y;v=M.includes("drinks")?m<2?"B":m<6?"C":m<10?"D":"E":m<0?"A":m<3?"B":m<11?"C":m<19?"D":"E",$("#de_svg_energy_kcal_points").text(u),$("#de_svg_sugar_kcal_points").text(s),$("#de_svg_satfat_kcal_points").text(c),$("#de_svg_natrium_kcal_points").text(natrium_points),$("#de_svg_protein_kcal_points").text(g),$("#de_svg_fibre_kcal_points").text(p),$("#de_svg_fruit_kcal_points").text(y),$("#de_svg_nutri_points").text(m),$("#de_svg_nutri_score").text(v)};$(b).svg(),path="/others",$(b).load(path+"/"+M,function(){t()}),$("body").bind("ingredient_values_changed",function(){t()})}!function(p){function t(){this._settings=[],this._extensions=[],this.regional=[],this.regional[""]={errorLoadingText:"Error loading"},this.local=this.regional[""],this._uuid=(new Date).getTime(),this._ie=!!window.ActiveXObject}function n(t,n){this._svg=t,this._container=n;for(var e=0;e<p.svg._extensions.length;e++){var r=p.svg._extensions[e];this[r[0]]=new r[1](this)
}}function e(){this._path=""}function r(){this._parts=[]}p.extend(t.prototype,{markerClassName:"hasSVG",propertyName:"svgwrapper",svgNS:"http://www.w3.org/2000/svg",xlinkNS:"http://www.w3.org/1999/xlink",_wrapperClass:n,_attrNames:{class_:"class",in_:"in",alignmentBaseline:"alignment-baseline",baselineShift:"baseline-shift",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorRendering:"color-rendering",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",underlinePosition:"underline-position",underlineThickness:"underline-thickness",vertAdvY:"vert-adv-y",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode"},_attachSVG:function(t,n){var e=t.namespaceURI===this.svgNS?t:null;if(!p((t=e?null:t)||e).hasClass(this.markerClassName)){"string"==typeof n?n={loadURL:n}:"function"==typeof n&&(n={onLoad:n}),p(t||e).addClass(this.markerClassName);try{e||((e=document.createElementNS(this.svgNS,"svg")).setAttribute("version","1.1"),0<t.clientWidth&&e.setAttribute("width",t.clientWidth),0<t.clientHeight&&e.setAttribute("height",t.clientHeight),t.appendChild(e)),this._afterLoad(t,e,n||{})}catch(r){p(t).html("<p>SVG is not supported natively on this browser</p>")}}},_afterLoad:function(t,n,e){e=e||this._settings[t.id];this._settings[t?t.id:""]=null;var r=new this._wrapperClass(n,t);p.data(t||n,p.svg.propertyName,r);try{e.loadURL&&r.load(e.loadURL,e),e.settings&&r.configure(e.settings),e.onLoad&&!e.loadURL&&e.onLoad.apply(t||n,[r])}catch(i){alert(i)}},_getSVG:function(t){return p(t).data(this.propertyName)},_destroySVG:function(t){(t=p(t)).hasClass(this.markerClassName)&&(t.removeClass(this.markerClassName).removeData(this.propertyName),t[0].namespaceURI!==this.svgNS&&t.empty())},addExtension:function(t,n){this._extensions.push([t,n])},isSVGElem:function(t){return 1===t.nodeType&&t.namespaceURI===p.svg.svgNS}}),p.extend(n.prototype,{width:function(){return this._container?this._container.clientWidth:this._svg.width},height:function(){return this._container?this._container.clientHeight:this._svg.height},root:function(){return this._svg},configure:function(t,n,e){if(t.nodeName||(e=n,n=t,t=this._svg),e)for(var r=t.attributes.length-1;0<=r;r--){var i=t.attributes.item(r);"onload"!==i.nodeName&&"version"!==i.nodeName&&"xmlns"!==i.nodeName.substring(0,5)&&t.attributes.removeNamedItem(i.nodeName)}for(var a in n)t.setAttribute(p.svg._attrNames[a]||a,n[a]);return this},getElementById:function(t){return this._svg.ownerDocument.getElementById(t)},change:function(t,n){if(t)for(var e in n)null==n[e]?t.removeAttribute(p.svg._attrNames[e]||e):t.setAttribute(p.svg._attrNames[e]||e,n[e]);return this},_args:function(t,n,e){n.splice(0,0,"parent"),n.splice(n.length,0,"settings");var r={},i=0;null!=t[0]&&t[0].jquery&&(t[0]=t[0][0]),null==t[0]||"object"==typeof t[0]&&t[0].nodeName||(r.parent=null,i=1);for(var a=0;a<t.length;a++)r[n[a+i]]=t[a];return e&&p.each(e,function(t,n){"object"==typeof r[n]&&(r.settings=r[n],r[n]=null)}),r},title:function(t,n,e){var r=this._args(arguments,["text"]),i=this._makeNode(r.parent,"title",r.settings||{});return i.appendChild(this._svg.ownerDocument.createTextNode(r.text)),i},describe:function(t,n,e){var r=this._args(arguments,["text"]),i=this._makeNode(r.parent,"desc",r.settings||{});return i.appendChild(this._svg.ownerDocument.createTextNode(r.text)),i},defs:function(t,n,e){var r=this._args(arguments,["id"],["id"]);return this._makeNode(r.parent,"defs",p.extend(r.id?{id:r.id}:{},r.settings||{}))},symbol:function(t,n,e,r,i,a,o){var u=this._args(arguments,["id","x1","y1","width","height"]);return this._makeNode(u.parent,"symbol",p.extend({id:u.id,viewBox:u.x1+" "+u.y1+" "+u.width+" "+u.height},u.settings||{}))},marker:function(t,n,e,r,i,a,o,u){var s=this._args(arguments,["id","refX","refY","mWidth","mHeight","orient"],["orient"]);return this._makeNode(s.parent,"marker",p.extend({id:s.id,refX:s.refX,refY:s.refY,markerWidth:s.mWidth,markerHeight:s.mHeight,orient:s.orient||"auto"},s.settings||{}))},style:function(t,n,e){var r=this._args(arguments,["styles"]),i=this._makeNode(r.parent,"style",p.extend({type:"text/css"},r.settings||{}));return i.appendChild(this._svg.ownerDocument.createTextNode(r.styles)),i},script:function(t,n,e,r){var i=this._args(arguments,["script","type"],["type"]),a=this._makeNode(i.parent,"script",p.extend({type:i.type||"text/javascript"},i.settings||{}));return a.appendChild(this._svg.ownerDocument.createTextNode(i.script)),p.svg._ie&&p.globalEval(i.script),a},linearGradient:function(t,n,e,r,i,a,o,u){var s=this._args(arguments,["id","stops","x1","y1","x2","y2"],["x1"]),l=p.extend({id:s.id},null!=s.x1?{x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2}:{});return this._gradient(s.parent,"linearGradient",p.extend(l,s.settings||{}),s.stops)},radialGradient:function(t,n,e,r,i,a,o,u,s){var l=this._args(arguments,["id","stops","cx","cy","r","fx","fy"],["cx"]),c=p.extend({id:l.id},null!=l.cx?{cx:l.cx,cy:l.cy,r:l.r,fx:l.fx,fy:l.fy}:{});return this._gradient(l.parent,"radialGradient",p.extend(c,l.settings||{}),l.stops)},_gradient:function(t,n,e,r){for(var i=this._makeNode(t,n,e),a=0;a<r.length;a++){var o=r[a];this._makeNode(i,"stop",p.extend({offset:o[0],stopColor:o[1]},null!=o[2]?{stopOpacity:o[2]}:{}))}return i},pattern:function(t,n,e,r,i,a,o,u,s,l,c){var f=this._args(arguments,["id","x","y","width","height","vx","vy","vwidth","vheight"],["vx"]),h=p.extend({id:f.id,x:f.x,y:f.y,width:f.width,height:f.height},null!=f.vx?{viewBox:f.vx+" "+f.vy+" "+f.vwidth+" "+f.vheight}:{});return this._makeNode(f.parent,"pattern",p.extend(h,f.settings||{}))},clipPath:function(t,n,e,r){var i=this._args(arguments,["id","units"]);return i.units=i.units||"userSpaceOnUse",this._makeNode(i.parent,"clipPath",p.extend({id:i.id,clipPathUnits:i.units},i.settings||{}))},mask:function(t,n,e,r,i,a,o){var u=this._args(arguments,["id","x","y","width","height"]);return this._makeNode(u.parent,"mask",p.extend({id:u.id,x:u.x,y:u.y,width:u.width,height:u.height},u.settings||{}))},createPath:function(){return new e},createText:function(){return new r},svg:function(t,n,e,r,i,a,o,u,s,l){var c=this._args(arguments,["x","y","width","height","vx","vy","vwidth","vheight"],["vx"]),f=p.extend({x:c.x,y:c.y,width:c.width,height:c.height},null!=c.vx?{viewBox:c.vx+" "+c.vy+" "+c.vwidth+" "+c.vheight}:{});return this._makeNode(c.parent,"svg",p.extend(f,c.settings||{}))},group:function(t,n,e){var r=this._args(arguments,["id"],["id"]);return this._makeNode(r.parent,"g",p.extend({id:r.id},r.settings||{}))},use:function(t,n,e,r,i,a,o){var u=this._args(arguments,["x","y","width","height","ref"]);"string"==typeof u.x&&(u.ref=u.x,u.settings=u.y,u.x=u.y=u.width=u.height=null);var s=this._makeNode(u.parent,"use",p.extend({x:u.x,y:u.y,width:u.width,height:u.height},u.settings||{}));return s.setAttributeNS(p.svg.xlinkNS,"href",u.ref),s},link:function(t,n,e){var r=this._args(arguments,["ref"]),i=this._makeNode(r.parent,"a",r.settings);return i.setAttributeNS(p.svg.xlinkNS,"href",r.ref),i},image:function(t,n,e,r,i,a,o){var u=this._args(arguments,["x","y","width","height","ref"]),s=this._makeNode(u.parent,"image",p.extend({x:u.x,y:u.y,width:u.width,height:u.height},u.settings||{}));return s.setAttributeNS(p.svg.xlinkNS,"href",u.ref),s},path:function(t,n,e){var r=this._args(arguments,["path"]);return this._makeNode(r.parent,"path",p.extend({d:r.path.path?r.path.path():r.path},r.settings||{}))},rect:function(t,n,e,r,i,a,o,u){var s=this._args(arguments,["x","y","width","height","rx","ry"],["rx"]);return this._makeNode(s.parent,"rect",p.extend({x:s.x,y:s.y,width:s.width,height:s.height},s.rx?{rx:s.rx,ry:s.ry}:{},s.settings||{}))},circle:function(t,n,e,r,i){var a=this._args(arguments,["cx","cy","r"]);return this._makeNode(a.parent,"circle",p.extend({cx:a.cx,cy:a.cy,r:a.r},a.settings||{}))},ellipse:function(t,n,e,r,i,a){var o=this._args(arguments,["cx","cy","rx","ry"]);return this._makeNode(o.parent,"ellipse",p.extend({cx:o.cx,cy:o.cy,rx:o.rx,ry:o.ry},o.settings||{}))},line:function(t,n,e,r,i,a){var o=this._args(arguments,["x1","y1","x2","y2"]);return this._makeNode(o.parent,"line",p.extend({x1:o.x1,y1:o.y1,x2:o.x2,y2:o.y2},o.settings||{}))},polyline:function(t,n,e){var r=this._args(arguments,["points"]);return this._poly(r.parent,"polyline",r.points,r.settings)},polygon:function(t,n,e){var r=this._args(arguments,["points"]);return this._poly(r.parent,"polygon",r.points,r.settings)},_poly:function(t,n,e,r){for(var i="",a=0;a<e.length;a++)i+=e[a].join()+" ";return this._makeNode(t,n,p.extend({points:p.trim(i)},r||{}))},text:function(t,n,e,r,i){var a=this._args(arguments,["x","y","value"]);return"string"==typeof a.x&&arguments.length<4&&(a.value=a.x,a.settings=a.y,a.x=a.y=null),this._text(a.parent,"text",a.value,p.extend({x:a.x&&p.isArray(a.x)?a.x.join(" "):a.x,y:a.y&&p.isArray(a.y)?a.y.join(" "):a.y},a.settings||{}))},textpath:function(t,n,e,r){var i=this._args(arguments,["path","value"]),a=this._text(i.parent,"textPath",i.value,i.settings||{});return a.setAttributeNS(p.svg.xlinkNS,"href",i.path),a},_text:function(t,n,e,r){var i=this._makeNode(t,n,r);if("string"==typeof e)i.appendChild(i.ownerDocument.createTextNode(e));else for(var a=0;a<e._parts.length;a++){var o=e._parts[a];if("tspan"===o[0])(u=this._makeNode(i,o[0],o[2])).appendChild(i.ownerDocument.createTextNode(o[1])),i.appendChild(u);else if("tref"===o[0]){(u=this._makeNode(i,o[0],o[2])).setAttributeNS(p.svg.xlinkNS,"href",o[1]),i.appendChild(u)}else if("textpath"===o[0]){var u,s=p.extend({},o[2]);s.href=null,(u=this._makeNode(i,o[0],s)).setAttributeNS(p.svg.xlinkNS,"href",o[2].href),u.appendChild(i.ownerDocument.createTextNode(o[1])),i.appendChild(u)}else i.appendChild(i.ownerDocument.createTextNode(o[1]))}return i},other:function(t,n,e){var r=this._args(arguments,["name"]);return this._makeNode(r.parent,r.name,r.settings||{})},_makeNode:function(t,n,e){t=t||this._svg;var r=this._svg.ownerDocument.createElementNS(p.svg.svgNS,n);for(var n in e){var i=e[n];null==i||"string"==typeof i&&""===i||r.setAttribute(p.svg._attrNames[n]||n,i)}return t.appendChild(r),r},add:function(t,n){var e=this._args(1===arguments.length?[null,t]:arguments,["node"]),r=this;e.parent=e.parent||this._svg,e.node=e.node.jquery?e.node:p(e.node);try{e.parent.appendChild(e.node.cloneNode(!0))}catch(i){e.node.each(function(){var t=r._cloneAsSVG(this);t&&e.parent.appendChild(t)})}return this},clone:function(t,n){var e=this,r=this._args(1===arguments.length?[null,t]:arguments,["node"]);r.parent=r.parent||this._svg,r.node=r.node.jquery?r.node:p(r.node);var i=[];return r.node.each(function(){var t=e._cloneAsSVG(this);t&&(t.id="",r.parent.appendChild(t),i.push(t))}),i},_cloneAsSVG:function(t){var n=null;if(1===t.nodeType){n=this._svg.ownerDocument.createElementNS(p.svg.svgNS,this._checkName(t.nodeName));for(var e=0;e<t.attributes.length;e++){var r=t.attributes.item(e);"xmlns"!==r.nodeName&&r.nodeValue&&("xlink"===r.prefix?n.setAttributeNS(p.svg.xlinkNS,r.localName||r.baseName,r.nodeValue):n.setAttribute(this._checkName(r.nodeName),r.nodeValue))}for(e=0;e<t.childNodes.length;e++){var i=this._cloneAsSVG(t.childNodes[e]);i&&n.appendChild(i)}}else if(3===t.nodeType)p.trim(t.nodeValue)&&(n=this._svg.ownerDocument.createTextNode(t.nodeValue));else if(4===t.nodeType&&p.trim(t.nodeValue))try{n=this._svg.ownerDocument.createCDATASection(t.nodeValue)}catch(a){n=this._svg.ownerDocument.createTextNode(t.nodeValue.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"))}return n},_checkName:function(t){return"svg:"===(t="A"<=t.substring(0,1)&&t.substring(0,1)<="Z"?t.toLowerCase():t).substring(0,4)?t.substring(4):t},load:function(c,f){(f="boolean"==typeof f?{addTo:f}:"function"==typeof f?{onLoad:f}:"string"==typeof f?{parent:f}:"object"==typeof f&&f.nodeName?{parent:f}:"object"==typeof f&&f.jquery?{parent:f}:f||{}).parent||f.addTo||this.clear(!1);var h=[this._svg.getAttribute("width"),this._svg.getAttribute("height")],g=this,d=function(t){t=p.svg.local.errorLoadingText+": "+t,f.onLoad?f.onLoad.apply(g._container||g._svg,[g,t]):g.text(null,10,20,t)},n=function(t){if(t)if("svg"===t.documentElement.nodeName){for(var n=f.parent?p(f.parent)[0]:g._svg,e={},r=0;r<t.documentElement.attributes.length;r++){var i=t.documentElement.attributes.item(r);"version"!==i.nodeName&&"xmlns"!==i.nodeName.substring(0,5)&&(e[i.nodeName]=i.nodeValue)}g.configure(n,e,!f.parent);var a=t.documentElement.childNodes;for(r=0;r<a.length;r++)try{n.appendChild(g._svg.ownerDocument.importNode(a[r],!0)),"script"===a[r].nodeName&&p.globalEval(a[r].textContent)}catch(l){g.add(n,a[r])}if(!f.keepRelativeLinks&&c.match("/")){var o=c.replace(/\/[^\/]*$/,"/");p("*",n).each(function(){var t=p(this).attr("xlink:href");t&&!t.match(/(^[a-z][-a-z0-9+.]*:.*$)|(^\/.*$)|(^#.*$)/i)&&p(this).attr("xlink:href",o+t)})}f.changeSize||g.configure(n,{width:h[0],height:h[1]}),f.onLoad&&f.onLoad.apply(g._container||g._svg,[g])}else{var u=t.getElementsByTagName("parsererror"),s=u.length?u[0].getElementsByTagName("div"):[];d(u.length?(s.length?s[0]:u[0]).firstChild.nodeValue:"???")}};if(c.match("<svg"))try{n((new DOMParser).parseFromString(c,"text/xml"))}catch(t){d(t)}else p.ajax({url:c,dataType:"xml",success:function(t){n(t)},error:function(t,n,e){d(n+(e?" "+e.message:""))}});return this},remove:function(t){return(t=t.jquery?t[0]:t).parentNode.removeChild(t),this},clear:function(t){for(t&&this.configure({},!0);this._svg.firstChild;)this._svg.removeChild(this._svg.firstChild);return this},toSVG:function(t){return t=t||this._svg,"undefined"==typeof XMLSerializer?this._toSVG(t):(new XMLSerializer).serializeToString(t)},_toSVG:function(t){var n="";if(!t)return n;if(3===t.nodeType)n=t.nodeValue;else if(4===t.nodeType)n="<![CDATA["+t.nodeValue+"]]>";else{if(n="<"+t.nodeName,t.attributes)for(var e=0;e<t.attributes.length;e++){var r=t.attributes.item(e);""===p.trim(r.nodeValue)||r.nodeValue.match(/^\[object/)||r.nodeValue.match(/^function/)||(n+=" "+(r.namespaceURI===p.svg.xlinkNS?"xlink:":"")+r.nodeName+'="'+r.nodeValue+'"')}if(t.firstChild){n+=">";for(var i=t.firstChild;i;)n+=this._toSVG(i),i=i.nextSibling;n+="</"+t.nodeName+">"}else n+="/>"}return n}}),p.extend(e.prototype,{reset:function(){return this._path="",this},move:function(t,n,e){return e=p.isArray(t)?n:e,this._coords(e?"m":"M",t,n)},line:function(t,n,e){return e=p.isArray(t)?n:e,this._coords(e?"l":"L",t,n)},horiz:function(t,n){return this._path+=(n?"h":"H")+(p.isArray(t)?t.join(" "):t),this},vert:function(t,n){return this._path+=(n?"v":"V")+(p.isArray(t)?t.join(" "):t),this},curveC:function(t,n,e,r,i,a,o){return o=p.isArray(t)?n:o,this._coords(o?"c":"C",t,n,e,r,i,a)},smoothC:function(t,n,e,r,i){return i=p.isArray(t)?n:i,this._coords(i?"s":"S",t,n,e,r)},curveQ:function(t,n,e,r,i){return i=p.isArray(t)?n:i,this._coords(i?"q":"Q",t,n,e,r)},smoothQ:function(t,n,e){return e=p.isArray(t)?n:e,this._coords(e?"t":"T",t,n)},_coords:function(t,n,e,r,i,a,o){if(p.isArray(n))for(var u=0;u<n.length;u++){var s=n[u];this._path+=(0===u?t:" ")+s[0]+","+s[1]+(s.length<4?"":" "+s[2]+","+s[3]+(s.length<6?"":" "+s[4]+","+s[5]))}else this._path+=t+n+","+e+(null==r?"":" "+r+","+i+(null==a?"":" "+a+","+o));return this},arc:function(t,n,e,r,i,a,o,u){if(u=p.isArray(t)?n:u,this._path+=u?"a":"A",p.isArray(t))for(var s=0;s<t.length;s++){var l=t[s];this._path+=(0===s?"":" ")+l[0]+","+l[1]+" "+l[2]+" "+(l[3]?"1":"0")+","+(l[4]?"1":"0")+" "+l[5]+","+l[6]}else this._path+=t+","+n+" "+e+" "+(r?"1":"0")+","+(i?"1":"0")+" "+a+","+o;return this},close:function(){return this._path+="z",this},path:function(){return this._path}}),e.prototype.moveTo=e.prototype.move,e.prototype.lineTo=e.prototype.line,e.prototype.horizTo=e.prototype.horiz,e.prototype.vertTo=e.prototype.vert,e.prototype.curveCTo=e.prototype.curveC,e.prototype.smoothCTo=e.prototype.smoothC,e.prototype.curveQTo=e.prototype.curveQ,e.prototype.smoothQTo=e.prototype.smoothQ,e.prototype.arcTo=e.prototype.arc,p.extend(r.prototype,{reset:function(){return this._parts=[],this},string:function(t){return this._parts.push(["text",t]),this},span:function(t,n){return this._parts.push(["tspan",t,n]),this},ref:function(t,n){return this._parts.push(["tref",t,n]),this},path:function(t,n,e){return this._parts.push(["textpath",n,p.extend({href:t},e||{})]),this}}),p.fn.svg=function(t){var n=Array.prototype.slice.call(arguments,1);return"string"==typeof t&&"get"===t?p.svg["_"+t+"SVG"].apply(p.svg,[this[0]].concat(n)):this.each(function(){"string"==typeof t?p.svg["_"+t+"SVG"].apply(p.svg,[this].concat(n)):p.svg._attachSVG(this,t||{})})},p.svg=new t}(jQuery),d3=function(){function u(t){return null!=t&&!isNaN(t)}function o(t){return t.length}function s(t){for(var n=1;t*n%1;)n*=10;return n}function r(t,n){try{for(var e in n)Object.defineProperty(t.prototype,e,{value:n[e],enumerable:!1})}catch(r){t.prototype=n}}function m(){}function c(){}function a(n,e,r){return function(){var t=r.apply(e,arguments);return t===e?n:t}}function t(t,n){if(n in t)return n;n=n.charAt(0).toUpperCase()+n.substring(1);for(var e=0,r=ao.length;e<r;++e){var i=ao[e]+n;if(i in t)return i}}function f(){}function l(){}function h(i){function t(){for(var t,n=a,e=-1,r=n.length;++e<r;)(t=n[e].on)&&t.apply(this,arguments);return i}var a=[],o=new m;return t.on=function(t,n){var e,r=o.get(t);return arguments.length<2?r&&r.on:(r&&(r.on=null,a=a.slice(0,e=a.indexOf(r)).concat(a.slice(e+1)),o.remove(t)),n&&a.push(o.set(t,{on:n})),i)},t}function T(){Va.event.preventDefault()}function n(){for(var t,n=Va.event;t=n.sourceEvent;)n=t;return n}function z(i){for(var a=new l,t=0,n=arguments.length;++t<n;)a[arguments[t]]=h(a);return a.of=function(e,r){return function(t){try{var n=t.sourceEvent=Va.event;t.target=i,Va.event=t,a[t.type].apply(e,r)}finally{Va.event=n}}},a}function g(t){return uo(t,ho),t}function d(t){return"function"==typeof t?t:function(){return so(t,this)}}function p(t){return"function"==typeof t?t:function(){return lo(t,this)}}function i(n,e){function t(){this.removeAttribute(n)}function r(){this.removeAttributeNS(n.space,n.local)}function i(){this.setAttribute(n,e)}function a(){this.setAttributeNS(n.space,n.local,e)}function o(){var t=e.apply(this,arguments);null==t?this.removeAttribute(n):this.setAttribute(n,t)}function u(){var t=e.apply(this,arguments);null==t?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,t)}return n=Va.ns.qualify(n),null==e?n.local?r:t:"function"==typeof e?n.local?u:o:n.local?a:i}function _(t){return t.trim().replace(/\s+/g," ")}function v(t){return new RegExp("(?:^|\\s+)"+Va.requote(t)+"(?:\\s+|$)","g")}function y(e,r){function t(){for(var t=-1;++t<i;)e[t](this,r)}function n(){for(var t=-1,n=r.apply(this,arguments);++t<i;)e[t](this,n)}var i=(e=e.trim().split(/\s+/).map(x)).length;return"function"==typeof r?n:t}function x(r){var i=v(r);return function(t,n){if(e=t.classList)return n?e.add(r):e.remove(r);var e=t.getAttribute("class")||"";n?(i.lastIndex=0,i.test(e)||t.setAttribute("class",_(e+" "+r))):t.setAttribute("class",_(e.replace(i," ")))}}function b(n,e,r){function t(){this.style.removeProperty(n)}function i(){this.style.setProperty(n,e,r)}function a(){var t=e.apply(this,arguments);null==t?this.style.removeProperty(n):this.style.setProperty(n,t,r)}return null==e?t:"function"==typeof e?a:i}function e(n,e){function t(){delete this[n]}function r(){this[n]=e}function i(){var t=e.apply(this,arguments);null==t?delete this[n]:this[n]=t}return null==e?t:"function"==typeof e?i:r}function M(t){return"function"==typeof t?t:(t=Va.ns.qualify(t)).local?function(){return this.ownerDocument.createElementNS(t.space,t.local)}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,t)}}function w(t){return{__data__:t}}function k(t){return function(){return fo(this,t)}}function S(e){return arguments.length||(e=Va.ascending),function(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}}function $(t,n){for(var e=0,r=t.length;e<r;e++)for(var i,a=t[e],o=0,u=a.length;o<u;o++)(i=a[o])&&n(i,o,e);return t}function N(t){return uo(t,po),t}function A(o){var u,s;return function(t,n,e){var r,i=o[e].update,a=i.length;for(e!=s&&(s=e,u=0),u<=n&&(u=n+1);!(r=i[u])&&++u<a;);return r}}function L(){var t=this.__transition__;t&&++t.active}function E(i,n,e){function r(){var t=this[o];t&&(this.removeEventListener(i,t,t.$),delete this[o])}function t(){var t=s(n,Ba(arguments));r.call(this),this.addEventListener(i,this[o]=t,t.$=e),t._=n}function a(){var t,n=new RegExp("^__on([^.]+)"+Va.requote(i)+"$");for(var e in this)if(t=e.match(n)){var r=this[e];this.removeEventListener(t[1],r,r.$),delete this[e]}}var o="__on"+i,u=i.indexOf("."),s=C;0<u&&(i=i.substring(0,u));var l=vo.get(i);return l&&(i=l,s=R),u?n?t:r:n?f:a}function C(e,r){return function(t){var n=Va.event;Va.event=t,r[0]=this.__data__;try{e.apply(this,r)}finally{Va.event=n}}}function R(t,n){var r=C(t,n);return function(t){var n=this,e=t.relatedTarget;e&&(e===n||8&e.compareDocumentPosition(n))||r.call(n,t)}}function F(){var e=".dragsuppress-"+ ++mo,t="touchmove"+e,n="selectstart"+e,r="dragstart"+e,i="click"+e,a=Va.select(Xa).on(t,T).on(n,T).on(r,T),o=Wa.style,u=o[yo];return o[yo]="none",function(t){function n(){a.on(i,null)}a.on(e,null),o[yo]=u,t&&(a.on(i,function(){T(),n()},!0),setTimeout(n,0))}}function D(t,n){n.changedTouches&&(n=n.changedTouches[0]);var e=t.ownerSVGElement||t;if(e.createSVGPoint){var r=e.createSVGPoint();if(xo<0&&(Xa.scrollX||Xa.scrollY)){var i=(e=Va.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();xo=!(i.f||i.e),e.remove()}return xo?(r.x=n.pageX,r.y=n.pageY):(r.x=n.clientX,r.y=n.clientY),[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var a=t.getBoundingClientRect();return[n.clientX-a.left-t.clientLeft,n.clientY-a.top-t.clientTop]}function q(t){return 0<t?1:t<0?-1:0}function P(t){return 1<t?0:t<-1?bo:Math.acos(t)}function j(t){return 1<t?wo:t<-1?-wo:Math.asin(t)}function O(t){return((t=Math.exp(t))-1/t)/2}function U(t){return((t=Math.exp(t))+1/t)/2}function H(t){return((t=Math.exp(2*t))-1)/(t+1)}function I(t){return(t=Math.sin(t/2))*t}function V(){}function Y(t,n,e){return new B(t,n,e)}function B(t,n,e){this.h=t,this.s=n,this.l=e}function G(t,n,e){function r(t){return 360<t?t-=360:t<0&&(t+=360),t<60?a+(o-a)*t/60:t<180?o:t<240?a+(o-a)*(240-t)/60:a}function i(t){return Math.round(255*r(t))}var a,o;return t=isNaN(t)?0:(t%=360)<0?t+360:t,n=isNaN(n)?0:n<0?0:1<n?1:n,a=2*(e=e<0?0:1<e?1:e)-(o=e<=.5?e*(1+n):e+n-e*n),ot(i(t+120),i(t),i(t-120))}function W(t,n,e){return new X(t,n,e)}function X(t,n,e){this.h=t,this.c=n,this.l=e}function Z(t,n,e){return isNaN(t)&&(t=0),isNaN(n)&&(n=0),K(e,Math.cos(t*=$o)*n,Math.sin(t)*n)}function K(t,n,e){return new J(t,n,e)}function J(t,n,e){this.l=t,this.a=n,this.b=e}function Q(t,n,e){var r=(t+16)/116,i=r+n/500,a=r-e/200;return ot(rt(3.2404542*(i=nt(i)*qo)-1.5371385*(r=nt(r)*Po)-.4985314*(a=nt(a)*jo)),rt(-.969266*i+1.8760108*r+.041556*a),rt(.0556434*i-.2040259*r+1.0572252*a))}function tt(t,n,e){return 0<t?W(Math.atan2(e,n)*No,Math.sqrt(n*n+e*e),t):W(NaN,NaN,t)}function nt(t){return.206893034<t?t*t*t:(t-4/29)/7.787037}function et(t){return.008856<t?Math.pow(t,1/3):7.787037*t+4/29}function rt(t){return Math.round(255*(t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function it(t){return ot(t>>16,255&t>>8,255&t)}function at(t){return it(t)+""}function ot(t,n,e){return new ut(t,n,e)}function ut(t,n,e){this.r=t,this.g=n,this.b=e}function st(t){return t<16?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function lt(t,n,e){var r,i,a,o=0,u=0,s=0;if(r=/([a-z]+)\((.*)\)/i.exec(t))switch(i=r[2].split(","),r[1]){case"hsl":return e(parseFloat(i[0]),parseFloat(i[1])/100,parseFloat(i[2])/100);case"rgb":return n(gt(i[0]),gt(i[1]),gt(i[2]))}return(a=Ho.get(t))?n(a.r,a.g,a.b):(null!=t&&"#"===t.charAt(0)&&(4===t.length?(o=t.charAt(1),o+=o,u=t.charAt(2),u+=u,s=t.charAt(3),s+=s):7===t.length&&(o=t.substring(1,3),u=t.substring(3,5),s=t.substring(5,7)),o=parseInt(o,16),u=parseInt(u,16),s=parseInt(s,16)),n(o,u,s))}function ct(t,n,e){var r,i,a=Math.min(t/=255,n/=255,e/=255),o=Math.max(t,n,e),u=o-a,s=(o+a)/2;return u?(i=s<.5?u/(o+a):u/(2-o-a),r=t==o?(n-e)/u+(n<e?6:0):n==o?(e-t)/u+2:(t-n)/u+4,r*=60):(r=NaN,i=0<s&&s<1?0:r),Y(r,i,s)}function ft(t,n,e){var r=et((.4124564*(t=ht(t))+.3575761*(n=ht(n))+.1804375*(e=ht(e)))/qo),i=et((.2126729*t+.7151522*n+.072175*e)/Po);return K(116*i-16,500*(r-i),200*(i-et((.0193339*t+.119192*n+.9503041*e)/jo)))}function ht(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function gt(t){var n=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*n):n}function dt(t){return"function"==typeof t?t:function(){return t}}function pt(t){return t}function _t(r){return function(t,n,e){return 2===arguments.length&&"function"==typeof n&&(e=n,n=null),vt(t,n,r,e)}}function vt(i,a,e,r){function t(){var t,n=l.status;if(!n&&l.responseText||200<=n&&n<300||304===n){try{t=e.call(o,l)}catch(r){return void u.error.call(o,r)}u.load.call(o,t)}else u.error.call(o,l)}var o={},u=Va.dispatch("beforesend","progress","load","error"),s={},l=new XMLHttpRequest,c=null;return!Xa.XDomainRequest||"withCredentials"in l||!/^(http(s)?:)?\/\//.test(i)||(l=new XDomainRequest),"onload"in l?l.onload=l.onerror=t:l.onreadystatechange=function(){3<l.readyState&&t()},l.onprogress=function(t){var n=Va.event;Va.event=t;try{u.progress.call(o,l)}finally{Va.event=n}},o.header=function(t,n){return t=(t+"").toLowerCase(),arguments.length<2?s[t]:(null==n?delete s[t]:s[t]=n+"",o)},o.mimeType=function(t){return arguments.length?(a=null==t?null:t+"",o):a},o.responseType=function(t){return arguments.length?(c=t,o):c},o.response=function(t){return e=t,o},["get","post"].forEach(function(t){o[t]=function(){return o.send.apply(o,[t].concat(Ba(arguments)))}}),o.send=function(t,n,e){if(2===arguments.length&&"function"==typeof n&&(e=n,n=null),l.open(t,i,!0),null==a||"accept"in s||(s.accept=a+",*/*"),l.setRequestHeader)for(var r in s)l.setRequestHeader(r,s[r]);return null!=a&&l.overrideMimeType&&l.overrideMimeType(a),null!=c&&(l.responseType=c),null!=e&&o.on("error",e).on("load",function(t){e(null,t)}),u.beforesend.call(o,l),l.send(null==n?null:n),o},o.abort=function(){return l.abort(),o},Va.rebind(o,u,"on"),null==r?o:o.get(yt(r))}function yt(e){return 1===e.length?function(t,n){e(null==t?n:null)}:e}function mt(){var t=xt(),n=bt()-t;24<n?(isFinite(n)&&(clearTimeout(Bo),Bo=setTimeout(mt,n)),Yo=0):(Yo=1,Wo(mt))}function xt(){var t=Date.now();for(Go=Io;Go;)t>=Go.t&&(Go.f=Go.c(t-Go.t)),Go=Go.n;return t}function bt(){for(var t,n=Io,e=1/0;n;)n.f?n=t?t.n=n.n:Io=n.n:(n.t<e&&(e=n.t),n=(t=n).n);return Vo=t,e}function Mt(t,n){var e=Math.pow(10,3*eo(8-n));return{scale:8<n?function(t){return t/e}:function(t){return t*e},symbol:t}}function wt(t,n){return n-(t?Math.ceil(Math.log(t)/Math.LN10):1)}function kt(t){return t+""}function St(){}function $t(t,n,e){var r=e.s=t+n,i=r-t,a=r-i;e.t=t-a+(n-i)}function Nt(t,n){t&&ou.hasOwnProperty(t.type)&&ou[t.type](t,n)}function At(t,n,e){var r,i=-1,a=t.length-e;for(n.lineStart();++i<a;)r=t[i],n.point(r[0],r[1],r[2]);n.lineEnd()}function Et(t,n){var e=-1,r=t.length;for(n.polygonStart();++e<r;)At(t[e],n,1);n.polygonEnd()}function Ct(){function e(t,n){n=n*$o/2+bo/4;var e=(t*=$o)-s,r=Math.cos(n),i=Math.sin(n),a=c*i,o=l*r+a*Math.cos(e),u=a*Math.sin(e);su.add(Math.atan2(u,o)),s=t,l=r,c=i}var r,i,s,l,c;lu.point=function(t,n){lu.point=e,s=(r=t)*$o,l=Math.cos(n=(i=n)*$o/2+bo/4),c=Math.sin(n)},lu.lineEnd=function(){e(r,i)}}function Lt(t){var n=t[0],e=t[1],r=Math.cos(e);return[r*Math.cos(n),r*Math.sin(n),Math.sin(e)]}function Rt(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function Tt(t,n){return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]}function zt(t,n){t[0]+=n[0],t[1]+=n[1],t[2]+=n[2]}function Ft(t,n){return[t[0]*n,t[1]*n,t[2]*n]}function Dt(t){var n=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=n,t[1]/=n,t[2]/=n}function qt(t){return[Math.atan2(t[1],t[0]),j(t[2])]}function Pt(t,n){return eo(t[0]-n[0])<ko&&eo(t[1]-n[1])<ko}function jt(t,n){t*=$o;var e=Math.cos(n*=$o);Ot(e*Math.cos(t),e*Math.sin(t),Math.sin(n))}function Ot(t,n,e){hu+=(t-hu)/++cu,gu+=(n-gu)/cu,du+=(e-du)/cu}function Ut(){function r(t,n){t*=$o;var e=Math.cos(n*=$o),r=e*Math.cos(t),i=e*Math.sin(t),a=Math.sin(n),o=Math.atan2(Math.sqrt((o=s*a-l*i)*o+(o=l*r-u*a)*o+(o=u*i-s*r)*o),u*r+s*i+l*a);fu+=o,pu+=o*(u+(u=r)),_u+=o*(s+(s=i)),vu+=o*(l+(l=a)),Ot(u,s,l)}var u,s,l;bu.point=function(t,n){t*=$o;var e=Math.cos(n*=$o);u=e*Math.cos(t),s=e*Math.sin(t),l=Math.sin(n),bu.point=r,Ot(u,s,l)}}function Ht(){bu.point=jt}function It(){function r(t,n){t*=$o;var e=Math.cos(n*=$o),r=e*Math.cos(t),i=e*Math.sin(t),a=Math.sin(n),o=d*a-p*i,u=p*r-g*a,s=g*i-d*r,l=Math.sqrt(o*o+u*u+s*s),c=g*r+d*i+p*a,f=l&&-P(c)/l,h=Math.atan2(l,c);yu+=f*o,mu+=f*u,xu+=f*s,fu+=h,pu+=h*(g+(g=r)),_u+=h*(d+(d=i)),vu+=h*(p+(p=a)),Ot(g,d,p)}var i,a,g,d,p;bu.point=function(t,n){i=t,a=n,bu.point=r,t*=$o;var e=Math.cos(n*=$o);g=e*Math.cos(t),d=e*Math.sin(t),p=Math.sin(n),Ot(g,d,p)},bu.lineEnd=function(){r(i,a),bu.lineEnd=Ht,bu.point=jt}}function Vt(){return!0}function Yt(t,n,e,r,u){var s=[],l=[];if(t.forEach(function(t){if(!((n=t.length-1)<=0)){var n,e=t[0],r=t[n];if(Pt(e,r)){u.lineStart();for(var i=0;i<n;++i)u.point((e=t[i])[0],e[1]);return void u.lineEnd()}var a=new Gt(e,t,null,!0),o=new Gt(e,null,a,!1);a.o=o,s.push(a),l.push(o),o=new Gt(r,null,a=new Gt(r,t,null,!1),!0),a.o=o,s.push(a),l.push(o)}}),l.sort(n),Bt(s),Bt(l),s.length){for(var i=0,a=e,o=l.length;i<o;++i)l[i].e=a=!a;for(var c,f,h=s[0];;){for(var g=h,d=!0;g.v;)if((g=g.n)===h)return;c=g.z,u.lineStart();do{if(g.v=g.o.v=!0,g.e){if(d)for(i=0,o=c.length;i<o;++i)u.point((f=c[i])[0],f[1]);else r(g.x,g.n.x,1,u);g=g.n}else{if(d)for(i=(c=g.p.z).length-1;0<=i;--i)u.point((f=c[i])[0],f[1]);else r(g.x,g.p.x,-1,u);g=g.p}c=(g=g.o).z,d=!d}while(!g.v);u.lineEnd()}}}function Bt(t){if(n=t.length){for(var n,e,r=0,i=t[0];++r<n;)i.n=e=t[r],e.p=i,i=e;i.n=e=t[0],e.p=i}}function Gt(t,n,e,r){this.x=t,this.z=n,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function Wt(v,y,m,x){return function(r,o){function n(t,n){var e=r(t,n);v(t=e[0],n=e[1])&&o.point(t,n)}function t(t,n){var e=r(t,n);h.point(e[0],e[1])}function e(){d.point=t,h.lineStart()}function i(){d.point=n,h.lineEnd()}function u(t,n){f.push([t,n]);var e=r(t,n);_.point(e[0],e[1])}function a(){_.lineStart(),f=[]}function s(){u(f[0][0],f[0][1]),_.lineEnd();var t,n=_.clean(),e=p.buffer(),r=e.length;if(f.pop(),c.push(f),f=null,r){if(1&n){r=(t=e[0]).length-1;var i,a=-1;for(o.lineStart();++a<r;)o.point((i=t[a])[0],i[1]);return void o.lineEnd()}1<r&&2&n&&e.push(e.pop().concat(e.shift())),l.push(e.filter(Xt))}}var l,c,f,h=y(o),g=r.invert(x[0],x[1]),d={point:n,lineStart:e,lineEnd:i,polygonStart:function(){d.point=u,d.lineStart=a,d.lineEnd=s,l=[],c=[],o.polygonStart()},polygonEnd:function(){d.point=n,d.lineStart=e,d.lineEnd=i,l=Va.merge(l);var t=Jt(g,c);l.length?Yt(l,Kt,t,m,o):t&&(o.lineStart(),m(null,null,1,o),o.lineEnd()),o.polygonEnd(),l=c=null},sphere:function(){o.polygonStart(),o.lineStart(),m(null,null,1,o),o.lineEnd(),o.polygonEnd()}},p=Zt(),_=y(p);return d}}function Xt(t){return 1<t.length}function Zt(){var e,n=[];return{lineStart:function(){n.push(e=[])},point:function(t,n){e.push([t,n])},lineEnd:f,buffer:function(){var t=n;return n=[],e=null,t},rejoin:function(){1<n.length&&n.push(n.pop().concat(n.shift()))}}}function Kt(t,n){return((t=t.x)[0]<0?t[1]-wo-ko:wo-t[1])-((n=n.x)[0]<0?n[1]-wo-ko:wo-n[1])}function Jt(t,n){var e=t[0],r=t[1],i=[Math.sin(e),-Math.cos(e),0],a=0,o=0;su.reset();for(var u=0,s=n.length;u<s;++u){var l=n[u],
c=l.length;if(c)for(var f=l[0],h=f[0],g=f[1]/2+bo/4,d=Math.sin(g),p=Math.cos(g),_=1;;){_===c&&(_=0);var v=(t=l[_])[0],y=t[1]/2+bo/4,m=Math.sin(y),x=Math.cos(y),b=v-h,M=eo(b)>bo,w=d*m;if(su.add(Math.atan2(w*Math.sin(b),p*x+w*Math.cos(b))),a+=M?b+(0<=b?Mo:-Mo):b,M^e<=h^e<=v){var k=Tt(Lt(f),Lt(t));Dt(k);var S=Tt(i,k);Dt(S);var $=(M^0<=b?-1:1)*j(S[2]);($<r||r===$&&(k[0]||k[1]))&&(o+=M^0<=b?1:-1)}if(!_++)break;h=v,d=m,p=x,f=t}}return(a<-ko||a<ko&&su<0)^1&o}function Qt(i){var a,o=NaN,u=NaN,s=NaN;return{lineStart:function(){i.lineStart(),a=1},point:function(t,n){var e=0<t?bo:-bo,r=eo(t-o);eo(r-bo)<ko?(i.point(o,u=0<(u+n)/2?wo:-wo),i.point(s,u),i.lineEnd(),i.lineStart(),i.point(e,u),i.point(t,u),a=0):s!==e&&bo<=r&&(eo(o-s)<ko&&(o-=s*ko),eo(t-e)<ko&&(t-=e*ko),u=tn(o,u,t,n),i.point(s,u),i.lineEnd(),i.lineStart(),i.point(e,u),a=0),i.point(o=t,u=n),s=e},lineEnd:function(){i.lineEnd(),o=u=NaN},clean:function(){return 2-a}}}function tn(t,n,e,r){var i,a,o=Math.sin(t-e);return eo(o)>ko?Math.atan((Math.sin(n)*(a=Math.cos(r))*Math.sin(e)-Math.sin(r)*(i=Math.cos(n))*Math.sin(t))/(i*a*o)):(n+r)/2}function nn(t,n,e,r){var i;if(null==t)i=e*wo,r.point(-bo,i),r.point(0,i),r.point(bo,i),r.point(bo,0),r.point(bo,-i),r.point(0,-i),r.point(-bo,-i),r.point(-bo,0),r.point(-bo,i);else if(eo(t[0]-n[0])>ko){var a=t[0]<n[0]?bo:-bo;i=e*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(n[0],n[1])}function en(i){function g(t,n){return Math.cos(t)*Math.cos(n)>$}function t(u){var s,l,c,f,h;return{lineStart:function(){f=c=!1,h=1},point:function(t,n){var e,r=[t,n],i=g(t,n),a=_?i?0:p(t,n):i?p(t+(t<0?bo:-bo),n):0;if(!s&&(f=c=i)&&u.lineStart(),i!==c&&(e=d(s,r),(Pt(s,e)||Pt(r,e))&&(r[0]+=ko,r[1]+=ko,i=g(r[0],r[1]))),i!==c)h=0,i?(u.lineStart(),e=d(r,s),u.point(e[0],e[1])):(e=d(s,r),u.point(e[0],e[1]),u.lineEnd()),s=e;else if(v&&s&&_^i){var o;a&l||!(o=d(r,s,!0))||(h=0,_?(u.lineStart(),u.point(o[0][0],o[0][1]),u.point(o[1][0],o[1][1]),u.lineEnd()):(u.point(o[1][0],o[1][1]),u.lineEnd(),u.lineStart(),u.point(o[0][0],o[0][1])))}!i||s&&Pt(s,r)||u.point(r[0],r[1]),s=r,c=i,l=a},lineEnd:function(){c&&u.lineEnd(),s=null},clean:function(){return h|(f&&c)<<1}}}function d(t,n,e){var r=[1,0,0],i=Tt(Lt(t),Lt(n)),a=Rt(i,i),o=i[0],u=a-o*o;if(!u)return!e&&t;var s=$*a/u,l=-$*o/u,c=Tt(r,i),f=Ft(r,s);zt(f,Ft(i,l));var h=c,g=Rt(f,h),d=Rt(h,h),p=g*g-d*(Rt(f,f)-1);if(!(p<0)){var _=Math.sqrt(p),v=Ft(h,(-g-_)/d);if(zt(v,f),v=qt(v),!e)return v;var y,m=t[0],x=n[0],b=t[1],M=n[1];x<m&&(y=m,m=x,x=y);var w=x-m,k=eo(w-bo)<ko;if(!k&&M<b&&(y=b,b=M,M=y),k||w<ko?k?0<b+M^v[1]<(eo(v[0]-m)<ko?b:M):b<=v[1]&&v[1]<=M:bo<w^(m<=v[0]&&v[0]<=x)){var S=Ft(h,(-g+_)/d);return zt(S,f),[v,qt(S)]}}}function p(t,n){var e=_?i:bo-i,r=0;return t<-e?r|=1:e<t&&(r|=2),n<-e?r|=4:e<n&&(r|=8),r}var $=Math.cos(i),_=0<$,v=eo($)>ko;return Wt(g,t,Cn(i,6*$o),_?[0,-i]:[-bo,i-bo])}function rn(c,f,h,g){return function(t){var n,e=t.a,r=t.b,i=e.x,a=e.y,o=0,u=1,s=r.x-i,l=r.y-a;if(n=c-i,s||!(0<n)){if(n/=s,s<0){if(n<o)return;n<u&&(u=n)}else if(0<s){if(u<n)return;o<n&&(o=n)}if(n=h-i,s||!(n<0)){if(n/=s,s<0){if(u<n)return;o<n&&(o=n)}else if(0<s){if(n<o)return;n<u&&(u=n)}if(n=f-a,l||!(0<n)){if(n/=l,l<0){if(n<o)return;n<u&&(u=n)}else if(0<l){if(u<n)return;o<n&&(o=n)}if(n=g-a,l||!(n<0)){if(n/=l,l<0){if(u<n)return;o<n&&(o=n)}else if(0<l){if(n<o)return;n<u&&(u=n)}return 0<o&&(t.a={x:i+o*s,y:a+o*l}),u<1&&(t.b={x:i+u*s,y:a+u*l}),t}}}}}}function an(k,S,$,N){function A(t,n){return eo(t[0]-k)<ko?0<n?0:3:eo(t[0]-$)<ko?0<n?2:1:eo(t[1]-S)<ko?0<n?1:0:0<n?3:2}function E(t,n){return C(t.x,n.x)}function C(t,n){var e=A(t,1),r=A(n,1);return e!==r?e-r:0===e?n[1]-t[1]:1===e?t[0]-n[0]:2===e?t[1]-n[1]:n[0]-t[0]}return function(i){function r(t){for(var n=0,e=f.length,r=t[1],i=0;i<e;++i)for(var a,o=1,u=f[i],s=u.length,l=u[0];o<s;++o)a=u[o],l[1]<=r?a[1]>r&&0<c(l,a,t)&&++n:a[1]<=r&&c(l,a,t)<0&&--n,l=a;return 0!==n}function c(t,n,e){return(n[0]-t[0])*(e[1]-t[1])-(e[0]-t[0])*(n[1]-t[1])}function a(t,n,e,r){var i=0,a=0;if(null==t||(i=A(t,e))!==(a=A(n,e))||C(t,n)<0^0<e)for(;r.point(0===i||3===i?k:$,1<i?N:S),(i=(i+e+4)%4)!==a;);else r.point(n[0],n[1])}function o(t,n){return k<=t&&t<=$&&S<=n&&n<=N}function t(t,n){o(t,n)&&i.point(t,n)}function n(){w.point=u,f&&f.push(l=[]),v=!(y=!0),p=_=NaN}function e(){s&&(u(h,g),d&&v&&b.rejoin(),s.push(b.buffer())),w.point=t,v&&i.lineEnd()}function u(t,n){var e=o(t=Math.max(-wu,Math.min(wu,t)),n=Math.max(-wu,Math.min(wu,n)));if(f&&l.push([t,n]),y)h=t,g=n,y=!1,(d=e)&&(i.lineStart(),i.point(t,n));else if(e&&v)i.point(t,n);else{var r={a:{x:p,y:_},b:{x:t,y:n}};M(r)?(v||(i.lineStart(),i.point(r.a.x,r.a.y)),i.point(r.b.x,r.b.y),e||i.lineEnd(),m=!1):e&&(i.lineStart(),i.point(t,n),m=!1)}p=t,_=n,v=e}var s,f,l,h,g,d,p,_,v,y,m,x=i,b=Zt(),M=rn(k,S,$,N),w={point:t,lineStart:n,lineEnd:e,polygonStart:function(){i=b,s=[],f=[],m=!0},polygonEnd:function(){i=x,s=Va.merge(s);var t=r([k,N]),n=m&&t,e=s.length;(n||e)&&(i.polygonStart(),n&&(i.lineStart(),a(null,null,1,i),i.lineEnd()),e&&Yt(s,E,t,a,i),i.polygonEnd()),s=f=l=null}};return w}}function on(e,r){function t(t,n){return t=e(t,n),r(t[0],t[1])}return e.invert&&r.invert&&(t.invert=function(t,n){return(t=r.invert(t,n))&&e.invert(t[0],t[1])}),t}function un(t){var n=0,e=bo/3,r=Mn(t),i=r(n,e);return i.parallels=function(t){return arguments.length?r(n=t[0]*bo/180,e=t[1]*bo/180):[n/bo*180,e/bo*180]},i}function sn(t,n){function e(t,n){var e=Math.sqrt(a-2*i*Math.sin(n))/i;return[e*Math.sin(t*=i),o-e*Math.cos(t)]}var r=Math.sin(t),i=(r+Math.sin(n))/2,a=1+r*(2*i-r),o=Math.sqrt(a)/i;return e.invert=function(t,n){var e=o-n;return[Math.atan2(t,e)/i,j((a-(t*t+e*e)*i*i)/(2*i))]},e}function ln(){function e(t,n){Su+=o*t-a*n,a=t,o=n}var r,i,a,o;Cu.point=function(t,n){Cu.point=e,r=a=t,i=o=n},Cu.lineEnd=function(){e(r,i)}}function cn(t,n){t<$u&&($u=t),Au<t&&(Au=t),n<Nu&&(Nu=n),Eu<n&&(Eu=n)}function fn(){function t(t,n){o.push("M",t,",",n,a)}function n(t,n){o.push("M",t,",",n),u.point=e}function e(t,n){o.push("L",t,",",n)}function r(){u.point=t}function i(){o.push("Z")}var a=hn(4.5),o=[],u={point:t,lineStart:function(){u.point=n},lineEnd:r,polygonStart:function(){u.lineEnd=i},polygonEnd:function(){u.lineEnd=r,u.point=t},pointRadius:function(t){return a=hn(t),u},result:function(){if(o.length){var t=o.join("");return o=[],t}}};return u}function hn(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function gn(t,n){hu+=t,gu+=n,++du}function dn(){function e(t,n){var e=t-a,r=n-o,i=Math.sqrt(e*e+r*r);pu+=i*(a+t)/2,_u+=i*(o+n)/2,vu+=i,gn(a=t,o=n)}var a,o;Ru.point=function(t,n){Ru.point=e,gn(a=t,o=n)}}function pn(){Ru.point=gn}function _n(){function e(t,n){var e=t-a,r=n-o,i=Math.sqrt(e*e+r*r);pu+=i*(a+t)/2,_u+=i*(o+n)/2,vu+=i,yu+=(i=o*t-a*n)*(a+t),mu+=i*(o+n),xu+=3*i,gn(a=t,o=n)}var r,i,a,o;Ru.point=function(t,n){Ru.point=e,gn(r=a=t,i=o=n)},Ru.lineEnd=function(){e(r,i)}}function vn(e){function t(t,n){e.moveTo(t,n),e.arc(t,n,o,0,Mo)}function n(t,n){e.moveTo(t,n),u.point=r}function r(t,n){e.lineTo(t,n)}function i(){u.point=t}function a(){e.closePath()}var o=4.5,u={point:t,lineStart:function(){u.point=n},lineEnd:i,polygonStart:function(){u.lineEnd=a},polygonEnd:function(){u.lineEnd=i,u.point=t},pointRadius:function(t){return o=t,u},result:f};return u}function yn(E){function n(i){function t(t,n){t=E(t,n),i.point(t[0],t[1])}function n(){p=NaN,x.point=e,i.lineStart()}function e(t,n){var e=Lt([t,n]),r=E(t,n);C(p,_,d,v,y,m,p=r[0],_=r[1],d=t,v=e[0],y=e[1],m=e[2],b,i),i.point(p,_)}function r(){x.point=t,i.lineEnd()}function a(){n(),x.point=o,x.lineEnd=u}function o(t,n){e(s=t,n),l=p,c=_,f=v,h=y,g=m,x.point=e}function u(){C(p,_,d,v,y,m,l,c,s,f,h,g,b,i),(x.lineEnd=r)()}var s,l,c,f,h,g,d,p,_,v,y,m,x={point:t,lineStart:n,lineEnd:r,polygonStart:function(){i.polygonStart(),x.lineStart=a},polygonEnd:function(){i.polygonEnd(),x.lineStart=n}};return x}function C(t,n,e,r,i,a,o,u,s,l,c,f,h,g){var d=o-t,p=u-n,_=d*d+p*p;if(4*L<_&&h--){var v=r+l,y=i+c,m=a+f,x=Math.sqrt(v*v+y*y+m*m),b=Math.asin(m/=x),M=eo(eo(m)-1)<ko?(e+s)/2:Math.atan2(y,v),w=E(M,b),k=w[0],S=w[1],$=k-t,N=S-n,A=p*$-d*N;(L<A*A/_||.3<eo((d*$+p*N)/_-.5)||r*l+i*c+a*f<R)&&(C(t,n,e,r,i,a,k,S,M,v/=x,y/=x,m,h,g),g.point(k,S),C(k,S,M,v,y,m,o,u,s,l,c,f,h,g))}}var L=.5,R=Math.cos(30*$o),b=16;return n.precision=function(t){return arguments.length?(b=0<(L=t*t)&&16,n):Math.sqrt(L)},n}function mn(t){this.stream=t}function xn(e){var n=yn(function(t,n){return e([t*No,n*No])});return function(e){var t=new mn(e=n(e));return t.point=function(t,n){e.point(t*$o,n*$o)},t}}function bn(t){return Mn(function(){return t})()}function Mn(t){function n(t){return[(t=u(t[0]*$o,t[1]*$o))[0]*h+s,l-t[1]*h]}function e(t){return(t=u.invert((t[0]-s)/h,(l-t[1])/h))&&[t[0]*No,t[1]*No]}function r(){u=on(o=$n(v,y,m),a);var t=a(p,_);return s=g-t[0]*h,l=d+t[1]*h,i()}function i(){return c&&(c.valid=!1,c=null),n}var a,o,u,s,l,c,f=yn(function(t,n){return[(t=a(t,n))[0]*h+s,l-t[1]*h]}),h=150,g=480,d=250,p=0,_=0,v=0,y=0,m=0,x=Mu,b=pt,M=null,w=null;return n.stream=function(t){return c&&(c.valid=!1),(c=wn(x(o,f(b(t))))).valid=!0,c},n.clipAngle=function(t){return arguments.length?(x=null==t?(M=t,Mu):en((M=+t)*$o),i()):M},n.clipExtent=function(t){return arguments.length?(b=(w=t)?an(t[0][0],t[0][1],t[1][0],t[1][1]):pt,i()):w},n.scale=function(t){return arguments.length?(h=+t,r()):h},n.translate=function(t){return arguments.length?(g=+t[0],d=+t[1],r()):[g,d]},n.center=function(t){return arguments.length?(p=t[0]%360*$o,_=t[1]%360*$o,r()):[p*No,_*No]},n.rotate=function(t){return arguments.length?(v=t[0]%360*$o,y=t[1]%360*$o,m=2<t.length?t[2]%360*$o:0,r()):[v*No,y*No,m*No]},Va.rebind(n,f,"precision"),function(){return a=t.apply(this,arguments),n.invert=a.invert&&e,r()}}function wn(e){var t=new mn(e);return t.point=function(t,n){e.point(t*$o,n*$o)},t}function kn(t,n){return[t,n]}function Sn(t,n){return[bo<t?t-Mo:t<-bo?t+Mo:t,n]}function $n(t,n,e){return t?n||e?on(An(t),En(n,e)):An(t):n||e?En(n,e):Sn}function Nn(e){return function(t,n){return[bo<(t+=e)?t-Mo:t<-bo?t+Mo:t,n]}}function An(t){var n=Nn(t);return n.invert=Nn(-t),n}function En(t,n){function e(t,n){var e=Math.cos(n),r=Math.cos(t)*e,i=Math.sin(t)*e,a=Math.sin(n),o=a*u+r*s;return[Math.atan2(i*l-o*c,r*u-a*s),j(o*l+i*c)]}var u=Math.cos(t),s=Math.sin(t),l=Math.cos(n),c=Math.sin(n);return e.invert=function(t,n){var e=Math.cos(n),r=Math.cos(t)*e,i=Math.sin(t)*e,a=Math.sin(n),o=a*l-i*c;return[Math.atan2(i*l+a*c,r*u+o*s),j(o*u-r*s)]},e}function Cn(u,s){var l=Math.cos(u),c=Math.sin(u);return function(t,n,e,r){var i=e*s;null!=t?(t=Ln(l,t),n=Ln(l,n),(0<e?t<n:n<t)&&(t+=e*Mo)):(t=u+e*Mo,n=u-.5*i);for(var a,o=t;0<e?n<o:o<n;o-=i)r.point((a=qt([l,-c*Math.cos(o),-c*Math.sin(o)]))[0],a[1])}}function Ln(t,n){var e=Lt(n);e[0]-=t,Dt(e);var r=P(-e[1]);return((-e[2]<0?-r:r)+2*Math.PI-ko)%(2*Math.PI)}function Rn(t,n,e){var r=Va.range(t,n-ko,e).concat(n);return function(n){return r.map(function(t){return[n,t]})}}function Tn(t,n,e){var r=Va.range(t,n-ko,e).concat(n);return function(n){return r.map(function(t){return[t,n]})}}function zn(t){return t.source}function Fn(t){return t.target}function Dn(t,n,e,r){var i=Math.cos(n),o=Math.sin(n),a=Math.cos(r),u=Math.sin(r),s=i*Math.cos(t),l=i*Math.sin(t),c=a*Math.cos(e),f=a*Math.sin(e),h=2*Math.asin(Math.sqrt(I(r-n)+i*a*I(e-t))),g=1/Math.sin(h),d=h?function(t){var n=Math.sin(t*=h)*g,e=Math.sin(h-t)*g,r=e*s+n*c,i=e*l+n*f,a=e*o+n*u;return[Math.atan2(i,r)*No,Math.atan2(a,Math.sqrt(r*r+i*i))*No]}:function(){return[t*No,n*No]};return d.distance=h,d}function qn(){function e(t,n){var e=Math.sin(n*=$o),r=Math.cos(n),i=eo((t*=$o)-o),a=Math.cos(i);Tu+=Math.atan2(Math.sqrt((i=r*Math.sin(i))*i+(i=s*e-u*r*a)*i),u*e+s*r*a),o=t,u=e,s=r}var o,u,s;zu.point=function(t,n){o=t*$o,u=Math.sin(n*=$o),s=Math.cos(n),zu.point=e},zu.lineEnd=function(){zu.point=zu.lineEnd=f}}function Pn(a,o){function t(t,n){var e=Math.cos(t),r=Math.cos(n),i=a(e*r);return[i*r*Math.sin(t),i*Math.sin(n)]}return t.invert=function(t,n){var e=Math.sqrt(t*t+n*n),r=o(e),i=Math.sin(r),a=Math.cos(r);return[Math.atan2(t*i,e*a),Math.asin(e&&n*i/e)]},t}function jn(t,n){function e(t,n){var e=eo(eo(n)-wo)<ko?0:o/Math.pow(i(n),a);return[e*Math.sin(a*t),o-e*Math.cos(a*t)]}var r=Math.cos(t),i=function(t){return Math.tan(bo/4+t/2)},a=t===n?Math.sin(t):Math.log(r/Math.cos(n))/Math.log(i(n)/i(t)),o=r*Math.pow(i(t),a)/a;return a?(e.invert=function(t,n){var e=o-n,r=q(a)*Math.sqrt(t*t+e*e);return[Math.atan2(t,e)/a,2*Math.atan(Math.pow(o/r,1/a))-wo]},e):Un}function On(t,n){function e(t,n){var e=a-n;return[e*Math.sin(i*t),a-e*Math.cos(i*t)]}var r=Math.cos(t),i=t===n?Math.sin(t):(r-Math.cos(n))/(n-t),a=r/i+t;return eo(i)<ko?kn:(e.invert=function(t,n){var e=a-n;return[Math.atan2(t,e)/i,a-q(i)*Math.sqrt(t*t+e*e)]},e)}function Un(t,n){return[t,Math.log(Math.tan(bo/4+n/2))]}function Hn(t){var i,a=bn(t),o=a.scale,u=a.translate,s=a.clipExtent;return a.scale=function(){var t=o.apply(a,arguments);return t===a?i?a.clipExtent(null):a:t},a.translate=function(){var t=u.apply(a,arguments);return t===a?i?a.clipExtent(null):a:t},a.clipExtent=function(t){var n=s.apply(a,arguments);if(n===a){if(i=null==t){var e=bo*o(),r=u();s([[r[0]-e,r[1]-e],[r[0]+e,r[1]+e]])}}else i&&(n=null);return n},a.clipExtent(null)}function In(t,n){var e=Math.cos(n)*Math.sin(t);return[Math.log((1+e)/(1-e))/2,Math.atan2(Math.tan(n),Math.cos(t))]}function Vn(t){return t[0]}function Yn(t){return t[1]}function Bn(t,n,e,r){var i,a,o,u,s,l;return a=(i=r[t])[0],o=i[1],u=(i=r[n])[0],s=i[1],l=(i=r[e])[0],0<(i[1]-o)*(u-a)-(s-o)*(l-a)}function Gn(t,n,e){return(e[0]-n[0])*(t[1]-n[1])<(e[1]-n[1])*(t[0]-n[0])}function Wn(t,n,e,r){var i=t[0],a=e[0],o=n[0]-i,u=r[0]-a,s=t[1],l=e[1],c=n[1]-s,f=r[1]-l,h=(u*(s-l)-f*(i-a))/(f*o-u*c);return[i+h*o,s+h*c]}function Xn(t){var n=t[0],e=t[t.length-1];return!(n[0]-e[0]||n[1]-e[1])}function Zn(){ve(this),this.edge=this.site=this.circle=null}function Kn(t){var n=Bu.pop()||new Zn;return n.site=t,n}function Jn(t){se(t),Iu.remove(t),Bu.push(t),ve(t)}function Qn(t){var n=t.circle,e=n.x,r=n.cy,i={x:e,y:r},a=t.P,o=t.N,u=[t];Jn(t);for(var s=a;s.circle&&eo(e-s.circle.x)<ko&&eo(r-s.circle.cy)<ko;)a=s.P,u.unshift(s),Jn(s),s=a;u.unshift(s),se(s);for(var l=o;l.circle&&eo(e-l.circle.x)<ko&&eo(r-l.circle.cy)<ko;)o=l.N,u.push(l),Jn(l),l=o;u.push(l),se(l);var c,f=u.length;for(c=1;c<f;++c)l=u[c],s=u[c-1],de(l.edge,s.site,l.site,i);s=u[0],(l=u[f-1]).edge=he(s.site,l.site,null,i),ue(s),ue(l)}function te(t){for(var n,e,r,i,a=t.x,o=t.y,u=Iu._;u;)if(r=ne(u,o)-a,ko<r)u=u.L;else{if(i=a-ee(u,o),!(ko<i)){-ko<r?(n=u.P,e=u):-ko<i?e=(n=u).N:n=e=u;break}if(!u.R){n=u;break}u=u.R}var s=Kn(t);if(Iu.insert(n,s),n||e){if(n===e)return se(n),e=Kn(n.site),Iu.insert(s,e),s.edge=e.edge=he(n.site,s.site),ue(n),void ue(e);if(!e)return void(s.edge=he(n.site,s.site));se(n),se(e);var l=n.site,c=l.x,f=l.y,h=t.x-c,g=t.y-f,d=e.site,p=d.x-c,_=d.y-f,v=2*(h*_-g*p),y=h*h+g*g,m=p*p+_*_,x={x:(_*y-g*m)/v+c,y:(h*m-p*y)/v+f};de(e.edge,l,d,x),s.edge=he(l,t,null,x),e.edge=he(t,d,null,x),ue(n),ue(e)}}function ne(t,n){var e=t.site,r=e.x,i=e.y,a=i-n;if(!a)return r;var o=t.P;if(!o)return-1/0;var u=(e=o.site).x,s=e.y,l=s-n;if(!l)return u;var c=u-r,f=1/a-1/l,h=c/l;return f?(-h+Math.sqrt(h*h-2*f*(c*c/(-2*l)-s+l/2+i-a/2)))/f+r:(r+u)/2}function ee(t,n){var e=t.N;if(e)return ne(e,n);var r=t.site;return r.y===n?r.x:1/0}function re(t){this.site=t,this.edges=[]}function ie(t){for(var n,e,r,i,a,o,u,s,l,c,f=t[0][0],h=t[1][0],g=t[0][1],d=t[1][1],p=Hu,_=p.length;_--;)if((a=p[_])&&a.prepare())for(s=(u=a.edges).length,o=0;o<s;)r=(c=u[o].end()).x,i=c.y,n=(l=u[++o%s].start()).x,e=l.y,(eo(r-n)>ko||eo(i-e)>ko)&&(u.splice(o,0,new pe(ge(a.site,c,eo(r-f)<ko&&ko<d-i?{x:f,y:eo(n-f)<ko?e:d}:eo(i-d)<ko&&ko<h-r?{x:eo(e-d)<ko?n:h,y:d}:eo(r-h)<ko&&ko<i-g?{x:h,y:eo(n-h)<ko?e:g}:eo(i-g)<ko&&ko<r-f?{x:eo(e-g)<ko?n:f,y:g}:null),a.site,null)),++s)}function ae(t,n){return n.angle-t.angle}function oe(){ve(this),this.x=this.y=this.arc=this.site=this.cy=null}function ue(t){var n=t.P,e=t.N;if(n&&e){var r=n.site,i=t.site,a=e.site;if(r!==a){var o=i.x,u=i.y,s=r.x-o,l=r.y-u,c=a.x-o,f=2*(s*(_=a.y-u)-l*c);if(!(-So<=f)){var h=s*s+l*l,g=c*c+_*_,d=(_*h-l*g)/f,p=(s*g-c*h)/f,_=p+u,v=Gu.pop()||new oe;v.arc=t,v.site=i,v.x=d+o,v.y=_+Math.sqrt(d*d+p*p),v.cy=_,t.circle=v;for(var y=null,m=Yu._;m;)if(v.y<m.y||v.y===m.y&&v.x<=m.x){if(!m.L){y=m.P;break}m=m.L}else{if(!m.R){y=m;break}m=m.R}Yu.insert(y,v),y||(Vu=v)}}}}function se(t){var n=t.circle;n&&(n.P||(Vu=n.N),Yu.remove(n),Gu.push(n),ve(n),t.circle=null)}function le(t){for(var n,e=Uu,r=rn(t[0][0],t[0][1],t[1][0],t[1][1]),i=e.length;i--;)(!ce(n=e[i],t)||!r(n)||eo(n.a.x-n.b.x)<ko&&eo(n.a.y-n.b.y)<ko)&&(n.a=n.b=null,e.splice(i,1))}function ce(t,n){var e=t.b;if(e)return!0;var r,i,a=t.a,o=n[0][0],u=n[1][0],s=n[0][1],l=n[1][1],c=t.l,f=t.r,h=c.x,g=c.y,d=f.x,p=f.y,_=(h+d)/2,v=(g+p)/2;if(p===g){if(_<o||u<=_)return;if(d<h){if(a){if(a.y>=l)return}else a={x:_,y:s};e={x:_,y:l}}else{if(a){if(a.y<s)return}else a={x:_,y:l};e={x:_,y:s}}}else if(i=v-(r=(h-d)/(p-g))*_,r<-1||1<r)if(d<h){if(a){if(a.y>=l)return}else a={x:(s-i)/r,y:s};e={x:(l-i)/r,y:l}}else{if(a){if(a.y<s)return}else a={x:(l-i)/r,y:l};e={x:(s-i)/r,y:s}}else if(g<p){if(a){if(a.x>=u)return}else a={x:o,y:r*o+i};e={x:u,y:r*u+i}}else{if(a){if(a.x<o)return}else a={x:u,y:r*u+i};e={x:o,y:r*o+i}}return t.a=a,t.b=e,!0}function fe(t,n){this.l=t,this.r=n,this.a=this.b=null}function he(t,n,e,r){var i=new fe(t,n);return Uu.push(i),e&&de(i,t,n,e),r&&de(i,n,t,r),Hu[t.i].edges.push(new pe(i,t,n)),Hu[n.i].edges.push(new pe(i,n,t)),i}function ge(t,n,e){var r=new fe(t,null);return r.a=n,r.b=e,Uu.push(r),r}function de(t,n,e,r){t.a||t.b?t.l===e?t.b=r:t.a=r:(t.a=r,t.l=n,t.r=e)}function pe(t,n,e){var r=t.a,i=t.b;this.edge=t,this.site=n,this.angle=e?Math.atan2(e.y-n.y,e.x-n.x):t.l===n?Math.atan2(i.x-r.x,r.y-i.y):Math.atan2(r.x-i.x,i.y-r.y)}function _e(){this._=null}function ve(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function ye(t,n){var e=n,r=n.R,i=e.U;i?i.L===e?i.L=r:i.R=r:t._=r,r.U=i,e.U=r,e.R=r.L,e.R&&(e.R.U=e),r.L=e}function me(t,n){var e=n,r=n.L,i=e.U;i?i.L===e?i.L=r:i.R=r:t._=r,r.U=i,e.U=r,e.L=r.R,e.L&&(e.L.U=e),r.R=e}function xe(t){for(;t.L;)t=t.L;return t}function be(t,n){var e,r,i,a=t.sort(Me).pop();for(Uu=[],Hu=new Array(t.length),Iu=new _e,Yu=new _e;;)if(i=Vu,a&&(!i||a.y<i.y||a.y===i.y&&a.x<i.x))(a.x!==e||a.y!==r)&&(Hu[a.i]=new re(a),te(a),e=a.x,r=a.y),a=t.pop();else{if(!i)break;Qn(i.arc)}n&&(le(n),ie(n));var o={cells:Hu,edges:Uu};return Iu=Yu=Uu=Hu=null,o}function Me(t,n){return n.y-t.y||n.x-t.x}function we(t,n,e){return(t.x-e.x)*(n.y-t.y)-(t.x-n.x)*(e.y-t.y)}function ke(t){return t.x}function Se(t){return t.y}function $e(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function Ne(t,n,e,r,i,a){if(!t(n,e,r,i,a)){var o=.5*(e+i),u=.5*(r+a),s=n.nodes;s[0]&&Ne(t,s[0],e,r,o,u),s[1]&&Ne(t,s[1],o,r,i,u),s[2]&&Ne(t,s[2],e,u,o,a),s[3]&&Ne(t,s[3],o,u,i,a)}}function Ae(t,n){t=Va.rgb(t),n=Va.rgb(n);var e=t.r,r=t.g,i=t.b,a=n.r-e,o=n.g-r,u=n.b-i;return function(t){return"#"+st(Math.round(e+a*t))+st(Math.round(r+o*t))+st(Math.round(i+u*t))}}function Ee(t,n){var e,r={},i={};for(e in t)e in n?r[e]=Re(t[e],n[e]):i[e]=t[e];for(e in n)e in t||(i[e]=n[e]);return function(t){for(e in r)i[e]=r[e](t);return i}}function Ce(n,e){return e-=n=+n,function(t){return n+e*t}}function Le(t,n){var e,r,i,a,o,u=0,s=[],l=[];for(t+="",n+="",Xu.lastIndex=0,r=0;e=Xu.exec(n);++r)e.index&&s.push(n.substring(u,e.index)),l.push({i:s.length,x:e[0]}),s.push(null),u=Xu.lastIndex;for(u<n.length&&s.push(n.substring(u)),r=0,a=l.length;(e=Xu.exec(t))&&r<a;++r)if((o=l[r]).x==e[0]){if(o.i)if(null==s[o.i+1])for(s[o.i-1]+=o.x,s.splice(o.i,1),i=r+1;i<a;++i)l[i].i--;else for(s[o.i-1]+=o.x+s[o.i+1],s.splice(o.i,2),i=r+1;i<a;++i)l[i].i-=2;else if(null==s[o.i+1])s[o.i]=o.x;else for(s[o.i]=o.x+s[o.i+1],s.splice(o.i+1,1),i=r+1;i<a;++i)l[i].i--;l.splice(r,1),a--,r--}else o.x=Ce(parseFloat(e[0]),parseFloat(o.x));for(;r<a;)o=l.pop(),null==s[o.i+1]?s[o.i]=o.x:(s[o.i]=o.x+s[o.i+1],s.splice(o.i+1,1)),a--;return 1===s.length?null==s[0]?(o=l[0].x,function(t){return o(t)+""}):function(){return n}:function(t){for(r=0;r<a;++r)s[(o=l[r]).i]=o.x(t);return s.join("")}}function Re(t,n){for(var e,r=Va.interpolators.length;0<=--r&&!(e=Va.interpolators[r](t,n)););return e}function Te(t,n){var e,r=[],i=[],a=t.length,o=n.length,u=Math.min(t.length,n.length);for(e=0;e<u;++e)r.push(Re(t[e],n[e]));for(;e<a;++e)i[e]=t[e];for(;e<o;++e)i[e]=n[e];return function(t){for(e=0;e<u;++e)i[e]=r[e](t);return i}}function ze(n){return function(t){return t<=0?0:1<=t?1:n(t)}}function Fe(n){return function(t){return 1-n(1-t)}}function De(n){return function(t){return.5*(t<.5?n(2*t):2-n(2-2*t))}}function qe(t){return t*t}function Pe(t){return t*t*t}function je(t){if(t<=0)return 0;if(1<=t)return 1;var n=t*t,e=n*t;return 4*(t<.5?e:3*(t-n)+e-.75)}function Oe(n){return function(t){return Math.pow(t,n)}}function Ue(t){return 1-Math.cos(t*wo)}function He(t){return Math.pow(2,10*(t-1))}function Ie(t){return 1-Math.sqrt(1-t*t)}function Ve(n,e){var r;return arguments.length<2&&(e=.45),arguments.length?r=e/Mo*Math.asin(1/n):(n=1,r=e/4),function(t){return 1+n*Math.pow(2,-10*t)*Math.sin((t-r)*Mo/e)}}function Ye(n){return n||(n=1.70158),function(t){return t*t*((n+1)*t-n)}}function Be(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function Ge(t,n){t=Va.hcl(t),n=Va.hcl(n);var e=t.h,r=t.c,i=t.l,a=n.h-e,o=n.c-r,u=n.l-i;return isNaN(o)&&(o=0,r=isNaN(r)?n.c:r),isNaN(a)?(a=0,e=isNaN(e)?n.h:e):180<a?a-=360:a<-180&&(a+=360),function(t){return Z(e+a*t,r+o*t,i+u*t)+""}}function We(t,n){t=Va.hsl(t),n=Va.hsl(n);var e=t.h,r=t.s,i=t.l,a=n.h-e,o=n.s-r,u=n.l-i;return isNaN(o)&&(o=0,r=isNaN(r)?n.s:r),isNaN(a)?(a=0,e=isNaN(e)?n.h:e):180<a?a-=360:a<-180&&(a+=360),function(t){return G(e+a*t,r+o*t,i+u*t)+""}}function Xe(t,n){t=Va.lab(t),n=Va.lab(n);var e=t.l,r=t.a,i=t.b,a=n.l-e,o=n.a-r,u=n.b-i;return function(t){return Q(e+a*t,r+o*t,i+u*t)+""}}function Ze(n,e){return e-=n,function(t){return Math.round(n+e*t)}}function Ke(t){var n=[t.a,t.b],e=[t.c,t.d],r=Qe(n),i=Je(n,e),a=Qe(tr(e,n,-i))||0;n[0]*e[1]<e[0]*n[1]&&(n[0]*=-1,n[1]*=-1,r*=-1,i*=-1),this.rotate=(r?Math.atan2(n[1],n[0]):Math.atan2(-e[0],e[1]))*No,this.translate=[t.e,t.f],this.scale=[r,a],this.skew=a?Math.atan2(i,a)*No:0}function Je(t,n){return t[0]*n[0]+t[1]*n[1]}function Qe(t){var n=Math.sqrt(Je(t,t));return n&&(t[0]/=n,t[1]/=n),n}function tr(t,n,e){return t[0]+=e*n[0],t[1]+=e*n[1],t}function nr(t,n){var r,i=[],a=[],e=Va.transform(t),o=Va.transform(n),u=e.translate,s=o.translate,l=e.rotate,c=o.rotate,f=e.skew,h=o.skew,g=e.scale,d=o.scale;return u[0]!=s[0]||u[1]!=s[1]?(i.push("translate(",null,",",null,")"),a.push({i:1,x:Ce(u[0],s[0])},{i:3,x:Ce(u[1],s[1])})):s[0]||s[1]?i.push("translate("+s+")"):i.push(""),l!=c?(180<l-c?c+=360:180<c-l&&(l+=360),a.push({i:i.push(i.pop()+"rotate(",null,")")-2,x:Ce(l,c)})):c&&i.push(i.pop()+"rotate("+c+")"),f!=h?a.push({i:i.push(i.pop()+"skewX(",null,")")-2,x:Ce(f,h)}):h&&i.push(i.pop()+"skewX("+h+")"),g[0]!=d[0]||g[1]!=d[1]?(r=i.push(i.pop()+"scale(",null,",",null,")"),a.push({i:r-4,x:Ce(g[0],d[0])},{i:r-2,x:Ce(g[1],d[1])})):(1!=d[0]||1!=d[1])&&i.push(i.pop()+"scale("+d+")"),r=a.length,function(t){for(var n,e=-1;++e<r;)i[(n=a[e]).i]=n.x(t);return i.join("")}}function er(n,e){return e=e-(n=+n)?1/(e-n):0,function(t){return(t-n)*e}}function rr(n,e){return e=e-(n=+n)?1/(e-n):0,function(t){return Math.max(0,Math.min(1,(t-n)*e))}}function ir(t){for(var n=t.source,e=t.target,r=or(n,e),i=[n];n!==r;)n=n.parent,i.push(n);for(var a=i.length;e!==r;)i.splice(a,0,e),e=e.parent;return i}function ar(t){for(var n=[],e=t.parent;null!=e;)n.push(t),e=(t=e).parent;return n.push(t),n}function or(t,n){if(t===n)return t;for(var e=ar(t),r=ar(n),i=e.pop(),a=r.pop(),o=null;i===a;)o=i,i=e.pop(),a=r.pop();return o}function ur(t){t.fixed|=2}function sr(t){t.fixed&=-7}function lr(t){t.fixed|=4,t.px=t.x,t.py=t.y}function cr(t){t.fixed&=-5}function fr(t,n,e){var r=0,i=0;if(t.charge=0,!t.leaf)for(var a,o=t.nodes,u=o.length,s=-1;++s<u;)null!=(a=o[s])&&(fr(a,n,e),t.charge+=a.charge,r+=a.charge*a.cx,i+=a.charge*a.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var l=n*e[t.point.index];t.charge+=t.pointCharge=l,r+=l*t.point.x,i+=l*t.point.y}t.cx=r/t.charge,t.cy=i/t.charge}function hr(t,n){return Va.rebind(t,n,"sort","children","value"),(t.nodes=t).links=_r,t}function gr(t){return t.children}function dr(t){return t.value}function pr(t,n){return n.value-t.value}function _r(t){return Va.merge(t.map(function(n){return(n.children||[]).map(function(t){return{source:n,target:t}})}))}function vr(t){return t.x}function yr(t){return t.y}function mr(t,n,e){t.y0=n,t.y=e}function xr(t){return Va.range(t.length)}function br(t){for(var n=-1,e=t[0].length,r=[];++n<e;)r[n]=0;return r}function Mr(t){for(var n,e=1,r=0,i=t[0][1],a=t.length;e<a;++e)(n=t[e][1])>i&&(r=e,i=n);return r}function wr(t){return t.reduce(kr,0)}function kr(t,n){return t+n[1]}function Sr(t,n){return $r(t,Math.ceil(Math.log(n.length)/Math.LN2+1))}function $r(t,n){for(var e=-1,r=+t[0],i=(t[1]-r)/n,a=[];++e<=n;)a[e]=i*e+r;return a}function Nr(t){return[Va.min(t),Va.max(t)]}function Ar(t,n){return t.parent==n.parent?1:2}function Er(t){var n=t.children;return n&&n.length?n[0]:t._tree.thread}function Cr(t){var n,e=t.children;return e&&(n=e.length)?e[n-1]:t._tree.thread}function Lr(t,n){var e=t.children;if(e&&(i=e.length))for(var r,i,a=-1;++a<i;)0<n(r=Lr(e[a],n),t)&&(t=r);return t}function Rr(t,n){return t.x-n.x}function Tr(t,n){return n.x-t.x}function zr(t,n){return t.depth-n.depth}function Fr(t,u){function s(t,n){var e=t.children;if(e&&(i=e.length))for(var r,i,a=null,o=-1;++o<i;)s(r=e[o],a),a=r;u(t,n)}s(t,null)}function Dr(t){for(var n,e=0,r=0,i=t.children,a=i.length;0<=--a;)(n=i[a]._tree).prelim+=e,n.mod+=e,e+=n.shift+(r+=n.change)}function qr(t,n,e){t=t._tree;var r=e/((n=n._tree).number-t.number);t.change+=r,n.change-=r,n.shift+=e,n.prelim+=e,n.mod+=e}function Pr(t,n,e){return t._tree.ancestor.parent==n.parent?t._tree.ancestor:e}function jr(t,n){return t.value-n.value}function Or(t,n){var e=t._pack_next;(t._pack_next=n)._pack_prev=t,(n._pack_next=e)._pack_prev=n}function Ur(t,n){(t._pack_next=n)._pack_prev=t}function Hr(t,n){var e=n.x-t.x,r=n.y-t.y,i=t.r+n.r;return e*e+r*r<.999*i*i}function Ir(t){function n(t){c=Math.min(t.x-t.r,c),f=Math.max(t.x+t.r,f),h=Math.min(t.y-t.r,h),g=Math.max(t.y+t.r,g)}if((e=t.children)&&(l=e.length)){var e,r,i,a,o,u,s,l,c=1/0,f=-1/0,h=1/0,g=-1/0;if(e.forEach(Vr),(r=e[0]).x=-r.r,r.y=0,n(r),1<l&&((i=e[1]).x=i.r,i.y=0,n(i),2<l))for(Gr(r,i,a=e[2]),n(a),Or(r,a),Or(r._pack_prev=a,i),i=r._pack_next,o=3;o<l;o++){Gr(r,i,a=e[o]);var d=0,p=1,_=1;for(u=i._pack_next;u!==i;u=u._pack_next,p++)if(Hr(u,a)){d=1;break}if(1==d)for(s=r._pack_prev;s!==u._pack_prev&&!Hr(s,a);s=s._pack_prev,_++);d?(p<_||p==_&&i.r<r.r?Ur(r,i=u):Ur(r=s,i),o--):(Or(r,a),n(i=a))}var v=(c+f)/2,y=(h+g)/2,m=0;for(o=0;o<l;o++)(a=e[o]).x-=v,a.y-=y,m=Math.max(m,a.r+Math.sqrt(a.x*a.x+a.y*a.y));t.r=m,e.forEach(Yr)}}function Vr(t){t._pack_next=t._pack_prev=t}function Yr(t){delete t._pack_next,delete t._pack_prev}function Br(t,n,e,r){var i=t.children;if(t.x=n+=r*t.x,t.y=e+=r*t.y,t.r*=r,i)for(var a=-1,o=i.length;++a<o;)Br(i[a],n,e,r)}function Gr(t,n,e){var r=t.r+e.r,i=n.x-t.x,a=n.y-t.y;if(r&&(i||a)){var o=n.r+e.r,u=i*i+a*a,s=.5+((r*=r)-(o*=o))/(2*u),l=Math.sqrt(Math.max(0,2*o*(r+u)-(r-=u)*r-o*o))/(2*u);e.x=t.x+s*i+l*a,e.y=t.y+s*a-l*i}else e.x=t.x+r,e.y=t.y}function Wr(t){return 1+Va.max(t,function(t){return t.y})}function Xr(t){return t.reduce(function(t,n){return t+n.x},0)/t.length}function Zr(t){var n=t.children;return n&&n.length?Zr(n[0]):t}function Kr(t){var n,e=t.children;return e&&(n=e.length)?Kr(e[n-1]):t}function Jr(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function Qr(t,n){var e=t.x+n[3],r=t.y+n[0],i=t.dx-n[1]-n[3],a=t.dy-n[0]-n[2];return i<0&&(e+=i/2,i=0),a<0&&(r+=a/2,a=0),{x:e,y:r,dx:i,dy:a}}function ti(t){var n=t[0],e=t[t.length-1];return n<e?[n,e]:[e,n]}function ni(t){return t.rangeExtent?t.rangeExtent():ti(t.range())}function ei(t,n,e,r){var i=e(t[0],t[1]),a=r(n[0],n[1]);return function(t){return a(i(t))}}function ri(t,n){var e,r=0,i=t.length-1,a=t[r],o=t[i];return o<a&&(e=r,r=i,i=e,e=a,a=o,o=e),t[r]=n.floor(a),t[i]=n.ceil(o),t}function ii(n){return n?{floor:function(t){return Math.floor(t/n)*n},ceil:function(t){return Math.ceil(t/n)*n}}:as}function ai(e,t,n,r){var i=[],a=[],o=0,u=Math.min(e.length,t.length)-1;for(e[u]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<=u;)i.push(n(e[o-1],e[o])),a.push(r(t[o-1],t[o]));return function(t){var n=Va.bisect(e,t,1,u)-1;return a[n](i[n](t))}}function oi(e,r,i,a){function n(){var t=2<Math.min(e.length,r.length)?ai:ei,n=a?rr:er;return u=t(e,r,n,i),s=t(r,e,n,Re),o}function o(t){return u(t)}var u,s;return o.invert=function(t){return s(t)},o.domain=function(t){return arguments.length?(e=t.map(Number),n()):e},o.range=function(t){return arguments.length?(r=t,n()):r},o.rangeRound=function(t){return o.range(t).interpolate(Ze)},o.clamp=function(t){return arguments.length?(a=t,n()):a},o.interpolate=function(t){return arguments.length?(i=t,n()):i},o.ticks=function(t){return ci(e,t)},o.tickFormat=function(t,n){return fi(e,t,n)},o.nice=function(t){return si(e,t),n()},o.copy=function(){return oi(e,r,i,a)},n()}function ui(t,n){return Va.rebind(t,n,"range","rangeRound","interpolate","clamp")}function si(t,n){return ri(t,ii(li(t,n)[2]))}function li(t,n){null==n&&(n=10);var e=ti(t),r=e[1]-e[0],i=Math.pow(10,Math.floor(Math.log(r/n)/Math.LN10)),a=n/r*i;return a<=.15?i*=10:a<=.35?i*=5:a<=.75&&(i*=2),e[0]=Math.ceil(e[0]/i)*i,e[1]=Math.floor(e[1]/i)*i+.5*i,e[2]=i,e}function ci(t,n){return Va.range.apply(Va,li(t,n))}function fi(t,n,e){var c=-Math.floor(Math.log(li(t,n)[2])/Math.LN10+.01);return Va.format(e?e.replace(tu,function(t,n,e,r,i,a,o,u,s,l){return[n,e,r,i,a,o,u,s||"."+(c-2*("%"===l)),l].join("")}):",."+c+"f")}function hi(n,s,l,c){function f(t){return(l?Math.log(t<0?0:t):-Math.log(0<t?0:-t))/Math.log(s)}function h(t){return l?Math.pow(s,t):-Math.pow(s,-t)}function a(t){return n(f(t))}return a.invert=function(t){return h(n.invert(t))},a.domain=function(t){return arguments.length?(l=0<=t[0],n.domain((c=t.map(Number)).map(f)),a):c},a.base=function(t){return arguments.length?(s=+t,n.domain(c.map(f)),a):s},a.nice=function(){var t=ri(c.map(f),l?Math:us);return n.domain(t),c=t.map(h),a},a.ticks=function(){var t=ti(c),n=[],e=t[0],r=t[1],i=Math.floor(f(e)),a=Math.ceil(f(r)),o=s%1?2:s;if(isFinite(a-i)){if(l){for(;i<a;i++)for(var u=1;u<o;u++)n.push(h(i)*u);n.push(h(i))}else for(n.push(h(i));i++<a;)for(u=o-1;0<u;u--)n.push(h(i)*u);for(i=0;n[i]<e;i++);for(a=n.length;n[a-1]>r;a--);n=n.slice(i,a)}return n},a.tickFormat=function(t,n){if(!arguments.length)return os;arguments.length<2?n=os:"function"!=typeof n&&(n=Va.format(n));var e,r=Math.max(.1,t/a.ticks().length),i=l?(e=1e-12,Math.ceil):(e=-1e-12,Math.floor);return function(t){return t/h(i(f(t)+e))<=r?n(t):""}},a.copy=function(){return hi(n.copy(),s,l,c)},ui(a,n)}function gi(n,e,r){function i(t){return n(a(t))}var a=di(e),o=di(1/e);return i.invert=function(t){return o(n.invert(t))},i.domain=function(t){return arguments.length?(n.domain((r=t.map(Number)).map(a)),i):r},i.ticks=function(t){return ci(r,t)},i.tickFormat=function(t,n){return fi(r,t,n)},i.nice=function(t){return i.domain(si(r,t))},i.exponent=function(t){return arguments.length?(a=di(e=t),o=di(1/e),n.domain(r.map(a)),i):e},i.copy=function(){return gi(n.copy(),e,r)},ui(i,n)}function di(n){return function(t){return t<0?-Math.pow(-t,n):Math.pow(t,n)}}function pi(s,l){function c(t){return h[((i.get(t)||"range"===l.t&&i.set(t,s.push(t)))-1)%h.length]}function f(n,e){return Va.range(s.length).map(function(t){return n+e*t})}var i,h,g;return c.domain=function(t){if(!arguments.length)return s;s=[],i=new m;for(var n,e=-1,r=t.length;++e<r;)i.has(n=t[e])||i.set(n,s.push(n));return c[l.t].apply(c,l.a)},c.range=function(t){return arguments.length?(h=t,g=0,l={t:"range",a:arguments},c):h},c.rangePoints=function(t,n){arguments.length<2&&(n=0);var e=t[0],r=t[1],i=(r-e)/(Math.max(1,s.length-1)+n);return h=f(s.length<2?(e+r)/2:e+i*n/2,i),g=0,l={t:"rangePoints",a:arguments},c},c.rangeBands=function(t,n,e){arguments.length<2&&(n=0),arguments.length<3&&(e=n);var r=t[1]<t[0],i=t[r-0],a=(t[1-r]-i)/(s.length-n+2*e);return h=f(i+a*e,a),r&&h.reverse(),g=a*(1-n),l={t:"rangeBands",a:arguments},c},c.rangeRoundBands=function(t,n,e){arguments.length<2&&(n=0),arguments.length<3&&(e=n);var r=t[1]<t[0],i=t[r-0],a=t[1-r],o=Math.floor((a-i)/(s.length-n+2*e)),u=a-i-(s.length-n)*o;return h=f(i+Math.round(u/2),o),r&&h.reverse(),g=Math.round(o*(1-n)),l={t:"rangeRoundBands",a:arguments},c},c.rangeBand=function(){return g},c.rangeExtent=function(){return ti(l.a[0])},c.copy=function(){return pi(s,l)},c.domain(s)}function _i(e,r){
function n(){var t=0,n=r.length;for(a=[];++t<n;)a[t-1]=Va.quantile(e,t/n);return i}function i(t){return isNaN(t=+t)?void 0:r[Va.bisect(a,t)]}var a;return i.domain=function(t){return arguments.length?(e=t.filter(function(t){return!isNaN(t)}).sort(Va.ascending),n()):e},i.range=function(t){return arguments.length?(r=t,n()):r},i.quantiles=function(){return a},i.invertExtent=function(t){return(t=r.indexOf(t))<0?[NaN,NaN]:[0<t?a[t-1]:e[0],t<a.length?a[t]:e[e.length-1]]},i.copy=function(){return _i(e,r)},n()}function vi(n,e,r){function t(t){return r[Math.max(0,Math.min(o,Math.floor(a*(t-n))))]}function i(){return a=r.length/(e-n),o=r.length-1,t}var a,o;return t.domain=function(t){return arguments.length?(n=+t[0],e=+t[t.length-1],i()):[n,e]},t.range=function(t){return arguments.length?(r=t,i()):r},t.invertExtent=function(t){return[t=(t=r.indexOf(t))<0?NaN:t/a+n,t+1/a]},t.copy=function(){return vi(n,e,r)},i()}function yi(n,e){function r(t){return t<=t?e[Va.bisect(n,t)]:void 0}return r.domain=function(t){return arguments.length?(n=t,r):n},r.range=function(t){return arguments.length?(e=t,r):e},r.invertExtent=function(t){return t=e.indexOf(t),[n[t-1],n[t]]},r.copy=function(){return yi(n,e)},r}function mi(e){function n(t){return+t}return(n.invert=n).domain=n.range=function(t){return arguments.length?(e=t.map(n),n):e},n.ticks=function(t){return ci(e,t)},n.tickFormat=function(t,n){return fi(e,t,n)},n.copy=function(){return mi(e)},n}function xi(t){return t.innerRadius}function bi(t){return t.outerRadius}function Mi(t){return t.startAngle}function wi(t){return t.endAngle}function ki(l){function n(t){function n(){r.push("M",g(l(i),d))}for(var e,r=[],i=[],a=-1,o=t.length,u=dt(c),s=dt(f);++a<o;)h.call(this,e=t[a],a)?i.push([+u.call(this,e,a),+s.call(this,e,a)]):i.length&&(n(),i=[]);return i.length&&n(),r.length?r.join(""):null}var c=Vn,f=Yn,h=Vt,g=Si,e=g.key,d=.7;return n.x=function(t){return arguments.length?(c=t,n):c},n.y=function(t){return arguments.length?(f=t,n):f},n.defined=function(t){return arguments.length?(h=t,n):h},n.interpolate=function(t){return arguments.length?(e="function"==typeof t?g=t:(g=ds.get(t)||Si).key,n):e},n.tension=function(t){return arguments.length?(d=t,n):d},n}function Si(t){return t.join("L")}function $i(t){return Si(t)+"Z"}function Ni(t){for(var n=0,e=t.length,r=t[0],i=[r[0],",",r[1]];++n<e;)i.push("H",(r[0]+(r=t[n])[0])/2,"V",r[1]);return 1<e&&i.push("H",r[0]),i.join("")}function Ai(t){for(var n=0,e=t.length,r=t[0],i=[r[0],",",r[1]];++n<e;)i.push("V",(r=t[n])[1],"H",r[0]);return i.join("")}function Ei(t){for(var n=0,e=t.length,r=t[0],i=[r[0],",",r[1]];++n<e;)i.push("H",(r=t[n])[0],"V",r[1]);return i.join("")}function Ci(t,n){return t.length<4?Si(t):t[1]+Ti(t.slice(1,t.length-1),zi(t,n))}function Li(t,n){return t.length<3?Si(t):t[0]+Ti((t.push(t[0]),t),zi([t[t.length-2]].concat(t,[t[1]]),n))}function Ri(t,n){return t.length<3?Si(t):t[0]+Ti(t,zi(t,n))}function Ti(t,n){if(n.length<1||t.length!=n.length&&t.length!=n.length+2)return Si(t);var e=t.length!=n.length,r="",i=t[0],a=t[1],o=n[0],u=o,s=1;if(e&&(r+="Q"+(a[0]-2*o[0]/3)+","+(a[1]-2*o[1]/3)+","+a[0]+","+a[1],i=t[1],s=2),1<n.length){u=n[1],a=t[s],s++,r+="C"+(i[0]+o[0])+","+(i[1]+o[1])+","+(a[0]-u[0])+","+(a[1]-u[1])+","+a[0]+","+a[1];for(var l=2;l<n.length;l++,s++)a=t[s],u=n[l],r+="S"+(a[0]-u[0])+","+(a[1]-u[1])+","+a[0]+","+a[1]}if(e){var c=t[s];r+="Q"+(a[0]+2*u[0]/3)+","+(a[1]+2*u[1]/3)+","+c[0]+","+c[1]}return r}function zi(t,n){for(var e,r=[],i=(1-n)/2,a=t[0],o=t[1],u=1,s=t.length;++u<s;)e=a,a=o,o=t[u],r.push([i*(o[0]-e[0]),i*(o[1]-e[1])]);return r}function Fi(t){if(t.length<3)return Si(t);var n=1,e=t.length,r=t[0],i=r[0],a=r[1],o=[i,i,i,(r=t[1])[0]],u=[a,a,a,r[1]],s=[i,",",a,"L",ji(vs,o),",",ji(vs,u)];for(t.push(t[e-1]);++n<=e;)r=t[n],o.shift(),o.push(r[0]),u.shift(),u.push(r[1]),Oi(s,o,u);return t.pop(),s.push("L",r),s.join("")}function Di(t){if(t.length<4)return Si(t);for(var n,e=[],r=-1,i=t.length,a=[0],o=[0];++r<3;)n=t[r],a.push(n[0]),o.push(n[1]);for(e.push(ji(vs,a)+","+ji(vs,o)),--r;++r<i;)n=t[r],a.shift(),a.push(n[0]),o.shift(),o.push(n[1]),Oi(e,a,o);return e.join("")}function qi(t){for(var n,e,r=-1,i=t.length,a=i+4,o=[],u=[];++r<4;)e=t[r%i],o.push(e[0]),u.push(e[1]);for(n=[ji(vs,o),",",ji(vs,u)],--r;++r<a;)e=t[r%i],o.shift(),o.push(e[0]),u.shift(),u.push(e[1]),Oi(n,o,u);return n.join("")}function Pi(t,n){var e=t.length-1;if(e)for(var r,i,a=t[0][0],o=t[0][1],u=t[e][0]-a,s=t[e][1]-o,l=-1;++l<=e;)i=l/e,(r=t[l])[0]=n*r[0]+(1-n)*(a+i*u),r[1]=n*r[1]+(1-n)*(o+i*s);return Fi(t)}function ji(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]+t[3]*n[3]}function Oi(t,n,e){t.push("C",ji(ps,n),",",ji(ps,e),",",ji(_s,n),",",ji(_s,e),",",ji(vs,n),",",ji(vs,e))}function Ui(t,n){return(n[1]-t[1])/(n[0]-t[0])}function Hi(t){for(var n=0,e=t.length-1,r=[],i=t[0],a=t[1],o=r[0]=Ui(i,a);++n<e;)r[n]=(o+(o=Ui(i=a,a=t[n+1])))/2;return r[n]=o,r}function Ii(t){for(var n,e,r,i,a=[],o=Hi(t),u=-1,s=t.length-1;++u<s;)n=Ui(t[u],t[u+1]),eo(n)<ko?o[u]=o[u+1]=0:9<(i=(e=o[u]/n)*e+(r=o[u+1]/n)*r)&&(i=3*n/Math.sqrt(i),o[u]=i*e,o[u+1]=i*r);for(u=-1;++u<=s;)i=(t[Math.min(s,u+1)][0]-t[Math.max(0,u-1)][0])/(6*(1+o[u]*o[u])),a.push([i||0,o[u]*i||0]);return a}function Vi(t){return t.length<3?Si(t):t[0]+Ti(t,Ii(t))}function Yi(t){for(var n,e,r,i=-1,a=t.length;++i<a;)e=(n=t[i])[0],r=n[1]+hs,n[0]=e*Math.cos(r),n[1]=e*Math.sin(r);return t}function Bi(d){function n(t){function n(){a.push("M",x(d(u),w),M,b(d(o.reverse()),w),"Z")}for(var e,r,i,a=[],o=[],u=[],s=-1,l=t.length,c=dt(p),f=dt(v),h=p===_?function(){return r}:dt(_),g=v===y?function(){return i}:dt(y);++s<l;)m.call(this,e=t[s],s)?(o.push([r=+c.call(this,e,s),i=+f.call(this,e,s)]),u.push([+h.call(this,e,s),+g.call(this,e,s)])):o.length&&(n(),o=[],u=[]);return o.length&&n(),a.length?a.join(""):null}var p=Vn,_=Vn,v=0,y=Yn,m=Vt,x=Si,e=x.key,b=x,M="L",w=.7;return n.x=function(t){return arguments.length?(p=_=t,n):_},n.x0=function(t){return arguments.length?(p=t,n):p},n.x1=function(t){return arguments.length?(_=t,n):_},n.y=function(t){return arguments.length?(v=y=t,n):y},n.y0=function(t){return arguments.length?(v=t,n):v},n.y1=function(t){return arguments.length?(y=t,n):y},n.defined=function(t){return arguments.length?(m=t,n):m},n.interpolate=function(t){return arguments.length?(e="function"==typeof t?x=t:(x=ds.get(t)||Si).key,b=x.reverse||x,M=x.closed?"M":"L",n):e},n.tension=function(t){return arguments.length?(w=t,n):w},n}function Gi(t){return t.radius}function Wi(t){return[t.x,t.y]}function Xi(r){return function(){var t=r.apply(this,arguments),n=t[0],e=t[1]+hs;return[n*Math.cos(e),n*Math.sin(e)]}}function Zi(){return 64}function Ki(){return"circle"}function Ji(t){var n=Math.sqrt(t/bo);return"M0,"+n+"A"+n+","+n+" 0 1,1 0,"+-n+"A"+n+","+n+" 0 1,1 0,"+n+"Z"}function Qi(t,n){return uo(t,ws),t.id=n,t}function ta(t,r,i,a){var o=t.id;return $(t,"function"==typeof i?function(t,n,e){t.__transition__[o].tween.set(r,a(i.call(t,t.__data__,n,e)))}:(i=a(i),function(t){t.__transition__[o].tween.set(r,i)}))}function na(t){return null==t&&(t=""),function(){this.textContent=t}}function ea(c,f,h,t){var g=c.__transition__||(c.__transition__={active:0,count:0}),d=g[h];if(!d){var p=t.time;d=g[h]={tween:new m,time:p,ease:t.ease,delay:t.delay,duration:t.duration},++g.count,Va.timer(function(t){function n(t){return g.active>h?i():(g.active=h,d.event&&d.event.start.call(c,a,f),d.tween.forEach(function(t,n){(n=n.call(c,a,f))&&l.push(n)}),void Va.timer(function(){return s.c=e(t||1)?Vt:e,1},0,p))}function e(t){if(g.active!==h)return i();for(var n=t/u,e=o(n),r=l.length;0<r;)l[--r].call(c,e);return 1<=n?(d.event&&d.event.end.call(c,a,f),i()):void 0}function i(){return--g.count?delete g[h]:delete c.__transition__,1}var a=c.__data__,o=d.ease,r=d.delay,u=d.duration,s=Go,l=[];return s.t=r+p,r<=t?n(t-r):void(s.c=n)},0,p)}}function ra(t,n){t.attr("transform",function(t){return"translate("+n(t)+",0)"})}function ia(t,n){t.attr("transform",function(t){return"translate(0,"+n(t)+")"})}function aa(t){this._=new Date(1<arguments.length?Date.UTC.apply(this,arguments):t)}function oa(r,a,o){function t(t){var n=r(t),e=i(n,1);return t-n<e-t?n:e}function u(t){return a(t=r(new Cs(t-1)),1),t}function i(t,n){return a(t=new Cs(+t),n),t}function s(t,n,e){var r=u(t),i=[];if(1<e)for(;r<n;)o(r)%e||i.push(new Date(+r)),a(r,1);else for(;r<n;)i.push(new Date(+r)),a(r,1);return i}function n(t,n,e){try{var r=new(Cs=aa);return r._=t,s(r,n,e)}finally{Cs=Date}}(r.floor=r).round=t,r.ceil=u,r.offset=i,r.range=s;var e=r.utc=ua(r);return(e.floor=e).round=ua(t),e.ceil=ua(u),e.offset=ua(i),e.range=n,r}function ua(r){return function(t,n){try{var e=new(Cs=aa);return e._=t,r(e,n)._}finally{Cs=Date}}}function sa(u){function t(t){for(var n,e,r,i=[],a=-1,o=0;++a<s;)37===u.charCodeAt(a)&&(i.push(u.substring(o,a)),null!=(e=Xs[n=u.charAt(++a)])&&(n=u.charAt(++a)),(r=Zs[n])&&(n=r(t,null==e?"e"===n?" ":"0":e)),i.push(n),o=a+1);return i.push(u.substring(o,a)),i.join("")}var s=u.length;return t.parse=function(t){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(la(n,u,t,0)!=t.length)return null;"p"in n&&(n.H=n.H%12+12*n.p);var e=null!=n.Z&&Cs!==aa,r=new(e?aa:Cs);return"j"in n?r.setFullYear(n.y,0,n.j):"w"in n&&("W"in n||"U"in n)?(r.setFullYear(n.y,0,1),r.setFullYear(n.y,0,"W"in n?(n.w+6)%7+7*n.W-(r.getDay()+5)%7:n.w+7*n.U-(r.getDay()+6)%7)):r.setFullYear(n.y,n.m,n.d),r.setHours(n.H+Math.floor(n.Z/100),n.M+n.Z%100,n.S,n.L),e?r._:r},t.toString=function(){return u},t}function la(t,n,e,r){for(var i,a,o,u=0,s=n.length,l=e.length;u<s;){if(l<=r)return-1;if(37===(i=n.charCodeAt(u++))){if(o=n.charAt(u++),!(a=Ks[o in Xs?n.charAt(u++):o])||(r=a(t,e,r))<0)return-1}else if(i!=e.charCodeAt(r++))return-1}return r}function ca(t){return new RegExp("^(?:"+t.map(Va.requote).join("|")+")","i")}function fa(t){for(var n=new m,e=-1,r=t.length;++e<r;)n.set(t[e].toLowerCase(),e);return n}function ha(t,n,e){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<e?new Array(e-a+1).join(n)+i:i)}function ga(t,n,e){Hs.lastIndex=0;var r=Hs.exec(n.substring(e));return r?(t.w=Is.get(r[0].toLowerCase()),e+r[0].length):-1}function da(t,n,e){Os.lastIndex=0;var r=Os.exec(n.substring(e));return r?(t.w=Us.get(r[0].toLowerCase()),e+r[0].length):-1}function pa(t,n,e){Js.lastIndex=0;var r=Js.exec(n.substring(e,e+1));return r?(t.w=+r[0],e+r[0].length):-1}function _a(t,n,e){Js.lastIndex=0;var r=Js.exec(n.substring(e));return r?(t.U=+r[0],e+r[0].length):-1}function va(t,n,e){Js.lastIndex=0;var r=Js.exec(n.substring(e));return r?(t.W=+r[0],e+r[0].length):-1}function ya(t,n,e){Bs.lastIndex=0;var r=Bs.exec(n.substring(e));return r?(t.m=Gs.get(r[0].toLowerCase()),e+r[0].length):-1}function ma(t,n,e){Vs.lastIndex=0;var r=Vs.exec(n.substring(e));return r?(t.m=Ys.get(r[0].toLowerCase()),e+r[0].length):-1}function xa(t,n,e){return la(t,Zs.c.toString(),n,e)}function ba(t,n,e){return la(t,Zs.x.toString(),n,e)}function Ma(t,n,e){return la(t,Zs.X.toString(),n,e)}function wa(t,n,e){Js.lastIndex=0;var r=Js.exec(n.substring(e,e+4));return r?(t.y=+r[0],e+r[0].length):-1}function ka(t,n,e){Js.lastIndex=0;var r=Js.exec(n.substring(e,e+2));return r?(t.y=$a(+r[0]),e+r[0].length):-1}function Sa(t,n,e){return/^[+-]\d{4}$/.test(n=n.substring(e,e+5))?(t.Z=+n,e+5):-1}function $a(t){return t+(68<t?1900:2e3)}function Na(t,n,e){Js.lastIndex=0;var r=Js.exec(n.substring(e,e+2));return r?(t.m=r[0]-1,e+r[0].length):-1}function Aa(t,n,e){Js.lastIndex=0;var r=Js.exec(n.substring(e,e+2));return r?(t.d=+r[0],e+r[0].length):-1}function Ea(t,n,e){Js.lastIndex=0;var r=Js.exec(n.substring(e,e+3));return r?(t.j=+r[0],e+r[0].length):-1}function Ca(t,n,e){Js.lastIndex=0;var r=Js.exec(n.substring(e,e+2));return r?(t.H=+r[0],e+r[0].length):-1}function La(t,n,e){Js.lastIndex=0;var r=Js.exec(n.substring(e,e+2));return r?(t.M=+r[0],e+r[0].length):-1}function Ra(t,n,e){Js.lastIndex=0;var r=Js.exec(n.substring(e,e+2));return r?(t.S=+r[0],e+r[0].length):-1}function Ta(t,n,e){Js.lastIndex=0;var r=Js.exec(n.substring(e,e+3));return r?(t.L=+r[0],e+r[0].length):-1}function za(t,n,e){var r=Qs.get(n.substring(e,e+=2).toLowerCase());return null==r?-1:(t.p=r,e)}function Fa(t){var n=t.getTimezoneOffset(),e=0<n?"-":"+",r=~~(eo(n)/60),i=eo(n)%60;return e+ha(r,"0",2)+ha(i,"0",2)}function Da(t,n,e){Ws.lastIndex=0;var r=Ws.exec(n.substring(e,e+1));return r?e+r[0].length:-1}function qa(t){function n(t){try{var n=new(Cs=aa);return n._=t,e(n)}finally{Cs=Date}}var e=sa(t);return n.parse=function(t){try{Cs=aa;var n=e.parse(t);return n&&n._}finally{Cs=Date}},n.toString=e.toString,n}function Pa(t){return t.toISOString()}function ja(n,i,t){function o(t){return n(t)}function u(t,n){var e=(t[1]-t[0])/n,r=Va.bisect(nl,e);return r==nl.length?[i.year,li(t.map(function(t){return t/31536e6}),n)[2]]:r?i[e/nl[r-1]<nl[r]/e?r-1:r]:[il,li(t,n)[2]]}return o.invert=function(t){return Oa(n.invert(t))},o.domain=function(t){return arguments.length?(n.domain(t),o):n.domain().map(Oa)},o.nice=function(n,e){function r(t){return!isNaN(t)&&!n.range(t,Oa(+t+1),e).length}var t=o.domain(),i=ti(t),a=null==n?u(i,10):"number"==typeof n&&u(i,n);return a&&(n=a[0],e=a[1]),o.domain(ri(t,1<e?{floor:function(t){for(;r(t=n.floor(t));)t=Oa(t-1);return t},ceil:function(t){for(;r(t=n.ceil(t));)t=Oa(+t+1);return t}}:n))},o.ticks=function(t,n){var e=ti(o.domain()),r=null==t?u(e,10):"number"==typeof t?u(e,t):!t.range&&[{range:t},n];return r&&(t=r[0],n=r[1]),t.range(e[0],Oa(+e[1]+1),n<1?1:n)},o.tickFormat=function(){return t},o.copy=function(){return ja(n.copy(),i,t)},ui(o,n)}function Oa(t){return new Date(t)}function Ua(r){return function(t){for(var n=r.length-1,e=r[n];!e[1](t);)e=r[--n];return e[0](t)}}function Ha(t){return JSON.parse(t.responseText)}function Ia(t){var n=Ga.createRange();return n.selectNode(Ga.body),n.createContextualFragment(t.responseText)}var Va={version:"3.3.8"};Date.now||(Date.now=function(){return+new Date});var Ya=[].slice,Ba=function(t){return Ya.call(t)},Ga=document,Wa=Ga.documentElement,Xa=window;try{Ba(Wa.childNodes)[0].nodeType}catch(ul){Ba=function(t){for(var n=t.length,e=new Array(n);n--;)e[n]=t[n];return e}}try{Ga.createElement("div").style.setProperty("opacity",0,"")}catch(sl){var Za=Xa.Element.prototype,Ka=Za.setAttribute,Ja=Za.setAttributeNS,Qa=Xa.CSSStyleDeclaration.prototype,to=Qa.setProperty;Za.setAttribute=function(t,n){Ka.call(this,t,n+"")},Za.setAttributeNS=function(t,n,e){Ja.call(this,t,n,e+"")},Qa.setProperty=function(t,n,e){to.call(this,t,n+"",e)}}Va.ascending=function(t,n){return t<n?-1:n<t?1:n<=t?0:NaN},Va.descending=function(t,n){return n<t?-1:t<n?1:t<=n?0:NaN},Va.min=function(t,n){var e,r,i=-1,a=t.length;if(1===arguments.length){for(;++i<a&&!(null!=(e=t[i])&&e<=e);)e=void 0;for(;++i<a;)null!=(r=t[i])&&r<e&&(e=r)}else{for(;++i<a&&!(null!=(e=n.call(t,t[i],i))&&e<=e);)e=void 0;for(;++i<a;)null!=(r=n.call(t,t[i],i))&&r<e&&(e=r)}return e},Va.max=function(t,n){var e,r,i=-1,a=t.length;if(1===arguments.length){for(;++i<a&&!(null!=(e=t[i])&&e<=e);)e=void 0;for(;++i<a;)null!=(r=t[i])&&e<r&&(e=r)}else{for(;++i<a&&!(null!=(e=n.call(t,t[i],i))&&e<=e);)e=void 0;for(;++i<a;)null!=(r=n.call(t,t[i],i))&&e<r&&(e=r)}return e},Va.extent=function(t,n){var e,r,i,a=-1,o=t.length;if(1===arguments.length){for(;++a<o&&!(null!=(e=i=t[a])&&e<=e);)e=i=void 0;for(;++a<o;)null!=(r=t[a])&&(r<e&&(e=r),i<r&&(i=r))}else{for(;++a<o&&!(null!=(e=i=n.call(t,t[a],a))&&e<=e);)e=void 0;for(;++a<o;)null!=(r=n.call(t,t[a],a))&&(r<e&&(e=r),i<r&&(i=r))}return[e,i]},Va.sum=function(t,n){var e,r=0,i=t.length,a=-1;if(1===arguments.length)for(;++a<i;)isNaN(e=+t[a])||(r+=e);else for(;++a<i;)isNaN(e=+n.call(t,t[a],a))||(r+=e);return r},Va.mean=function(t,n){var e,r=t.length,i=0,a=-1,o=0;if(1===arguments.length)for(;++a<r;)u(e=t[a])&&(i+=(e-i)/++o);else for(;++a<r;)u(e=n.call(t,t[a],a))&&(i+=(e-i)/++o);return o?i:void 0},Va.quantile=function(t,n){var e=(t.length-1)*n+1,r=Math.floor(e),i=+t[r-1],a=e-r;return a?i+a*(t[r]-i):i},Va.median=function(t,n){return 1<arguments.length&&(t=t.map(n)),(t=t.filter(u)).length?Va.quantile(t.sort(Va.ascending),.5):void 0},Va.bisector=function(a){return{left:function(t,n,e,r){for(arguments.length<3&&(e=0),arguments.length<4&&(r=t.length);e<r;){var i=e+r>>>1;a.call(t,t[i],i)<n?e=i+1:r=i}return e},right:function(t,n,e,r){for(arguments.length<3&&(e=0),arguments.length<4&&(r=t.length);e<r;){var i=e+r>>>1;n<a.call(t,t[i],i)?r=i:e=i+1}return e}}};var no=Va.bisector(function(t){return t});Va.bisectLeft=no.left,Va.bisect=Va.bisectRight=no.right,Va.shuffle=function(t){for(var n,e,r=t.length;r;)e=0|Math.random()*r--,n=t[r],t[r]=t[e],t[e]=n;return t},Va.permute=function(t,n){for(var e=n.length,r=new Array(e);e--;)r[e]=t[n[e]];return r},Va.pairs=function(t){for(var n=0,e=t.length-1,r=t[0],i=new Array(e<0?0:e);n<e;)i[n]=[r,r=t[++n]];return i},Va.zip=function(){if(!(r=arguments.length))return[];for(var t=-1,n=Va.min(arguments,o),e=new Array(n);++t<n;)for(var r,i=-1,a=e[t]=new Array(r);++i<r;)a[i]=arguments[i][t];return e},Va.transpose=function(t){return Va.zip.apply(Va,t)},Va.keys=function(t){var n=[];for(var e in t)n.push(e);return n},Va.values=function(t){var n=[];for(var e in t)n.push(t[e]);return n},Va.entries=function(t){var n=[];for(var e in t)n.push({key:e,value:t[e]});return n},Va.merge=function(t){for(var n,e,r,i=t.length,a=-1,o=0;++a<i;)o+=t[a].length;for(e=new Array(o);0<=--i;)for(n=(r=t[i]).length;0<=--n;)e[--o]=r[n];return e};var eo=Math.abs;Va.range=function(t,n,e){if(arguments.length<3&&(e=1,arguments.length<2&&(n=t,t=0)),1/0==(n-t)/e)throw new Error("infinite range");var r,i=[],a=s(eo(e)),o=-1;if(t*=a,n*=a,(e*=a)<0)for(;(r=t+e*++o)>n;)i.push(r/a);else for(;(r=t+e*++o)<n;)i.push(r/a);return i},Va.map=function(t){var e=new m;if(t instanceof m)t.forEach(function(t,n){e.set(t,n)});else for(var n in t)e.set(n,t[n]);return e},r(m,{has:function(t){return ro+t in this},get:function(t){return this[ro+t]},set:function(t,n){return this[ro+t]=n},remove:function(t){return(t=ro+t)in this&&delete this[t]},keys:function(){var n=[];return this.forEach(function(t){n.push(t)}),n},values:function(){var e=[];return this.forEach(function(t,n){e.push(n)}),e},entries:function(){var e=[];return this.forEach(function(t,n){e.push({key:t,value:n})}),e},forEach:function(t){for(var n in this)n.charCodeAt(0)===io&&t.call(this,n.substring(1),this[n])}});var ro="\0",io=ro.charCodeAt(0);Va.nest=function(){function f(e,t,r){if(r>=p.length)return g?g.call(d,t):h?t.sort(h):t;for(var n,i,a,o,u=-1,s=t.length,l=p[r++],c=new m;++u<s;)(o=c.get(n=l(i=t[u])))?o.push(i):c.set(n,[i]);return e?(i=e(),a=function(t,n){i.set(t,f(e,n,r))}):(i={},a=function(t,n){i[t]=f(e,n,r)}),c.forEach(a),i}function a(t,e){if(e>=p.length)return t;var r=[],i=n[e++];return t.forEach(function(t,n){r.push({key:t,values:a(n,e)})}),i?r.sort(function(t,n){return i(t.key,n.key)}):r}var h,g,d={},p=[],n=[];return d.map=function(t,n){return f(n,t,0)},d.entries=function(t){return a(f(Va.map,t,0),0)},d.key=function(t){return p.push(t),d},d.sortKeys=function(t){return n[p.length-1]=t,d},d.sortValues=function(t){return h=t,d},d.rollup=function(t){return g=t,d},d},Va.set=function(t){var n=new c;if(t)for(var e=0,r=t.length;e<r;++e)n.add(t[e]);return n},r(c,{has:function(t){return ro+t in this},add:function(t){return this[ro+t]=!0,t},remove:function(t){return(t=ro+t)in this&&delete this[t]},values:function(){var n=[];return this.forEach(function(t){n.push(t)}),n},forEach:function(t){for(var n in this)n.charCodeAt(0)===io&&t.call(this,n.substring(1))}}),Va.behavior={},Va.rebind=function(t,n){for(var e,r=1,i=arguments.length;++r<i;)t[e=arguments[r]]=a(t,n,n[e]);return t};var ao=["webkit","ms","moz","Moz","o","O"];Va.dispatch=function(){for(var t=new l,n=-1,e=arguments.length;++n<e;)t[arguments[n]]=h(t);return t},l.prototype.on=function(t,n){var e=t.indexOf("."),r="";if(0<=e&&(r=t.substring(e+1),t=t.substring(0,e)),t)return arguments.length<2?this[t].on(r):this[t].on(r,n);if(2===arguments.length){if(null==n)for(t in this)this.hasOwnProperty(t)&&this[t].on(r,null);return this}},Va.event=null,Va.requote=function(t){return t.replace(oo,"\\$&")};var oo=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,uo={}.__proto__?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)t[e]=n[e]},so=function(t,n){return n.querySelector(t)},lo=function(t,n){return n.querySelectorAll(t)},co=Wa[t(Wa,"matchesSelector")],fo=function(t,n){return co.call(t,n)};"function"==typeof Sizzle&&(so=function(t,n){return Sizzle(t,n)[0]||null},lo=function(t,n){return Sizzle.uniqueSort(Sizzle(t,n))},fo=Sizzle.matchesSelector),Va.selection=function(){return _o};var ho=Va.selection.prototype=[];ho.select=function(t){var n,e,r,i,a=[];t=d(t);for(var o=-1,u=this.length;++o<u;){a.push(n=[]),n.parentNode=(r=this[o]).parentNode;for(var s=-1,l=r.length;++s<l;)(i=r[s])?(n.push(e=t.call(i,i.__data__,s,o)),e&&"__data__"in i&&(e.__data__=i.__data__)):n.push(null)}return g(a)},ho.selectAll=function(t){var n,e,r=[];t=p(t);for(var i=-1,a=this.length;++i<a;)for(var o=this[i],u=-1,s=o.length;++u<s;)(e=o[u])&&(r.push(n=Ba(t.call(e,e.__data__,u,i))),n.parentNode=e);return g(r)};var go={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};Va.ns={prefix:go,qualify:function(t){var n=t.indexOf(":"),e=t;return 0<=n&&(e=t.substring(0,n),t=t.substring(n+1)),go.hasOwnProperty(e)?{space:go[e],local:t}:t}},ho.attr=function(t,n){if(arguments.length<2){if("string"==typeof t){var e=this.node();return(t=Va.ns.qualify(t)).local?e.getAttributeNS(t.space,t.local):e.getAttribute(t)}for(n in t)this.each(i(n,t[n]));return this}return this.each(i(t,n))},ho.classed=function(t,n){if(arguments.length<2){if("string"==typeof t){var e=this.node(),r=(t=t.trim().split(/^|\s+/g)).length,i=-1;if(n=e.classList){for(;++i<r;)if(!n.contains(t[i]))return!1}else for(n=e.getAttribute("class");++i<r;)if(!v(t[i]).test(n))return!1;return!0}for(n in t)this.each(y(n,t[n]));return this}return this.each(y(t,n))},ho.style=function(t,n,e){var r=arguments.length;if(r<3){if("string"!=typeof t){for(e in r<2&&(n=""),t)this.each(b(e,t[e],n));return this}if(r<2)return Xa.getComputedStyle(this.node(),null).getPropertyValue(t);e=""}return this.each(b(t,n,e))},ho.property=function(t,n){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(n in t)this.each(e(n,t[n]));return this}return this.each(e(t,n))},ho.text=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.textContent=null==t?"":t}:null==n?function(){this.textContent=""}:function(){this.textContent=n}):this.node().textContent},ho.html=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.innerHTML=null==t?"":t}:null==n?function(){this.innerHTML=""}:function(){this.innerHTML=n}):this.node().innerHTML},ho.append=function(t){return t=M(t),this.select(function(){return this.appendChild(t.apply(this,arguments))})},ho.insert=function(t,n){return t=M(t),n=d(n),this.select(function(){return this.insertBefore(t.apply(this,arguments),n.apply(this,arguments)||null)})},ho.remove=function(){return this.each(function(){var t=this.parentNode;t&&t.removeChild(this)})},ho.data=function(t,p){function n(t,n){var e,r,i,a=t.length,o=n.length,u=Math.min(a,o),s=new Array(o),l=new Array(o),c=new Array(a);if(p){var f,h=new m,g=new m,d=[];for(e=-1;++e<a;)f=p.call(r=t[e],r.__data__,e),h.has(f)?c[e]=r:h.set(f,r),d.push(f);for(e=-1;++e<o;)f=p.call(n,i=n[e],e),(r=h.get(f))?(s[e]=r).__data__=i:g.has(f)||(l[e]=w(i)),g.set(f,i),h.remove(f);for(e=-1;++e<a;)h.has(d[e])&&(c[e]=t[e])}else{for(e=-1;++e<u;)r=t[e],i=n[e],r?(r.__data__=i,s[e]=r):l[e]=w(i);for(;e<o;++e)l[e]=w(n[e]);for(;e<a;++e)c[e]=t[e]}l.update=s,l.parentNode=s.parentNode=c.parentNode=t.parentNode,_.push(l),v.push(s),y.push(c)}var e,r,i=-1,a=this.length;if(!arguments.length){for(t=new Array(a=(e=this[0]).length);++i<a;)(r=e[i])&&(t[i]=r.__data__);return t}var _=N([]),v=g([]),y=g([]);if("function"==typeof t)for(;++i<a;)n(e=this[i],t.call(e,e.parentNode.__data__,i));else for(;++i<a;)n(e=this[i],t);return v.enter=function(){return _},v.exit=function(){return y},v},ho.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},ho.filter=function(t){var n,e,r,i=[];"function"!=typeof t&&(t=k(t));for(var a=0,o=this.length;a<o;a++){i.push(n=[]),n.parentNode=(e=this[a]).parentNode;for(var u=0,s=e.length;u<s;u++)(r=e[u])&&t.call(r,r.__data__,u)&&n.push(r)}return g(i)},ho.order=function(){for(var t=-1,n=this.length;++t<n;)for(var e,r=this[t],i=r.length-1,a=r[i];0<=--i;)(e=r[i])&&(a&&a!==e.nextSibling&&a.parentNode.insertBefore(e,a),a=e);return this},ho.sort=function(t){t=S.apply(this,arguments);for(var n=-1,e=this.length;++n<e;)this[n].sort(t);return this.order()},ho.each=function(r){return $(this,function(t,n,e){r.call(t,t.__data__,n,e)})},ho.call=function(t){var n=Ba(arguments);return t.apply(n[0]=this,n),this},ho.empty=function(){return!this.node()},ho.node=function(){for(var t=0,n=this.length;t<n;t++)for(var e=this[t],r=0,i=e.length;r<i;r++){var a=e[r];if(a)return a}return null},ho.size=function(){var t=0;return this.each(function(){++t}),t};var po=[];Va.selection.enter=N,(Va.selection.enter.prototype=po).append=ho.append,po.empty=ho.empty,po.node=ho.node,po.call=ho.call,po.size=ho.size,po.select=function(t){for(var n,e,r,i,a,o=[],u=-1,s=this.length;++u<s;){r=(i=this[u]).update,o.push(n=[]),n.parentNode=i.parentNode;for(var l=-1,c=i.length;++l<c;)(a=i[l])?(n.push(r[l]=e=t.call(i.parentNode,a.__data__,l,u)),e.__data__=a.__data__):n.push(null)}return g(o)},po.insert=function(t,n){return arguments.length<2&&(n=A(this)),ho.insert.call(this,t,n)},ho.transition=function(){for(var t,n,e=ms||++ks,r=[],i=xs||{time:Date.now(),ease:je,delay:0,duration:250},a=-1,o=this.length;++a<o;){r.push(t=[]);for(var u=this[a],s=-1,l=u.length;++s<l;)(n=u[s])&&ea(n,s,e,i),t.push(n)}return Qi(r,e)},ho.interrupt=function(){return this.each(L)},Va.select=function(t){var n=["string"==typeof t?so(t,Ga):t];return n.parentNode=Wa,g([n])},Va.selectAll=function(t){var n=Ba("string"==typeof t?lo(t,Ga):t);return n.parentNode=Wa,g([n])};var _o=Va.select(Wa);ho.on=function(t,n,e){var r=arguments.length;if(r<3){if("string"!=typeof t){for(e in r<2&&(n=!1),t)this.each(E(e,t[e],n));return this}if(r<2)return(r=this.node()["__on"+t])&&r._;e=!1}return this.each(E(t,n,e))};var vo=Va.map({mouseenter:"mouseover",mouseleave:"mouseout"});vo.forEach(function(t){"on"+t in Ga&&vo.remove(t)});var yo=t(Wa.style,"userSelect"),mo=0;Va.mouse=function(t){return D(t,n())};var xo=/WebKit/.test(Xa.navigator.userAgent)?-1:0;Va.touches=function(e,t){return arguments.length<2&&(t=n().touches),t?Ba(t).map(function(t){var n=D(e,t);return n.identifier=t.identifier,n}):[]},Va.behavior.drag=function(){function n(){this.on("mousedown.drag",i).on("touchstart.drag",a)}function t(){return Va.event.changedTouches[0].identifier}function e(t,n){return Va.touches(t).filter(function(t){return t.identifier===n})[0]}function r(g,d,p,_){return function(){function t(){var t=d(i,u),n=t[0]-l[0],e=t[1]-l[1];c|=n|e,a({type:"drag",x:(l=t)[0]+r[0],y:t[1]+r[1],dx:n,dy:e})}function n(){f.on(p+"."+s,null).on(_+"."+s,null),h(c&&Va.event.target===o),a({type:"dragend"})}var r,e=this,i=e.parentNode,a=v.of(e,arguments),o=Va.event.target,u=g(),s=null==u?"drag":"drag-"+u,l=d(i,u),c=0,f=Va.select(Xa).on(p+"."+s,t).on(_+"."+s,n),h=F();y?r=[(r=y.apply(e,arguments)).x-l[0],r.y-l[1]]:r=[0,0],a({type:"dragstart"})}}var v=z(n,"drag","dragstart","dragend"),y=null,i=r(f,Va.mouse,"mousemove","mouseup"),a=r(t,e,"touchmove","touchend");return n.origin=function(t){return arguments.length?(y=t,n):y},Va.rebind(n,v,"on")};var bo=Math.PI,Mo=2*bo,wo=bo/2,ko=1e-6,So=ko*ko,$o=bo/180,No=180/bo,Ao=Math.SQRT2,Eo=2,Co=4;Va.interpolateZoom=function(t,n){function e(t){var n=t*v;if(_){var e=U(p),r=o/(Eo*h)*(e*H(Ao*n+p)-O(p));return[i+r*l,a+r*c,o*e/U(Ao*n+p)]}return[i+t*l,a+t*c,o*Math.exp(Ao*n)]}var i=t[0],a=t[1],o=t[2],r=n[0],u=n[1],s=n[2],l=r-i,c=u-a,f=l*l+c*c,h=Math.sqrt(f),g=(s*s-o*o+Co*f)/(2*o*Eo*h),d=(s*s-o*o-Co*f)/(2*s*Eo*h),p=Math.log(Math.sqrt(g*g+1)-g),_=Math.log(Math.sqrt(d*d+1)-d)-p,v=(_||Math.log(s/o))/Ao;return e.duration=1e3*v,e},Va.behavior.zoom=function(){function n(t){t.on($,b).on(To+".zoom",i).on(N,l).on("dblclick.zoom",a).on(E,M)}function p(t){return[(t[0]-k.x)/k.k,(t[1]-k.y)/k.k]}function e(t){return[t[0]*k.k+k.x,t[1]*k.k+k.y]}function _(t){k.k=Math.max(S[0],Math.min(S[1],t))}function v(t,n){n=e(n),k.x+=t[0]-n[0],k.y+=t[1]-n[1]}function r(){f&&f.domain(c.range().map(function(t){return(t-k.x)/k.k}).map(c.invert)),g&&g.domain(h.range().map(function(t){return(t-k.y)/k.k}).map(h.invert))}function y(t){t({type:"zoomstart"})}function m(t){r(),t({type:"zoom",scale:k.k,translate:[k.x,k.y]})}function x(t){t({type:"zoomend"})}function b(){function t(){a=1,v(Va.mouse(e),u),m(r)}function n(){o.on(N,Xa===e?l:null).on(A,null),s(a&&Va.event.target===i),x(r)}var e=this,r=C.of(e,arguments),i=Va.event.target,a=0,o=Va.select(Xa).on(N,t).on(A,n),u=p(Va.mouse(e)),s=F();L.call(e),y(r)}function M(){function c(){var t=Va.touches(f);return l=k.k,t.forEach(function(t){t.identifier in g&&(g[t.identifier]=p(t))}),t}function t(){for(var t=Va.event.changedTouches,n=0,e=t.length;n<e;++n)g[t[n].identifier]=null;var r=c(),i=Date.now();if(1===r.length){if(i-w<500){var a=r[0],o=g[a.identifier];_(2*k.k),v(a,o),T(),m(h)}w=i}else if(1<r.length){a=r[0];var u=r[1],s=a[0]-u[0],l=a[1]-u[1];d=s*s+l*l}}function n(){for(var t,n,e,r,i=Va.touches(f),a=0,o=i.length;a<o;++a,r=null)if(e=i[a],r=g[e.identifier]){if(n)break;t=e,n=r}if(r){var u=(u=e[0]-t[0])*u+(u=e[1]-t[1])*u,s=d&&Math.sqrt(u/d);t=[(t[0]+e[0])/2,(t[1]+e[1])/2],n=[(n[0]+r[0])/2,(n[1]+r[1])/2],_(s*l)}w=null,v(t,n),m(h)}function e(){if(Va.event.touches.length){for(var t=Va.event.changedTouches,n=0,e=t.length;n<e;++n)delete g[t[n].identifier];for(var r in g)return void c()}o.on(i,null).on(a,null),u.on($,b).on(E,M),s(),x(h)}var l,f=this,h=C.of(f,arguments),g={},d=0,r=Va.event.changedTouches[0].identifier,i="touchmove.zoom-"+r,a="touchend.zoom-"+r,o=Va.select(Xa).on(i,n).on(a,e),u=Va.select(f).on($,null).on(E,t),s=F();L.call(f),t(),y(h)}function i(){var t=C.of(this,arguments);s?clearTimeout(s):(L.call(this),y(t)),s=setTimeout(function(){s=null,x(t)},50),T();var n=u||Va.mouse(this);o||(o=p(n)),_(Math.pow(2,.002*Lo())*k.k),v(n,o),m(t)}function l(){o=null}function a(){var t=C.of(this,arguments),n=Va.mouse(this),e=p(n),r=Math.log(k.k)/Math.LN2;y(t),_(Math.pow(2,Va.event.shiftKey?Math.ceil(r)-1:Math.floor(r)+1)),v(n,e),m(t),x(t)}var o,u,s,w,c,f,h,g,k={x:0,y:0,k:1},d=[960,500],S=Ro,$="mousedown.zoom",N="mousemove.zoom",A="mouseup.zoom",E="touchstart.zoom",C=z(n,"zoomstart","zoom","zoomend");return n.event=function(t){t.each(function(){var u=C.of(this,arguments),n=k;ms?Va.select(this).transition().each("start.zoom",function(){k=this.__chart__||{x:0,y:0,k:1},y(u)}).tween("zoom:zoom",function(){var r=d[0],t=d[1],i=r/2,a=t/2,o=Va.interpolateZoom([(i-k.x)/k.k,(a-k.y)/k.k,r/k.k],[(i-n.x)/n.k,(a-n.y)/n.k,r/n.k]);return function(t){var n=o(t),e=r/n[2];this.__chart__=k={x:i-n[0]*e,y:a-n[1]*e,k:e},m(u)}}).each("end.zoom",function(){x(u)}):(this.__chart__=k,y(u),m(u),x(u))})},n.translate=function(t){return arguments.length?(k={x:+t[0],y:+t[1],k:k.k},r(),n):[k.x,k.y]},n.scale=function(t){return arguments.length?(k={x:k.x,y:k.y,k:+t},r(),n):k.k},n.scaleExtent=function(t){return arguments.length?(S=null==t?Ro:[+t[0],+t[1]],n):S},n.center=function(t){return arguments.length?(u=t&&[+t[0],+t[1]],n):u},n.size=function(t){return arguments.length?(d=t&&[+t[0],+t[1]],n):d},n.x=function(t){return arguments.length?(c=(f=t).copy(),k={x:0,y:0,k:1},n):f},n.y=function(t){return arguments.length?(h=(g=t).copy(),k={x:0,y:0,k:1},n):g},Va.rebind(n,C,"on")};var Lo,Ro=[0,1/0],To="onwheel"in Ga?(Lo=function(){return-Va.event.deltaY*(Va.event.deltaMode?120:1)},"wheel"):"onmousewheel"in Ga?(Lo=function(){return Va.event.wheelDelta},"mousewheel"):(Lo=function(){return-Va.event.detail},"MozMousePixelScroll");V.prototype.toString=function(){return this.rgb()+""},Va.hsl=function(t,n,e){return 1===arguments.length?t instanceof B?Y(t.h,t.s,t.l):lt(""+t,ct,Y):Y(+t,+n,+e)};var zo=B.prototype=new V;zo.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),Y(this.h,this.s,this.l/t)},zo.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),Y(this.h,this.s,t*this.l)},zo.rgb=function(){return G(this.h,this.s,this.l)},Va.hcl=function(t,n,e){return 1===arguments.length?t instanceof X?W(t.h,t.c,t.l):tt(t instanceof J?t.l:(t=ft((t=Va.rgb(t)).r,t.g,t.b)).l,t.a,t.b):W(+t,+n,+e)};var Fo=X.prototype=new V;Fo.brighter=function(t){return W(this.h,this.c,Math.min(100,this.l+Do*(arguments.length?t:1)))},Fo.darker=function(t){return W(this.h,this.c,
Math.max(0,this.l-Do*(arguments.length?t:1)))},Fo.rgb=function(){return Z(this.h,this.c,this.l).rgb()},Va.lab=function(t,n,e){return 1===arguments.length?t instanceof J?K(t.l,t.a,t.b):t instanceof X?Z(t.l,t.c,t.h):ft((t=Va.rgb(t)).r,t.g,t.b):K(+t,+n,+e)};var Do=18,qo=.95047,Po=1,jo=1.08883,Oo=J.prototype=new V;Oo.brighter=function(t){return K(Math.min(100,this.l+Do*(arguments.length?t:1)),this.a,this.b)},Oo.darker=function(t){return K(Math.max(0,this.l-Do*(arguments.length?t:1)),this.a,this.b)},Oo.rgb=function(){return Q(this.l,this.a,this.b)},Va.rgb=function(t,n,e){return 1===arguments.length?t instanceof ut?ot(t.r,t.g,t.b):lt(""+t,ot,G):ot(~~t,~~n,~~e)};var Uo=ut.prototype=new V;Uo.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var n=this.r,e=this.g,r=this.b,i=30;return n||e||r?(n&&n<i&&(n=i),e&&e<i&&(e=i),r&&r<i&&(r=i),ot(Math.min(255,~~(n/t)),Math.min(255,~~(e/t)),Math.min(255,~~(r/t)))):ot(i,i,i)},Uo.darker=function(t){return ot(~~((t=Math.pow(.7,arguments.length?t:1))*this.r),~~(t*this.g),~~(t*this.b))},Uo.hsl=function(){return ct(this.r,this.g,this.b)},Uo.toString=function(){return"#"+st(this.r)+st(this.g)+st(this.b)};var Ho=Va.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Ho.forEach(function(t,n){Ho.set(t,it(n))}),Va.functor=dt,Va.xhr=_t(pt),Va.dsv=function(i,a){function o(t,n,e){arguments.length<3&&(e=n,n=null);var r=Va.xhr(t,a,e);return r.row=function(t){return arguments.length?r.response(null==(n=t)?u:s(t)):n},r.row(n)}function u(t){return o.parse(t.responseText)}function s(n){return function(t){return o.parse(t.responseText,n)}}function n(t){return t.map(l).join(i)}function l(t){return e.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}var e=new RegExp('["'+i+"\n]"),h=i.charCodeAt(0);return o.parse=function(t,r){var i;return o.parseRows(t,function(t,n){if(i)return i(t,n-1);var e=new Function("d","return {"+t.map(function(t,n){return JSON.stringify(t)+": d["+n+"]"}).join(",")+"}");i=r?function(t,n){return r(e(t),n)}:e})},o.parseRows=function(i,t){function n(){if(s<=l)return u;if(a)return a=!1,o;var t=l;if(34===i.charCodeAt(t)){for(var n=t;n++<s;)if(34===i.charCodeAt(n)){if(34!==i.charCodeAt(n+1))break;++n}return l=n+2,13===(e=i.charCodeAt(n+1))?(a=!0,10===i.charCodeAt(n+2)&&++l):10===e&&(a=!0),i.substring(t+1,n).replace(/""/g,'"')}for(;l<s;){var e,r=1;if(10===(e=i.charCodeAt(l++)))a=!0;else if(13===e)a=!0,10===i.charCodeAt(l)&&(++l,++r);else if(e!==h)continue;return i.substring(t,l-r)}return i.substring(t)}for(var e,a,o={},u={},r=[],s=i.length,l=0,c=0;(e=n())!==u;){for(var f=[];e!==o&&e!==u;)f.push(e),e=n();(!t||(f=t(f,c++)))&&r.push(f)}return r},o.format=function(t){if(Array.isArray(t[0]))return o.formatRows(t);var e=new c,r=[];return t.forEach(function(t){for(var n in t)e.has(n)||r.push(e.add(n))}),[r.map(l).join(i)].concat(t.map(function(n){return r.map(function(t){return l(n[t])}).join(i)})).join("\n")},o.formatRows=function(t){return t.map(n).join("\n")},o},Va.csv=Va.dsv(",","text/csv"),Va.tsv=Va.dsv("\t","text/tab-separated-values");var Io,Vo,Yo,Bo,Go,Wo=Xa[t(Xa,"requestAnimationFrame")]||function(t){setTimeout(t,17)};Va.timer=function(t,n,e){var r=arguments.length;r<2&&(n=0),r<3&&(e=Date.now());var i={c:t,t:e+n,f:!1,n:null};Vo?Vo.n=i:Io=i,Vo=i,Yo||(Bo=clearTimeout(Bo),Yo=1,Wo(mt))},Va.timer.flush=function(){xt(),bt()};var Xo=".",Zo=",",Ko=[3,3],Jo="$",Qo=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"].map(Mt);Va.formatPrefix=function(t,n){var e=0;return t&&(t<0&&(t*=-1),n&&(t=Va.round(t,wt(t,n))),e=1+Math.floor(1e-12+Math.log(t)/Math.LN10),e=Math.max(-24,Math.min(24,3*Math.floor((e<=0?e+1:e-1)/3)))),Qo[8+e/3]},Va.round=function(t,n){return n?Math.round(t*(n=Math.pow(10,n)))/n:Math.round(t)},Va.format=function(t){var n=tu.exec(t),s=n[1]||" ",l=n[2]||">",c=n[3]||"",f=n[4]||"",h=n[5],g=+n[6],d=n[7],p=n[8],_=n[9],v=1,y="",m=!1;switch(p&&(p=+p.substring(1)),(h||"0"===s&&"="===l)&&(h=s="0",l="=",d&&(g-=Math.floor((g-1)/4))),_){case"n":d=!0,_="g";break;case"%":v=100,y="%",_="f";break;case"p":v=100,y="%",_="r";break;case"b":case"o":case"x":case"X":"#"===f&&(f="0"+_.toLowerCase());case"c":case"d":m=!0,p=0;break;case"s":v=-1,_="r"}"#"===f?f="":"$"===f&&(f=Jo),"r"!=_||p||(_="g"),null!=p&&("g"==_?p=Math.max(1,Math.min(21,p)):("e"==_||"f"==_)&&(p=Math.max(0,Math.min(20,p)))),_=nu.get(_)||kt;var x=h&&d;return function(t){if(m&&t%1)return"";var n=t<0||0===t&&1/t<0?(t=-t,"-"):c;if(v<0){var e=Va.formatPrefix(t,p);t=e.scale(t),y=e.symbol}else t*=v;var r=(t=_(t,p)).lastIndexOf("."),i=r<0?t:t.substring(0,r),a=r<0?"":Xo+t.substring(r+1);!h&&d&&(i=eu(i));var o=f.length+i.length+a.length+(x?0:n.length),u=o<g?new Array(o=g-o+1).join(s):"";return x&&(i=eu(u+i)),n+=f,t=i+a,("<"===l?n+t+u:">"===l?u+n+t:"^"===l?u.substring(0,o>>=1)+n+t+u.substring(o):n+(x?t:u+t))+y}};var tu=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,nu=Va.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,n){return t.toPrecision(n)},e:function(t,n){return t.toExponential(n)},f:function(t,n){return t.toFixed(n)},r:function(t,n){return(t=Va.round(t,wt(t,n))).toFixed(Math.max(0,Math.min(20,wt(t*(1+1e-15),n))))}}),eu=pt;if(Ko){var ru=Ko.length;eu=function(t){for(var n=t.length,e=[],r=0,i=Ko[0];0<n&&0<i;)e.push(t.substring(n-=i,n+i)),i=Ko[r=(r+1)%ru];return e.reverse().join(Zo)}}Va.geo={},St.prototype={s:0,t:0,add:function(t){$t(t,this.t,iu),$t(iu.s,this.s,this),this.s?this.t+=iu.t:this.s=iu.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var iu=new St;Va.geo.stream=function(t,n){t&&au.hasOwnProperty(t.type)?au[t.type](t,n):Nt(t,n)};var au={Feature:function(t,n){Nt(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,r=-1,i=e.length;++r<i;)Nt(e[r].geometry,n)}},ou={Sphere:function(t,n){n.sphere()},Point:function(t,n){t=t.coordinates,n.point(t[0],t[1],t[2])},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)t=e[r],n.point(t[0],t[1],t[2])},LineString:function(t,n){At(t.coordinates,n,0)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)At(e[r],n,0)},Polygon:function(t,n){Et(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)Et(e[r],n)},GeometryCollection:function(t,n){for(var e=t.geometries,r=-1,i=e.length;++r<i;)Nt(e[r],n)}};Va.geo.area=function(t){return uu=0,Va.geo.stream(t,lu),uu};var uu,su=new St,lu={sphere:function(){uu+=4*bo},point:f,lineStart:f,lineEnd:f,polygonStart:function(){su.reset(),lu.lineStart=Ct},polygonEnd:function(){var t=2*su;uu+=t<0?4*bo+t:t,lu.lineStart=lu.lineEnd=lu.point=f}};Va.geo.bounds=function(){function c(t,n){m.push(x=[h=t,d=t]),n<g&&(g=n),p<n&&(p=n)}function r(t,n){var e=Lt([t*$o,n*$o]);if(v){var r=Tt(v,e),i=Tt([r[1],-r[0],0],r);Dt(i),i=qt(i);var a=t-_,o=0<a?1:-1,u=i[0]*No*o,s=180<eo(a);if(s^(o*_<u&&u<o*t)){var l=i[1]*No;p<l&&(p=l)}else if(s^(o*_<(u=(u+360)%360-180)&&u<o*t)){(l=-i[1]*No)<g&&(g=l)}else n<g&&(g=n),p<n&&(p=n);s?t<_?f(h,t)>f(h,d)&&(d=t):f(t,d)>f(h,d)&&(h=t):h<=d?(t<h&&(h=t),d<t&&(d=t)):_<t?f(h,t)>f(h,d)&&(d=t):f(t,d)>f(h,d)&&(h=t)}else c(t,n);v=e,_=t}function t(){b.point=r}function n(){x[0]=h,x[1]=d,b.point=c,v=null}function e(t,n){if(v){var e=t-_;y+=180<eo(e)?e+(0<e?360:-360):e}else o=t,u=n;lu.point(t,n),r(t,n)}function i(){lu.lineStart()}function a(){e(o,u),lu.lineEnd(),eo(y)>ko&&(h=-(d=180)),x[0]=h,x[1]=d,v=null}function f(t,n){return(n-=t)<0?n+360:n}function s(t,n){return t[0]-n[0]}function l(t,n){return n[0]<=n[1]?n[0]<=t&&t<=n[1]:t<n[0]||n[1]<t}var h,g,d,p,_,o,u,v,y,m,x,b={point:c,lineStart:t,lineEnd:n,polygonStart:function(){b.point=e,b.lineStart=i,b.lineEnd=a,y=0,lu.polygonStart()},polygonEnd:function(){lu.polygonEnd(),b.point=c,b.lineStart=t,b.lineEnd=n,su<0?(h=-(d=180),g=-(p=90)):ko<y?p=90:y<-ko&&(g=-90),x[0]=h,x[1]=d}};return function(t){if(p=d=-(h=g=1/0),m=[],Va.geo.stream(t,b),a=m.length){m.sort(s);for(var n=1,e=[u=m[0]];n<a;++n)l((i=m[n])[0],u)||l(i[1],u)?(f(u[0],i[1])>f(u[0],u[1])&&(u[1]=i[1]),f(i[0],u[1])>f(u[0],u[1])&&(u[0]=i[0])):e.push(u=i);for(var r,i,a,o=-1/0,u=(n=0,e[a=e.length-1]);n<=a;u=i,++n)i=e[n],(r=f(u[1],i[0]))>o&&(o=r,h=i[0],d=u[1])}return m=x=null,1/0===h||1/0===g?[[NaN,NaN],[NaN,NaN]]:[[h,g],[d,p]]}}(),Va.geo.centroid=function(t){cu=fu=hu=gu=du=pu=_u=vu=yu=mu=xu=0,Va.geo.stream(t,bu);var n=yu,e=mu,r=xu,i=n*n+e*e+r*r;return i<So&&(n=pu,e=_u,r=vu,fu<ko&&(n=hu,e=gu,r=du),(i=n*n+e*e+r*r)<So)?[NaN,NaN]:[Math.atan2(e,n)*No,j(r/Math.sqrt(i))*No]};var cu,fu,hu,gu,du,pu,_u,vu,yu,mu,xu,bu={sphere:f,point:jt,lineStart:Ut,lineEnd:Ht,polygonStart:function(){bu.lineStart=It},polygonEnd:function(){bu.lineStart=Ut}},Mu=Wt(Vt,Qt,nn,[-bo,-bo/2]),wu=1e9;Va.geo.clipExtent=function(){var n,e,r,i,a,o,u={stream:function(t){return a&&(a.valid=!1),(a=o(t)).valid=!0,a},extent:function(t){return arguments.length?(o=an(n=+t[0][0],e=+t[0][1],r=+t[1][0],i=+t[1][1]),a&&(a.valid=!1,a=null),u):[[n,e],[r,i]]}};return u.extent([[0,0],[960,500]])},(Va.geo.conicEqualArea=function(){return un(sn)}).raw=sn,Va.geo.albers=function(){return Va.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},Va.geo.albersUsa=function(){function i(t){var n=t[0],e=t[1];return r=null,a(n,e),r||(o(n,e),r)||u(n,e),r}var r,a,o,u,s=Va.geo.albers(),l=Va.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=Va.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),f={point:function(t,n){r=[t,n]}};return i.invert=function(t){var n=s.scale(),e=s.translate(),r=(t[0]-e[0])/n,i=(t[1]-e[1])/n;return(.12<=i&&i<.234&&-.425<=r&&r<-.214?l:.166<=i&&i<.234&&-.214<=r&&r<-.115?c:s).invert(t)},i.stream=function(t){var e=s.stream(t),r=l.stream(t),i=c.stream(t);return{point:function(t,n){e.point(t,n),r.point(t,n),i.point(t,n)},sphere:function(){e.sphere(),r.sphere(),i.sphere()},lineStart:function(){e.lineStart(),r.lineStart(),i.lineStart()},lineEnd:function(){e.lineEnd(),r.lineEnd(),i.lineEnd()},polygonStart:function(){e.polygonStart(),r.polygonStart(),i.polygonStart()},polygonEnd:function(){e.polygonEnd(),r.polygonEnd(),i.polygonEnd()}}},i.precision=function(t){return arguments.length?(s.precision(t),l.precision(t),c.precision(t),i):s.precision()},i.scale=function(t){return arguments.length?(s.scale(t),l.scale(.35*t),c.scale(t),i.translate(s.translate())):s.scale()},i.translate=function(t){if(!arguments.length)return s.translate();var n=s.scale(),e=+t[0],r=+t[1];return a=s.translate(t).clipExtent([[e-.455*n,r-.238*n],[e+.455*n,r+.238*n]]).stream(f).point,o=l.translate([e-.307*n,r+.201*n]).clipExtent([[e-.425*n+ko,r+.12*n+ko],[e-.214*n-ko,r+.234*n-ko]]).stream(f).point,u=c.translate([e-.205*n,r+.212*n]).clipExtent([[e-.214*n+ko,r+.166*n+ko],[e-.115*n-ko,r+.234*n-ko]]).stream(f).point,i},i.scale(1070)};var ku,Su,$u,Nu,Au,Eu,Cu={point:f,lineStart:f,lineEnd:f,polygonStart:function(){Su=0,Cu.lineStart=ln},polygonEnd:function(){Cu.lineStart=Cu.lineEnd=Cu.point=f,ku+=eo(Su/2)}},Lu={point:cn,lineStart:f,lineEnd:f,polygonStart:f,polygonEnd:f},Ru={point:gn,lineStart:dn,lineEnd:pn,polygonStart:function(){Ru.lineStart=_n},polygonEnd:function(){Ru.point=gn,Ru.lineStart=dn,Ru.lineEnd=pn}};Va.geo.transform=function(r){return{stream:function(t){var n=new mn(t);for(var e in r)n[e]=r[e];return n}}},mn.prototype={point:function(t,n){this.stream.point(t,n)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},Va.geo.path=function(){function n(t){return t&&("function"==typeof s&&o.pointRadius(+s.apply(this,arguments)),u&&u.valid||(u=a(o)),Va.geo.stream(t,u)),o.result()}function e(){return u=null,n}var r,i,a,o,u,s=4.5;return n.area=function(t){return ku=0,Va.geo.stream(t,a(Cu)),ku},n.centroid=function(t){return hu=gu=du=pu=_u=vu=yu=mu=xu=0,Va.geo.stream(t,a(Ru)),xu?[yu/xu,mu/xu]:vu?[pu/vu,_u/vu]:du?[hu/du,gu/du]:[NaN,NaN]},n.bounds=function(t){return Au=Eu=-($u=Nu=1/0),Va.geo.stream(t,a(Lu)),[[$u,Nu],[Au,Eu]]},n.projection=function(t){return arguments.length?(a=(r=t)?t.stream||xn(t):pt,e()):r},n.context=function(t){return arguments.length?(o=null==(i=t)?new fn:new vn(t),"function"!=typeof s&&o.pointRadius(s),e()):i},n.pointRadius=function(t){return arguments.length?(s="function"==typeof t?t:(o.pointRadius(+t),+t),n):s},n.projection(Va.geo.albersUsa()).context(null)},Va.geo.projection=bn,Va.geo.projectionMutator=Mn,(Va.geo.equirectangular=function(){return bn(kn)}).raw=kn.invert=kn,Va.geo.rotation=function(n){function t(t){return(t=n(t[0]*$o,t[1]*$o))[0]*=No,t[1]*=No,t}return n=$n(n[0]%360*$o,n[1]*$o,2<n.length?n[2]*$o:0),t.invert=function(t){return(t=n.invert(t[0]*$o,t[1]*$o))[0]*=No,t[1]*=No,t},t},Sn.invert=kn,Va.geo.circle=function(){function n(){var t="function"==typeof a?a.apply(this,arguments):a,e=$n(-t[0]*$o,-t[1]*$o,0).invert,r=[];return i(null,null,1,{point:function(t,n){r.push(t=e(t,n)),t[0]*=No,t[1]*=No}}),{type:"Polygon",coordinates:[r]}}var e,i,a=[0,0],r=6;return n.origin=function(t){return arguments.length?(a=t,n):a},n.angle=function(t){return arguments.length?(i=Cn((e=+t)*$o,r*$o),n):e},n.precision=function(t){return arguments.length?(i=Cn(e*$o,(r=+t)*$o),n):r},n.angle(90)},Va.geo.distance=function(t,n){var e,r=(n[0]-t[0])*$o,i=t[1]*$o,a=n[1]*$o,o=Math.sin(r),u=Math.cos(r),s=Math.sin(i),l=Math.cos(i),c=Math.sin(a),f=Math.cos(a);return Math.atan2(Math.sqrt((e=f*o)*e+(e=l*c-s*f*u)*e),s*c+l*f*u)},Va.geo.graticule=function(){function n(){return{type:"MultiLineString",coordinates:t()}}function t(){return Va.range(Math.ceil(a/_)*_,i,_).map(h).concat(Va.range(Math.ceil(l/v)*v,s,v).map(g)).concat(Va.range(Math.ceil(r/d)*d,e,d).filter(function(t){return eo(t%_)>ko}).map(c)).concat(Va.range(Math.ceil(u/p)*p,o,p).filter(function(t){return eo(t%v)>ko}).map(f))}var e,r,i,a,o,u,s,l,c,f,h,g,d=10,p=d,_=90,v=360,y=2.5;return n.lines=function(){return t().map(function(t){return{type:"LineString",coordinates:t}})},n.outline=function(){return{type:"Polygon",coordinates:[h(a).concat(g(s).slice(1),h(i).reverse().slice(1),g(l).reverse().slice(1))]}},n.extent=function(t){return arguments.length?n.majorExtent(t).minorExtent(t):n.minorExtent()},n.majorExtent=function(t){return arguments.length?(a=+t[0][0],i=+t[1][0],l=+t[0][1],s=+t[1][1],i<a&&(t=a,a=i,i=t),s<l&&(t=l,l=s,s=t),n.precision(y)):[[a,l],[i,s]]},n.minorExtent=function(t){return arguments.length?(r=+t[0][0],e=+t[1][0],u=+t[0][1],o=+t[1][1],e<r&&(t=r,r=e,e=t),o<u&&(t=u,u=o,o=t),n.precision(y)):[[r,u],[e,o]]},n.step=function(t){return arguments.length?n.majorStep(t).minorStep(t):n.minorStep()},n.majorStep=function(t){return arguments.length?(_=+t[0],v=+t[1],n):[_,v]},n.minorStep=function(t){return arguments.length?(d=+t[0],p=+t[1],n):[d,p]},n.precision=function(t){return arguments.length?(y=+t,c=Rn(u,o,90),f=Tn(r,e,y),h=Rn(l,s,90),g=Tn(a,i,y),n):y},n.majorExtent([[-180,-90+ko],[180,90-ko]]).minorExtent([[-180,-80-ko],[180,80+ko]])},Va.geo.greatArc=function(){function n(){return{type:"LineString",coordinates:[e||i.apply(this,arguments),r||a.apply(this,arguments)]}}var e,r,i=zn,a=Fn;return n.distance=function(){return Va.geo.distance(e||i.apply(this,arguments),r||a.apply(this,arguments))},n.source=function(t){return arguments.length?(e="function"==typeof(i=t)?null:t,n):i},n.target=function(t){return arguments.length?(r="function"==typeof(a=t)?null:t,n):a},n.precision=function(){return arguments.length?n:0},n},Va.geo.interpolate=function(t,n){return Dn(t[0]*$o,t[1]*$o,n[0]*$o,n[1]*$o)},Va.geo.length=function(t){return Tu=0,Va.geo.stream(t,zu),Tu};var Tu,zu={sphere:f,point:f,lineStart:qn,lineEnd:f,polygonStart:f,polygonEnd:f},Fu=Pn(function(t){return Math.sqrt(2/(1+t))},function(t){return 2*Math.asin(t/2)});(Va.geo.azimuthalEqualArea=function(){return bn(Fu)}).raw=Fu;var Du=Pn(function(t){var n=Math.acos(t);return n&&n/Math.sin(n)},pt);(Va.geo.azimuthalEquidistant=function(){return bn(Du)}).raw=Du,(Va.geo.conicConformal=function(){return un(jn)}).raw=jn,(Va.geo.conicEquidistant=function(){return un(On)}).raw=On;var qu=Pn(function(t){return 1/t},Math.atan);(Va.geo.gnomonic=function(){return bn(qu)}).raw=qu,Un.invert=function(t,n){return[t,2*Math.atan(Math.exp(n))-wo]},(Va.geo.mercator=function(){return Hn(Un)}).raw=Un;var Pu=Pn(function(){return 1},Math.asin);(Va.geo.orthographic=function(){return bn(Pu)}).raw=Pu;var ju=Pn(function(t){return 1/(1+t)},function(t){return 2*Math.atan(t)});(Va.geo.stereographic=function(){return bn(ju)}).raw=ju,In.invert=function(t,n){return[Math.atan2(O(t),Math.cos(n)),j(Math.sin(n)/U(t))]},(Va.geo.transverseMercator=function(){return Hn(In)}).raw=In,Va.geom={},Va.geom.hull=function(t){function n(t){if(t.length<3)return[];var n,e,r,i,a,o,u,s,l,c,f,h,g=dt(b),d=dt(M),p=t.length,_=p-1,v=[],y=[],m=0;if(g===Vn&&M===Yn)n=t;else for(r=0,n=[];r<p;++r)n.push([+g.call(this,e=t[r],r),+d.call(this,e,r)]);for(r=1;r<p;++r)(n[r][1]<n[m][1]||n[r][1]==n[m][1]&&n[r][0]<n[m][0])&&(m=r);for(r=0;r<p;++r)r!==m&&(o=n[r][1]-n[m][1],a=n[r][0]-n[m][0],v.push({angle:Math.atan2(o,a),index:r}));for(v.sort(function(t,n){return t.angle-n.angle}),f=v[0].angle,c=v[0].index,l=0,r=1;r<_;++r){if(i=v[r].index,f==v[r].angle){if(a=n[c][0]-n[m][0],o=n[c][1]-n[m][1],(u=n[i][0]-n[m][0])*u+(s=n[i][1]-n[m][1])*s<=a*a+o*o){v[r].index=-1;continue}v[l].index=-1}f=v[r].angle,l=r,c=i}for(y.push(m),i=r=0;r<2;++i)-1<v[i].index&&(y.push(v[i].index),r++);for(h=y.length;i<_;++i)if(!(v[i].index<0)){for(;!Bn(y[h-2],y[h-1],v[i].index,n);)--h;y[h++]=v[i].index}var x=[];for(r=h-1;0<=r;--r)x.push(t[y[r]]);return x}var b=Vn,M=Yn;return arguments.length?n(t):(n.x=function(t){return arguments.length?(b=t,n):b},n.y=function(t){return arguments.length?(M=t,n):M},n)},Va.geom.polygon=function(t){return uo(t,Ou),t};var Ou=Va.geom.polygon.prototype=[];Ou.area=function(){for(var t,n=-1,e=this.length,r=this[e-1],i=0;++n<e;)t=r,r=this[n],i+=t[1]*r[0]-t[0]*r[1];return.5*i},Ou.centroid=function(t){var n,e,r=-1,i=this.length,a=0,o=0,u=this[i-1];for(arguments.length||(t=-1/(6*this.area()));++r<i;)n=u,u=this[r],e=n[0]*u[1]-u[0]*n[1],a+=(n[0]+u[0])*e,o+=(n[1]+u[1])*e;return[a*t,o*t]},Ou.clip=function(t){for(var n,e,r,i,a,o,u=Xn(t),s=-1,l=this.length-Xn(this),c=this[l-1];++s<l;){for(n=t.slice(),t.length=0,i=this[s],a=n[(r=n.length-u)-1],e=-1;++e<r;)Gn(o=n[e],c,i)?(Gn(a,c,i)||t.push(Wn(a,o,c,i)),t.push(o)):Gn(a,c,i)&&t.push(Wn(a,o,c,i)),a=o;u&&t.push(t[0]),c=i}return t};var Uu,Hu,Iu,Vu,Yu,Bu=[],Gu=[];re.prototype.prepare=function(){for(var t,n=this.edges,e=n.length;e--;)(t=n[e].edge).b&&t.a||n.splice(e,1);return n.sort(ae),n.length},pe.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},_e.prototype={insert:function(t,n){var e,r,i;if(t){if(n.P=t,n.N=t.N,t.N&&(t.N.P=n),t.N=n,t.R){for(t=t.R;t.L;)t=t.L;t.L=n}else t.R=n;e=t}else this._?(t=xe(this._),n.P=null,(n.N=t).P=t.L=n,e=t):(n.P=n.N=null,this._=n,e=null);for(n.L=n.R=null,n.U=e,n.C=!0,t=n;e&&e.C;)e===(r=e.U).L?(i=r.R)&&i.C?(e.C=i.C=!1,r.C=!0,t=r):(t===e.R&&(ye(this,e),e=(t=e).U),e.C=!1,r.C=!0,me(this,r)):(i=r.L)&&i.C?(e.C=i.C=!1,r.C=!0,t=r):(t===e.L&&(me(this,e),e=(t=e).U),e.C=!1,r.C=!0,ye(this,r)),e=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var n,e,r,i=t.U,a=t.L,o=t.R;if(e=a?o?xe(o):a:o,i?i.L===t?i.L=e:i.R=e:this._=e,a&&o?(r=e.C,e.C=t.C,((e.L=a).U=e)!==o?(i=e.U,e.U=t.U,t=e.R,i.L=t,(e.R=o).U=e):(e.U=i,t=(i=e).R)):(r=t.C,t=e),t&&(t.U=i),!r){if(t&&t.C)return void(t.C=!1);do{if(t===this._)break;if(t===i.L){if((n=i.R).C&&(n.C=!1,i.C=!0,ye(this,i),n=i.R),n.L&&n.L.C||n.R&&n.R.C){n.R&&n.R.C||(n.L.C=!1,n.C=!0,me(this,n),n=i.R),n.C=i.C,i.C=n.R.C=!1,ye(this,i),t=this._;break}}else if((n=i.L).C&&(n.C=!1,i.C=!0,me(this,i),n=i.L),n.L&&n.L.C||n.R&&n.R.C){n.L&&n.L.C||(n.R.C=!1,n.C=!0,ye(this,n),n=i.L),n.C=i.C,i.C=n.L.C=!1,me(this,i),t=this._;break}n.C=!0,i=(t=i).U}while(!t.C);t&&(t.C=!1)}}},Va.geom.voronoi=function(t){function n(i){var a=new Array(i.length),o=c[0][0],u=c[0][1],s=c[1][0],l=c[1][1];return be(e(i),c).cells.forEach(function(t,n){var e=t.edges,r=t.site;(a[n]=e.length?e.map(function(t){var n=t.start();return[n.x,n.y]}):r.x>=o&&r.x<=s&&r.y>=u&&r.y<=l?[[o,l],[s,l],[s,u],[o,u]]:[]).point=i[n]}),a}function e(t){return t.map(function(t,n){return{x:Math.round(a(t,n)/ko)*ko,y:Math.round(o(t,n)/ko)*ko,i:n}})}var r=Vn,i=Yn,a=r,o=i,c=Wu;return t?n(t):(n.links=function(n){return be(e(n)).edges.filter(function(t){return t.l&&t.r}).map(function(t){return{source:n[t.l.i],target:n[t.r.i]}})},n.triangles=function(l){var c=[];return be(e(l)).cells.forEach(function(t,n){for(var e,r=t.site,i=t.edges.sort(ae),a=-1,o=i.length,u=i[o-1].edge,s=u.l===r?u.r:u.l;++a<o;)u,e=s,s=(u=i[a].edge).l===r?u.r:u.l,n<e.i&&n<s.i&&we(r,e,s)<0&&c.push([l[n],l[e.i],l[s.i]])}),c},n.x=function(t){return arguments.length?(a=dt(r=t),n):r},n.y=function(t){return arguments.length?(o=dt(i=t),n):i},n.clipExtent=function(t){return arguments.length?(c=null==t?Wu:t,n):c===Wu?null:c},n.size=function(t){return arguments.length?n.clipExtent(t&&[[0,0],t]):c===Wu?null:c&&c[1]},n)};var Wu=[[-1e6,-1e6],[1e6,1e6]];Va.geom.delaunay=function(t){return Va.geom.voronoi().triangles(t)},Va.geom.quadtree=function(t,m,x,b,M){function n(t){function g(t,n,e,r,i,a,o,u){if(!isNaN(e)&&!isNaN(r))if(t.leaf){var s=t.x,l=t.y;if(null!=s)if(eo(s-e)+eo(l-r)<.01)f(t,n,e,r,i,a,o,u);else{var c=t.point;t.x=t.y=t.point=null,f(t,c,s,l,i,a,o,u),f(t,n,e,r,i,a,o,u)}else t.x=e,t.y=r,t.point=n}else f(t,n,e,r,i,a,o,u)}function f(t,n,e,r,i,a,o,u){var s=.5*(i+o),l=.5*(a+u),c=s<=e,f=l<=r,h=(f<<1)+c;t.leaf=!1,c?i=s:o=s,f?a=l:u=l,g(t=t.nodes[h]||(t.nodes[h]=$e()),n,e,r,i,a,o,u)}var n,e,r,i,a,o,u,s,l,c=dt(k),h=dt(S);if(null!=m)o=m,u=x,s=b,l=M;else if(s=l=-(o=u=1/0),e=[],r=[],a=t.length,w)for(i=0;i<a;++i)(n=t[i]).x<o&&(o=n.x),n.y<u&&(u=n.y),n.x>s&&(s=n.x),n.y>l&&(l=n.y),e.push(n.x),r.push(n.y);else for(i=0;i<a;++i){var d=+c(n=t[i],i),p=+h(n,i);d<o&&(o=d),p<u&&(u=p),s<d&&(s=d),l<p&&(l=p),e.push(d),r.push(p)}var _=s-o,v=l-u;v<_?l=u+_:s=o+v;var y=$e();if(y.add=function(t){g(y,t,+c(t,++i),+h(t,i),o,u,s,l)},y.visit=function(t){Ne(t,y,o,u,s,l)},i=-1,null==m){for(;++i<a;)g(y,t[i],e[i],r[i],o,u,s,l);--i}else t.forEach(y.add);return e=r=t=n=null,y}var w,k=Vn,S=Yn;return(w=arguments.length)?(k=ke,S=Se,3===w&&(M=x,b=m,x=m=0),n(t)):(n.x=function(t){return arguments.length?(k=t,n):k},n.y=function(t){return arguments.length?(S=t,n):S},n.extent=function(t){return arguments.length?(null==t?m=x=b=M=null:(m=+t[0][0],x=+t[0][1],b=+t[1][0],M=+t[1][1]),n):null==m?null:[[m,x],[b,M]]},n.size=function(t){return arguments.length?(null==t?m=x=b=M=null:(m=x=0,b=+t[0],M=+t[1]),n):null==m?null:[b-m,M-x]},n)},Va.interpolateRgb=Ae,Va.interpolateObject=Ee,Va.interpolateNumber=Ce,Va.interpolateString=Le;var Xu=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;Va.interpolate=Re,Va.interpolators=[function(t,n){var e=typeof n;return("string"===e?Ho.has(n)||/^(#|rgb\(|hsl\()/.test(n)?Ae:Le:n instanceof V?Ae:"object"===e?Array.isArray(n)?Te:Ee:Ce)(t,n)}],Va.interpolateArray=Te;var Zu=function(){return pt},Ku=Va.map({linear:Zu,poly:Oe,quad:function(){return qe},cubic:function(){return Pe},sin:function(){return Ue},exp:function(){return He},circle:function(){return Ie},elastic:Ve,back:Ye,bounce:function(){return Be}}),Ju=Va.map({"in":pt,out:Fe,"in-out":De,"out-in":function(t){return De(Fe(t))}});Va.ease=function(t){var n=t.indexOf("-"),e=0<=n?t.substring(0,n):t,r=0<=n?t.substring(n+1):"in";return e=Ku.get(e)||Zu,ze((r=Ju.get(r)||pt)(e.apply(null,Ya.call(arguments,1))))},Va.interpolateHcl=Ge,Va.interpolateHsl=We,Va.interpolateLab=Xe,Va.interpolateRound=Ze,Va.transform=function(t){var e=Ga.createElementNS(Va.ns.prefix.svg,"g");return(Va.transform=function(t){if(null!=t){e.setAttribute("transform",t);var n=e.transform.baseVal.consolidate()}return new Ke(n?n.matrix:Qu)})(t)},Ke.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var Qu={a:1,b:0,c:0,d:1,e:0,f:0};Va.interpolateTransform=nr,Va.layout={},Va.layout.bundle=function(){return function(t){for(var n=[],e=-1,r=t.length;++e<r;)n.push(ir(t[e]));return n}},Va.layout.chord=function(){function t(){var t,n,e,r,i,a={},o=[],u=Va.range(x),s=[];for(v=[],y=[],t=0,r=-1;++r<x;){for(n=0,i=-1;++i<x;)n+=m[r][i];o.push(n),s.push(Va.range(x)),t+=n}for(b&&u.sort(function(t,n){return b(o[t],o[n])}),M&&s.forEach(function(t,e){t.sort(function(t,n){return M(m[e][t],m[e][n])})}),t=(Mo-k*x)/t,n=0,r=-1;++r<x;){for(e=n,i=-1;++i<x;){var l=u[r],c=s[l][i],f=m[l][c],h=n,g=n+=f*t;a[l+"-"+c]={index:l,subindex:c,startAngle:h,endAngle:g,value:f}}y[l]={index:l,startAngle:e,endAngle:n,value:(n-e)/t},n+=k}for(r=-1;++r<x;)for(i=r-1;++i<x;){var d=a[r+"-"+i],p=a[i+"-"+r];(d.value||p.value)&&v.push(d.value<p.value?{source:p,target:d}:{source:d,target:p})}w&&_()}function _(){v.sort(function(t,n){return w((t.source.value+t.target.value)/2,(n.source.value+n.target.value)/2)})}var v,y,m,x,b,M,w,n={},k=0;return n.matrix=function(t){return arguments.length?(x=(m=t)&&m.length,v=y=null,n):m},n.padding=function(t){return arguments.length?(k=t,v=y=null,n):k},n.sortGroups=function(t){return arguments.length?(b=t,v=y=null,n):b},n.sortSubgroups=function(t){return arguments.length?(M=t,v=null,n):M},n.sortChords=function(t){return arguments.length?(w=t,v&&_(),n):w},n.chords=function(){return v||t(),v},n.groups=function(){return y||t(),y},n},Va.layout.force=function(){function f(s){return function(t,n,e,r){if(t.point!==s){var i=t.cx-s.x,a=t.cy-s.y,o=1/Math.sqrt(i*i+a*a);if((r-n)*o<l){var u=t.charge*o*o;return s.px-=i*u,s.py-=a*u,!0}if(t.point&&isFinite(o)){u=t.pointCharge*o*o;s.px-=i*u,s.py-=a*u}}return!t.charge}}function t(t){t.px=Va.event.x,t.py=Va.event.y,a.resume()}var n,h,g,d,p,a={},_=Va.dispatch("start","tick","end"),v=[1,1],y=.9,o=ts,c=ns,m=-30,x=.1,l=.8,b=[],M=[];return a.tick=function(){if((h*=.99)<.005)return _.end({type:"end",alpha:h=0}),!0;var t,n,e,r,i,a,o,u,s,l=b.length,c=M.length;for(n=0;n<c;++n)r=(e=M[n]).source,(a=(u=(i=e.target).x-r.x)*u+(s=i.y-r.y)*s)&&(u*=a=h*d[n]*((a=Math.sqrt(a))-g[n])/a,s*=a,i.x-=u*(o=r.weight/(i.weight+r.weight)),i.y-=s*o,r.x+=u*(o=1-o),r.y+=s*o);if((o=h*x)&&(u=v[0]/2,s=v[1]/2,n=-1,o))for(;++n<l;)(e=b[n]).x+=(u-e.x)*o,e.y+=(s-e.y)*o;if(m)for(fr(t=Va.geom.quadtree(b),h,p),n=-1;++n<l;)(e=b[n]).fixed||t.visit(f(e));for(n=-1;++n<l;)(e=b[n]).fixed?(e.x=e.px,e.y=e.py):(e.x-=(e.px-(e.px=e.x))*y,e.y-=(e.py-(e.py=e.y))*y);_.tick({type:"tick",alpha:h})},a.nodes=function(t){return arguments.length?(b=t,a):b},a.links=function(t){return arguments.length?(M=t,a):M},a.size=function(t){return arguments.length?(v=t,a):v},a.linkDistance=function(t){return arguments.length?(o="function"==typeof t?t:+t,a):o},a.distance=a.linkDistance,a.linkStrength=function(t){return arguments.length?(c="function"==typeof t?t:+t,a):c},a.friction=function(t){return arguments.length?(y=+t,a):y},a.charge=function(t){return arguments.length?(m="function"==typeof t?t:+t,a):m},a.gravity=function(t){return arguments.length?(x=+t,a):x},a.theta=function(t){return arguments.length?(l=+t,a):l},a.alpha=function(t){return arguments.length?(t=+t,h?h=0<t?t:0:0<t&&(_.start({type:"start",alpha:h=t}),Va.timer(a.tick)),a):h},a.start=function(){function t(t,n){if(!s){for(s=new Array(l),a=0;a<l;++a)s[a]=[];for(a=0;a<o;++a){var e=M[a];s[e.source.index].push(e.target),s[e.target.index].push(e.source)}}for(var r,i=s[u],a=-1,o=i.length;++a<o;)if(!isNaN(r=i[a][t]))return r;return Math.random()*n}var u,s,n,l=b.length,e=M.length,r=v[0],i=v[1];for(u=0;u<l;++u)(n=b[u]).index=u,n.weight=0;for(u=0;u<e;++u)"number"==typeof(n=M[u]).source&&(n.source=b[n.source]),"number"==typeof n.target&&(n.target=b[n.target]),++n.source.weight,++n.target.weight;for(u=0;u<l;++u)n=b[u],isNaN(n.x)&&(n.x=t("x",r)),isNaN(n.y)&&(n.y=t("y",i)),isNaN(n.px)&&(n.px=n.x),isNaN(n.py)&&(n.py=n.y);if(g=[],"function"==typeof o)for(u=0;u<e;++u)g[u]=+o.call(this,M[u],u);else for(u=0;u<e;++u)g[u]=o;if(d=[],"function"==typeof c)for(u=0;u<e;++u)d[u]=+c.call(this,M[u],u);else for(u=0;u<e;++u)d[u]=c;if(p=[],"function"==typeof m)for(u=0;u<l;++u)p[u]=+m.call(this,b[u],u);else for(u=0;u<l;++u)p[u]=m;return a.resume()},a.resume=function(){return a.alpha(.1)},a.stop=function(){return a.alpha(0)},a.drag=function(){return n||(n=Va.behavior.drag().origin(pt).on("dragstart.force",ur).on("drag.force",t).on("dragend.force",sr)),arguments.length?void this.on("mouseover.force",lr).on("mouseout.force",cr).call(n):n},Va.rebind(a,_,"on")};var ts=20,ns=1;Va.layout.hierarchy=function(){function c(t,n,e){var r=g.call(f,t,n);if(t.depth=n,e.push(t),r&&(i=r.length)){for(var i,a,o=-1,u=t.children=new Array(i),s=0,l=n+1;++o<i;)(a=u[o]=c(r[o],l,e)).parent=t,s+=a.value;h&&u.sort(h),d&&(t.value=s)}else delete t.children,d&&(t.value=+d.call(f,t,n)||0);return t}function u(t,n){var e=t.children,r=0;if(e&&(i=e.length))for(var i,a=-1,o=n+1;++a<i;)r+=u(e[a],o);else d&&(r=+d.call(f,t,n)||0);return d&&(t.value=r),r}function f(t){var n=[];return c(t,0,n),n}var h=pr,g=gr,d=dr;return f.sort=function(t){return arguments.length?(h=t,f):h},f.children=function(t){return arguments.length?(g=t,f):g},f.value=function(t){return arguments.length?(d=t,f):d},f.revalue=function(t){return u(t,0),t},f},Va.layout.partition=function(){function l(t,n,e,r){var i=t.children;if(t.x=n,t.y=t.depth*r,t.dx=e,t.dy=r,i&&(a=i.length)){var a,o,u,s=-1;for(e=t.value?e/t.value:0;++s<a;)l(o=i[s],n,u=o.value*e,r),n+=u}}function a(t){var n=t.children,e=0;if(n&&(r=n.length))for(var r,i=-1;++i<r;)e=Math.max(e,a(n[i]));return 1+e}function n(t,n){var e=r.call(this,t,n);return l(e[0],0,i[0],i[1]/a(e[0])),e}var r=Va.layout.hierarchy(),i=[1,1];return n.size=function(t){return arguments.length?(i=t,n):i},hr(n,r)},Va.layout.pie=function(){function u(e){var r=e.map(function(t,n){return+s.call(u,t,n)}),i=+("function"==typeof n?n.apply(this,arguments):n),a=(("function"==typeof c?c.apply(this,arguments):c)-i)/Va.sum(r),t=Va.range(e.length);null!=l&&t.sort(
l===es?function(t,n){return r[n]-r[t]}:function(t,n){return l(e[t],e[n])});var o=[];return t.forEach(function(t){var n;o[t]={data:e[t],value:n=r[t],startAngle:i,endAngle:i+=n*a}}),o}var s=Number,l=es,n=0,c=Mo;return u.value=function(t){return arguments.length?(s=t,u):s},u.sort=function(t){return arguments.length?(l=t,u):l},u.startAngle=function(t){return arguments.length?(n=t,u):n},u.endAngle=function(t){return arguments.length?(c=t,u):c},u};var es={};Va.layout.stack=function(){function f(t,n){var e=t.map(function(t,n){return h.call(f,t,n)}),r=e.map(function(t){return t.map(function(t,n){return[_.call(f,t,n),v.call(f,t,n)]})}),i=g.call(f,r,n);e=Va.permute(e,i),r=Va.permute(r,i);var a,o,u,s=d.call(f,r,n),l=e.length,c=e[0].length;for(o=0;o<c;++o)for(p.call(f,e[0][o],u=s[o],r[0][o][1]),a=1;a<l;++a)p.call(f,e[a][o],u+=r[a-1][o][1],r[a][o][1]);return t}var h=pt,g=xr,d=br,p=mr,_=vr,v=yr;return f.values=function(t){return arguments.length?(h=t,f):h},f.order=function(t){return arguments.length?(g="function"==typeof t?t:rs.get(t)||xr,f):g},f.offset=function(t){return arguments.length?(d="function"==typeof t?t:is.get(t)||br,f):d},f.x=function(t){return arguments.length?(_=t,f):_},f.y=function(t){return arguments.length?(v=t,f):v},f.out=function(t){return arguments.length?(p=t,f):p},f};var rs=Va.map({"inside-out":function(t){var n,e,r=t.length,i=t.map(Mr),a=t.map(wr),o=Va.range(r).sort(function(t,n){return i[t]-i[n]}),u=0,s=0,l=[],c=[];for(n=0;n<r;++n)e=o[n],u<s?(u+=a[e],l.push(e)):(s+=a[e],c.push(e));return c.reverse().concat(l)},reverse:function(t){return Va.range(t.length).reverse()},"default":xr}),is=Va.map({silhouette:function(t){var n,e,r,i=t.length,a=t[0].length,o=[],u=0,s=[];for(e=0;e<a;++e){for(r=n=0;n<i;n++)r+=t[n][e][1];u<r&&(u=r),o.push(r)}for(e=0;e<a;++e)s[e]=(u-o[e])/2;return s},wiggle:function(t){var n,e,r,i,a,o,u,s,l,c=t.length,f=t[0],h=f.length,g=[];for(g[0]=s=l=0,e=1;e<h;++e){for(i=n=0;n<c;++n)i+=t[n][e][1];for(a=n=0,u=f[e][0]-f[e-1][0];n<c;++n){for(r=0,o=(t[n][e][1]-t[n][e-1][1])/(2*u);r<n;++r)o+=(t[r][e][1]-t[r][e-1][1])/u;a+=o*t[n][e][1]}g[e]=s-=i?a/i*u:0,s<l&&(l=s)}for(e=0;e<h;++e)g[e]-=l;return g},expand:function(t){var n,e,r,i=t.length,a=t[0].length,o=1/i,u=[];for(e=0;e<a;++e){for(r=n=0;n<i;n++)r+=t[n][e][1];if(r)for(n=0;n<i;n++)t[n][e][1]/=r;else for(n=0;n<i;n++)t[n][e][1]=o}for(e=0;e<a;++e)u[e]=0;return u},zero:br});Va.layout.histogram=function(){function e(t,n){for(var e,r,i=[],a=t.map(h,this),o=g.call(this,a,n),u=d.call(this,o,a,n),s=(n=-1,a.length),l=u.length-1,c=f?1:1/s;++n<l;)(e=i[n]=[]).dx=u[n+1]-(e.x=u[n]),e.y=0;if(0<l)for(n=-1;++n<s;)(r=a[n])>=o[0]&&r<=o[1]&&((e=i[Va.bisect(u,r,1,l)-1]).y+=c,e.push(t[n]));return i}var f=!0,h=Number,g=Nr,d=Sr;return e.value=function(t){return arguments.length?(h=t,e):h},e.range=function(t){return arguments.length?(g=dt(t),e):g},e.bins=function(n){return arguments.length?(d="number"==typeof n?function(t){return $r(t,n)}:dt(n),e):d},e.frequency=function(t){return arguments.length?(f=!!t,e):f},e},Va.layout.tree=function(){function n(t,n){function f(t,n){var e=t.children,r=t._tree;if(e&&(i=e.length)){for(var i,a,o,u=e[0],s=u,l=-1;++l<i;)f(o=e[l],a),s=h(o,a,s),a=o;Dr(t);var c=.5*(u._tree.prelim+o._tree.prelim);n?(r.prelim=n._tree.prelim+d(t,n),r.mod=r.prelim-c):r.prelim=c}else n&&(r.prelim=n._tree.prelim+d(t,n))}function a(t,n){t.x=t._tree.prelim+n;var e=t.children;if(e&&(r=e.length)){var r,i=-1;for(n+=t._tree.mod;++i<r;)a(e[i],n)}}function h(t,n,e){if(n){for(var r,i=t,a=t,o=n,u=t.parent.children[0],s=i._tree.mod,l=a._tree.mod,c=o._tree.mod,f=u._tree.mod;o=Cr(o),i=Er(i),o&&i;)u=Er(u),(a=Cr(a))._tree.ancestor=t,0<(r=o._tree.prelim+c-i._tree.prelim-s+d(o,i))&&(qr(Pr(o,t,e),t,r),s+=r,l+=r),c+=o._tree.mod,s+=i._tree.mod,f+=u._tree.mod,l+=a._tree.mod;o&&!Cr(a)&&(a._tree.thread=o,a._tree.mod+=c-l),i&&!Er(u)&&(u._tree.thread=i,u._tree.mod+=s-f,e=t)}return e}var e=g.call(this,t,n),r=e[0];Fr(r,function(t,n){t._tree={ancestor:t,prelim:0,mod:0,change:0,shift:0,number:n?n._tree.number+1:0}}),f(r),a(r,-r._tree.prelim);var i=Lr(r,Tr),o=Lr(r,Rr),u=Lr(r,zr),s=i.x-d(i,o)/2,l=o.x+d(o,i)/2,c=u.depth||1;return Fr(r,_?function(t){t.x*=p[0],t.y=t.depth*p[1],delete t._tree}:function(t){t.x=(t.x-s)/(l-s)*p[0],t.y=t.depth/c*p[1],delete t._tree}),e}var g=Va.layout.hierarchy().sort(null).value(null),d=Ar,p=[1,1],_=!1;return n.separation=function(t){return arguments.length?(d=t,n):d},n.size=function(t){return arguments.length?(_=null==(p=t),n):_?null:p},n.nodeSize=function(t){return arguments.length?(_=null!=(p=t),n):_?p:null},hr(n,g)},Va.layout.pack=function(){function n(t,n){var e=l.call(this,t,n),r=e[0],i=f[0],a=f[1],o=null==s?Math.sqrt:"function"==typeof s?s:function(){return s};if(r.x=r.y=0,Fr(r,function(t){t.r=+o(t.value)}),Fr(r,Ir),c){var u=c*(s?1:Math.max(2*r.r/i,2*r.r/a))/2;Fr(r,function(t){t.r+=u}),Fr(r,Ir),Fr(r,function(t){t.r-=u})}return Br(r,i/2,a/2,s?1:1/Math.max(2*r.r/i,2*r.r/a)),e}var s,l=Va.layout.hierarchy().sort(jr),c=0,f=[1,1];return n.size=function(t){return arguments.length?(f=t,n):f},n.radius=function(t){return arguments.length?(s=null==t||"function"==typeof t?t:+t,n):s},n.padding=function(t){return arguments.length?(c=+t,n):c},hr(n,l)},Va.layout.cluster=function(){function n(t,n){var e,r=c.call(this,t,n),i=r[0],a=0;Fr(i,function(t){var n=t.children;n&&n.length?(t.x=Xr(n),t.y=Wr(n)):(t.x=e?a+=f(t,e):0,t.y=0,e=t)});var o=Zr(i),u=Kr(i),s=o.x-f(o,u)/2,l=u.x+f(u,o)/2;return Fr(i,g?function(t){t.x=(t.x-i.x)*h[0],t.y=(i.y-t.y)*h[1]}:function(t){t.x=(t.x-s)/(l-s)*h[0],t.y=(1-(i.y?t.y/i.y:1))*h[1]}),r}var c=Va.layout.hierarchy().sort(null).value(null),f=Ar,h=[1,1],g=!1;return n.separation=function(t){return arguments.length?(f=t,n):f},n.size=function(t){return arguments.length?(g=null==(h=t),n):g?null:h},n.nodeSize=function(t){return arguments.length?(g=null!=(h=t),n):g?h:null},hr(n,c)},Va.layout.treemap=function(){function c(t,n){for(var e,r,i=-1,a=t.length;++i<a;)r=(e=t[i]).value*(n<0?0:n),e.area=isNaN(r)||r<=0?0:r}function f(t){var n=t.children;if(n&&n.length){var e,r,i,a=p(t),o=[],u=n.slice(),s=1/0,l="slice"===_?a.dx:"dice"===_?a.dy:"slice-dice"===_?1&t.depth?a.dy:a.dx:Math.min(a.dx,a.dy);for(c(u,a.dx*a.dy/t.value),o.area=0;0<(i=u.length);)o.push(e=u[i-1]),o.area+=e.area,"squarify"!==_||(r=h(o,l))<=s?(u.pop(),s=r):(o.area-=o.pop().area,g(o,l,a,!1),l=Math.min(a.dx,a.dy),o.length=o.area=0,s=1/0);o.length&&(g(o,l,a,!0),o.length=o.area=0),n.forEach(f)}}function o(t){var n=t.children;if(n&&n.length){var e,r=p(t),i=n.slice(),a=[];for(c(i,r.dx*r.dy/t.value),a.area=0;e=i.pop();)a.push(e),a.area+=e.area,null!=e.z&&(g(a,e.z?r.dx:r.dy,r,!i.length),a.length=a.area=0);n.forEach(o)}}function h(t,n){for(var e,r=t.area,i=0,a=1/0,o=-1,u=t.length;++o<u;)(e=t[o].area)&&(e<a&&(a=e),i<e&&(i=e));return n*=n,(r*=r)?Math.max(n*i*v/r,r/(n*a*v)):1/0}function g(t,n,e,r){var i,a=-1,o=t.length,u=e.x,s=e.y,l=n?d(t.area/n):0;if(n==e.dx){for((r||l>e.dy)&&(l=e.dy);++a<o;)(i=t[a]).x=u,i.y=s,i.dy=l,u+=i.dx=Math.min(e.x+e.dx-u,l?d(i.area/l):0);i.z=!0,i.dx+=e.x+e.dx-u,e.y+=l,e.dy-=l}else{for((r||l>e.dx)&&(l=e.dx);++a<o;)(i=t[a]).x=u,i.y=s,i.dx=l,s+=i.dy=Math.min(e.y+e.dy-s,l?d(i.area/l):0);i.z=!1,i.dy+=e.y+e.dy-s,e.x+=l,e.dx-=l}}function i(t){var n=r||a(t),e=n[0];return e.x=0,e.y=0,e.dx=u[0],e.dy=u[1],r&&a.revalue(e),c([e],e.dx*e.dy/e.value),(r?o:f)(e),l&&(r=n),n}var r,a=Va.layout.hierarchy(),d=Math.round,u=[1,1],s=null,p=Jr,l=!1,_="squarify",v=.5*(1+Math.sqrt(5));return i.size=function(t){return arguments.length?(u=t,i):u},i.padding=function(e){function t(t){var n=e.call(i,t,t.depth);return null==n?Jr(t):Qr(t,"number"==typeof n?[n,n,n,n]:n)}function n(t){return Qr(t,e)}return arguments.length?(p=null==(s=e)?Jr:"function"==(r=typeof e)?t:("number"===r&&(e=[e,e,e,e]),n),i):s;var r},i.round=function(t){return arguments.length?(d=t?Math.round:Number,i):d!=Number},i.sticky=function(t){return arguments.length?(l=t,r=null,i):l},i.ratio=function(t){return arguments.length?(v=t,i):v},i.mode=function(t){return arguments.length?(_=t+"",i):_},hr(i,a)},Va.random={normal:function(r,i){var t=arguments.length;return t<2&&(i=1),t<1&&(r=0),function(){for(var t,n,e;!(e=(t=2*Math.random()-1)*t+(n=2*Math.random()-1)*n)||1<e;);return r+i*t*Math.sqrt(-2*Math.log(e)/e)}},logNormal:function(){var t=Va.random.normal.apply(Va,arguments);return function(){return Math.exp(t())}},irwinHall:function(e){return function(){for(var t=0,n=0;n<e;n++)t+=Math.random();return t/e}}},Va.scale={};var as={floor:pt,ceil:pt};Va.scale.linear=function(){return oi([0,1],[0,1],Re,!1)},Va.scale.log=function(){return hi(Va.scale.linear().domain([0,1]),10,!0,[1,10])};var os=Va.format(".0e"),us={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};Va.scale.pow=function(){return gi(Va.scale.linear(),1,[0,1])},Va.scale.sqrt=function(){return Va.scale.pow().exponent(.5)},Va.scale.ordinal=function(){return pi([],{t:"range",a:[[]]})},Va.scale.category10=function(){return Va.scale.ordinal().range(ss)},Va.scale.category20=function(){return Va.scale.ordinal().range(ls)},Va.scale.category20b=function(){return Va.scale.ordinal().range(cs)},Va.scale.category20c=function(){return Va.scale.ordinal().range(fs)};var ss=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(at),ls=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(at),cs=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(at),fs=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(at);Va.scale.quantile=function(){return _i([],[])},Va.scale.quantize=function(){return vi(0,1,[0,1])},Va.scale.threshold=function(){return yi([.5],[0,1])},Va.scale.identity=function(){return mi([0,1])},Va.svg={},Va.svg.arc=function(){function n(){var t=c.apply(this,arguments),n=f.apply(this,arguments),e=h.apply(this,arguments)+hs,r=g.apply(this,arguments)+hs,i=(r<e&&(i=e,e=r,r=i),r-e),a=i<bo?"0":"1",o=Math.cos(e),u=Math.sin(e),s=Math.cos(r),l=Math.sin(r);return gs<=i?t?"M0,"+n+"A"+n+","+n+" 0 1,1 0,"+-n+"A"+n+","+n+" 0 1,1 0,"+n+"M0,"+t+"A"+t+","+t+" 0 1,0 0,"+-t+"A"+t+","+t+" 0 1,0 0,"+t+"Z":"M0,"+n+"A"+n+","+n+" 0 1,1 0,"+-n+"A"+n+","+n+" 0 1,1 0,"+n+"Z":t?"M"+n*o+","+n*u+"A"+n+","+n+" 0 "+a+",1 "+n*s+","+n*l+"L"+t*s+","+t*l+"A"+t+","+t+" 0 "+a+",0 "+t*o+","+t*u+"Z":"M"+n*o+","+n*u+"A"+n+","+n+" 0 "+a+",1 "+n*s+","+n*l+"L0,0Z"}var c=xi,f=bi,h=Mi,g=wi;return n.innerRadius=function(t){return arguments.length?(c=dt(t),n):c},n.outerRadius=function(t){return arguments.length?(f=dt(t),n):f},n.startAngle=function(t){return arguments.length?(h=dt(t),n):h},n.endAngle=function(t){return arguments.length?(g=dt(t),n):g},n.centroid=function(){var t=(c.apply(this,arguments)+f.apply(this,arguments))/2,n=(h.apply(this,arguments)+g.apply(this,arguments))/2+hs;return[Math.cos(n)*t,Math.sin(n)*t]},n};var hs=-wo,gs=Mo-ko;Va.svg.line=function(){return ki(pt)};var ds=Va.map({linear:Si,"linear-closed":$i,step:Ni,"step-before":Ai,"step-after":Ei,basis:Fi,"basis-open":Di,"basis-closed":qi,bundle:Pi,cardinal:Ri,"cardinal-open":Ci,"cardinal-closed":Li,monotone:Vi});ds.forEach(function(t,n){n.key=t,n.closed=/-closed$/.test(t)});var ps=[0,2/3,1/3,0],_s=[0,1/3,2/3,0],vs=[0,1/6,2/3,1/6];Va.svg.line.radial=function(){var t=ki(Yi);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},(Ai.reverse=Ei).reverse=Ai,Va.svg.area=function(){return Bi(pt)},Va.svg.area.radial=function(){var t=Bi(Yi);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},Va.svg.chord=function(){function n(t,n){var e=i(this,s,t,n),r=i(this,l,t,n);return"M"+e.p0+o(e.r,e.p1,e.a1-e.a0)+(a(e,r)?u(e.r,e.p1,e.r,e.p0):u(e.r,e.p1,r.r,r.p0)+o(r.r,r.p1,r.a1-r.a0)+u(r.r,r.p1,e.r,e.p0))+"Z"}function i(t,n,e,r){var i=n.call(t,e,r),a=c.call(t,i,r),o=f.call(t,i,r)+hs,u=h.call(t,i,r)+hs;return{r:a,a0:o,a1:u,p0:[a*Math.cos(o),a*Math.sin(o)],p1:[a*Math.cos(u),a*Math.sin(u)]}}function a(t,n){return t.a0==n.a0&&t.a1==n.a1}function o(t,n,e){return"A"+t+","+t+" 0 "+ +(bo<e)+",1 "+n}function u(t,n,e,r){return"Q 0,0 "+r}var s=zn,l=Fn,c=Gi,f=Mi,h=wi;return n.radius=function(t){return arguments.length?(c=dt(t),n):c},n.source=function(t){return arguments.length?(s=dt(t),n):s},n.target=function(t){return arguments.length?(l=dt(t),n):l},n.startAngle=function(t){return arguments.length?(f=dt(t),n):f},n.endAngle=function(t){return arguments.length?(h=dt(t),n):h},n},Va.svg.diagonal=function(){function n(t,n){var e=o.call(this,t,n),r=u.call(this,t,n),i=(e.y+r.y)/2,a=[e,{x:e.x,y:i},{x:r.x,y:i},r];return"M"+(a=a.map(s))[0]+"C"+a[1]+" "+a[2]+" "+a[3]}var o=zn,u=Fn,s=Wi;return n.source=function(t){return arguments.length?(o=dt(t),n):o},n.target=function(t){return arguments.length?(u=dt(t),n):u},n.projection=function(t){return arguments.length?(s=t,n):s},n},Va.svg.diagonal.radial=function(){var t=Va.svg.diagonal(),n=Wi,e=t.projection;return t.projection=function(t){return arguments.length?e(Xi(n=t)):n},t},Va.svg.symbol=function(){function n(t,n){return(ys.get(e.call(this,t,n))||Ji)(r.call(this,t,n))}var e=Ki,r=Zi;return n.type=function(t){return arguments.length?(e=dt(t),n):e},n.size=function(t){return arguments.length?(r=dt(t),n):r},n};var ys=Va.map({circle:Ji,cross:function(t){var n=Math.sqrt(t/5)/2;return"M"+-3*n+","+-n+"H"+-n+"V"+-3*n+"H"+n+"V"+-n+"H"+3*n+"V"+n+"H"+n+"V"+3*n+"H"+-n+"V"+n+"H"+-3*n+"Z"},diamond:function(t){var n=Math.sqrt(t/(2*Ms)),e=n*Ms;return"M0,"+-n+"L"+e+",0 0,"+n+" "+-e+",0Z"},square:function(t){var n=Math.sqrt(t)/2;return"M"+-n+","+-n+"L"+n+","+-n+" "+n+","+n+" "+-n+","+n+"Z"},"triangle-down":function(t){var n=Math.sqrt(t/bs),e=n*bs/2;return"M0,"+e+"L"+n+","+-e+" "+-n+","+-e+"Z"},"triangle-up":function(t){var n=Math.sqrt(t/bs),e=n*bs/2;return"M0,"+-e+"L"+n+","+e+" "+-n+","+e+"Z"}});Va.svg.symbolTypes=ys.keys();var ms,xs,bs=Math.sqrt(3),Ms=Math.tan(30*$o),ws=[],ks=0;ws.call=ho.call,ws.empty=ho.empty,ws.node=ho.node,ws.size=ho.size,Va.transition=function(t){return arguments.length?ms?t.transition():t:_o.transition()},(Va.transition.prototype=ws).select=function(t){var n,e,r,i=this.id,a=[];t=d(t);for(var o=-1,u=this.length;++o<u;){a.push(n=[]);for(var s=this[o],l=-1,c=s.length;++l<c;)(r=s[l])&&(e=t.call(r,r.__data__,l,o))?("__data__"in r&&(e.__data__=r.__data__),ea(e,l,i,r.__transition__[i]),n.push(e)):n.push(null)}return Qi(a,i)},ws.selectAll=function(t){var n,e,r,i,a,o=this.id,u=[];t=p(t);for(var s=-1,l=this.length;++s<l;)for(var c=this[s],f=-1,h=c.length;++f<h;)if(r=c[f]){a=r.__transition__[o],e=t.call(r,r.__data__,f,s),u.push(n=[]);for(var g=-1,d=e.length;++g<d;)(i=e[g])&&ea(i,g,o,a),n.push(i)}return Qi(u,o)},ws.filter=function(t){var n,e,r=[];"function"!=typeof t&&(t=k(t));for(var i=0,a=this.length;i<a;i++){r.push(n=[]);for(var o,u=0,s=(o=this[i]).length;u<s;u++)(e=o[u])&&t.call(e,e.__data__,u)&&n.push(e)}return Qi(r,this.id)},ws.tween=function(n,e){var r=this.id;return arguments.length<2?this.node().__transition__[r].tween.get(n):$(this,null==e?function(t){t.__transition__[r].tween.remove(n)}:function(t){t.__transition__[r].tween.set(n,e)})},ws.attr=function(t,n){function r(){this.removeAttribute(u)}function i(){this.removeAttributeNS(u.space,u.local)}function e(e){return null==e?r:(e+="",function(){var n,t=this.getAttribute(u);return t!==e&&(n=o(t,e),function(t){this.setAttribute(u,n(t))})})}function a(e){return null==e?i:(e+="",function(){var n,t=this.getAttributeNS(u.space,u.local);return t!==e&&(n=o(t,e),function(t){this.setAttributeNS(u.space,u.local,n(t))})})}if(arguments.length<2){for(n in t)this.attr(n,t[n]);return this}var o="transform"==t?nr:Re,u=Va.ns.qualify(t);return ta(this,"attr."+t,n,u.local?a:e)},ws.attrTween=function(t,r){function n(t,n){var e=r.call(this,t,n,this.getAttribute(i));return e&&function(t){this.setAttribute(i,e(t))}}function e(t,n){var e=r.call(this,t,n,this.getAttributeNS(i.space,i.local));return e&&function(t){this.setAttributeNS(i.space,i.local,e(t))}}var i=Va.ns.qualify(t);return this.tween("attr."+t,i.local?e:n)},ws.style=function(r,t,i){function n(){this.style.removeProperty(r)}function e(e){return null==e?n:(e+="",function(){var n,t=Xa.getComputedStyle(this,null).getPropertyValue(r);return t!==e&&(n=Re(t,e),function(t){this.style.setProperty(r,n(t),i)})})}var a=arguments.length;if(a<3){if("string"!=typeof r){for(i in a<2&&(t=""),r)this.style(i,r[i],t);return this}i=""}return ta(this,"style."+r,t,e)},ws.styleTween=function(r,i,a){function t(t,n){var e=i.call(this,t,n,Xa.getComputedStyle(this,null).getPropertyValue(r));return e&&function(t){this.style.setProperty(r,e(t),a)}}return arguments.length<3&&(a=""),this.tween("style."+r,t)},ws.text=function(t){return ta(this,"text",t,na)},ws.remove=function(){return this.each("end.transition",function(){var t;this.__transition__.count<2&&(t=this.parentNode)&&t.removeChild(this)})},ws.ease=function(n){var e=this.id;return arguments.length<1?this.node().__transition__[e].ease:("function"!=typeof n&&(n=Va.ease.apply(Va,arguments)),$(this,function(t){t.__transition__[e].ease=n}))},ws.delay=function(r){var i=this.id;return $(this,"function"==typeof r?function(t,n,e){t.__transition__[i].delay=+r.call(t,t.__data__,n,e)}:(r=+r,function(t){t.__transition__[i].delay=r}))},ws.duration=function(r){var i=this.id;return $(this,"function"==typeof r?function(t,n,e){t.__transition__[i].duration=Math.max(1,r.call(t,t.__data__,n,e))}:(r=Math.max(1,r),function(t){t.__transition__[i].duration=r}))},ws.each=function(r,e){var i=this.id;if(arguments.length<2){var t=xs,n=ms;ms=i,$(this,function(t,n,e){xs=t.__transition__[i],r.call(t,t.__data__,n,e)}),xs=t,ms=n}else $(this,function(t){var n=t.__transition__[i];(n.event||(n.event=Va.dispatch("start","end"))).on(r,e)});return this},ws.transition=function(){for(var t,n,e,r=this.id,i=++ks,a=[],o=0,u=this.length;o<u;o++){a.push(t=[]);for(var s,l=0,c=(s=this[o]).length;l<c;l++)(n=s[l])&&((e=Object.create(n.__transition__[r])).delay+=e.duration,ea(n,l,i,e)),t.push(n)}return Qi(a,i)},Va.svg.axis=function(){function e(t){t.each(function(){var t,n=Va.select(this),e=this.__chart__||b,r=this.__chart__=b.copy(),i=null==N?r.ticks?r.ticks.apply(r,$):r.domain():N,a=null==x?r.tickFormat?r.tickFormat.apply(r,$):pt:x,o=n.selectAll(".tick").data(i,r),u=o.enter().insert("g",".domain").attr("class","tick").style("opacity",ko),s=Va.transition(o.exit()).style("opacity",ko).remove(),l=Va.transition(o).style("opacity",1),c=ni(r),f=n.selectAll(".domain").data([0]),h=(f.enter().append("path").attr("class","domain"),Va.transition(f));u.append("line"),u.append("text");var g=u.select("line"),d=l.select("line"),p=o.select("text").text(a),_=u.select("text"),v=l.select("text");switch(M){case"bottom":t=ra,g.attr("y2",w),_.attr("y",Math.max(w,0)+S),d.attr("x2",0).attr("y2",w),v.attr("x",0).attr("y",Math.max(w,0)+S),p.attr("dy",".71em").style("text-anchor","middle"),h.attr("d","M"+c[0]+","+k+"V0H"+c[1]+"V"+k);break;case"top":t=ra,g.attr("y2",-w),_.attr("y",-(Math.max(w,0)+S)),d.attr("x2",0).attr("y2",-w),v.attr("x",0).attr("y",-(Math.max(w,0)+S)),p.attr("dy","0em").style("text-anchor","middle"),h.attr("d","M"+c[0]+","+-k+"V0H"+c[1]+"V"+-k);break;case"left":t=ia,g.attr("x2",-w),_.attr("x",-(Math.max(w,0)+S)),d.attr("x2",-w).attr("y2",0),v.attr("x",-(Math.max(w,0)+S)).attr("y",0),p.attr("dy",".32em").style("text-anchor","end"),h.attr("d","M"+-k+","+c[0]+"H0V"+c[1]+"H"+-k);break;case"right":t=ia,g.attr("x2",w),_.attr("x",Math.max(w,0)+S),d.attr("x2",w).attr("y2",0),v.attr("x",Math.max(w,0)+S).attr("y",0),p.attr("dy",".32em").style("text-anchor","start"),h.attr("d","M"+k+","+c[0]+"H0V"+c[1]+"H"+k)}if(r.rangeBand){var y=r.rangeBand()/2,m=function(t){return r(t)+y};u.call(t,m),l.call(t,m)}else u.call(t,e),l.call(t,r),s.call(t,r)})}var x,b=Va.scale.linear(),M=Ss,w=6,k=6,S=3,$=[10],N=null;return e.scale=function(t){return arguments.length?(b=t,e):b},e.orient=function(t){return arguments.length?(M=t in $s?t+"":Ss,e):M},e.ticks=function(){return arguments.length?($=arguments,e):$},e.tickValues=function(t){return arguments.length?(N=t,e):N},e.tickFormat=function(t){return arguments.length?(x=t,e):x},e.tickSize=function(t){var n=arguments.length;return n?(w=+t,k=+arguments[n-1],e):w},e.innerTickSize=function(t){return arguments.length?(w=+t,e):w},e.outerTickSize=function(t){return arguments.length?(k=+t,e):k},e.tickPadding=function(t){return arguments.length?(S=+t,e):S},e.tickSubdivide=function(){return arguments.length&&e},e};var Ss="bottom",$s={top:1,right:1,bottom:1,left:1};Va.svg.brush=function(){function x(t){t.each(function(){var t=Va.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",o).on("touchstart.brush",o),n=t.selectAll(".background").data([0]);n.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),t.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var e=t.selectAll(".resize").data(u,pt);e.exit().remove(),e.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return Ns[t]}).append("rect").attr("x",function(t){return/[ew]$/.test(t)?-3:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),e.style("display",x.empty()?"none":null);var r,i=Va.transition(t),a=Va.transition(n);N&&(r=ni(N),a.attr("x",r[0]).attr("width",r[1]-r[0]),M(i)),A&&(r=ni(A),a.attr("y",r[0]).attr("height",r[1]-r[0]),w(i)),b(i)})}function b(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+E[+/e$/.test(t)]+","+C[+/^s/.test(t)]+")"})}function M(t){t.select(".extent").attr("x",E[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",E[1]-E[0])}function w(t){t.select(".extent").attr("y",C[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",C[1]-C[0])}function o(){function t(){32==Va.event.keyCode&&(d||(f=null,_[0]-=E[1],_[1]-=C[1],d=2),T())}function n(){32==Va.event.keyCode&&2==d&&(_[0]+=E[1],_[1]+=C[1],d=0,T())}function e(){var t=Va.mouse(o),n=!1;a&&(t[0]+=a[0],t[1]+=a[1]),d||(Va.event.altKey?(f||(f=[(E[0]+E[1])/2,(C[0]+C[1])/2]),_[0]=E[+(t[0]<f[0])],_[1]=C[+(t[1]<f[1])]):f=null),h&&r(t,N,0)&&(M(l),n=!0),g&&r(t,A,1)&&(w(l),n=!0),n&&(b(l),s({type:"brush",mode:d?"move":"resize"}))}function r(t,n,e){var r,i,a=ni(n),o=a[0],u=a[1],s=_[e],l=e?C:E,c=l[1]-l[0];return d&&(o-=s,u-=c+s),r=(e?R:L)?Math.max(o,Math.min(u,t[e])):t[e],d?i=(r+=s)+c:(f&&(s=Math.max(o,Math.min(u,2*f[e]-r))),s<r?(i=r,r=s):i=s),l[0]!=r||l[1]!=i?(e?S=null:k=null,l[0]=r,l[1]=i,!0):void 0}function i(){e(),l.style("pointer-events","all").selectAll(".resize").style("display",x.empty()?"none":null),Va.select("body").style("cursor",null),v.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),p(),s({type:"brushend"})}var f,a,o=this,u=Va.select(Va.event.target),s=$.of(o,arguments),l=Va.select(o),c=u.datum(),h=!/^(n|s)$/.test(c)&&N,g=!/^(e|w)$/.test(c)&&A,d=u.classed("extent"),p=F(),_=Va.mouse(o),v=Va.select(Xa).on("keydown.brush",t).on("keyup.brush",n);if(Va.event.changedTouches?v.on("touchmove.brush",e).on("touchend.brush",i):v.on("mousemove.brush",e).on("mouseup.brush",i),l.interrupt().selectAll("*").interrupt(),d)_[0]=E[0]-_[0],_[1]=C[0]-_[1];else if(c){var y=+/w$/.test(c),m=+/^n/.test(c);a=[E[1-y]-_[0],C[1-m]-_[1]],_[0]=E[y],_[1]=C[m]}else Va.event.altKey&&(f=_.slice());l.style("pointer-events","none").selectAll(".resize").style("display",null),Va.select("body").style("cursor",u.style("cursor")),s({type:"brushstart"}),e()}var k,S,$=z(x,"brushstart","brush","brushend"),N=null,A=null,E=[0,0],C=[0,0],L=!0,R=!0,u=As[0];return x.event=function(t){t.each(function(){var r=$.of(this,arguments),i={x:E,y:C,i:k,j:S},t=this.__chart__||i;this.__chart__=i,ms?Va.select(this).transition().each("start.brush",function(){k=t.i,S=t.j,E=t.x,C=t.y,r({type:"brushstart"})}).tween("brush:brush",function(){var n=Te(E,i.x),e=Te(C,i.y);return k=S=null,function(t){E=i.x=n(t),C=i.y=e(t),r({type:"brush",mode:"resize"})}}).each("end.brush",function(){k=i.i,S=i.j,r({type:"brush",mode:"resize"}),r({type:"brushend"})}):(r({type:"brushstart"}),r({type:"brush",mode:"resize"}),r({type:"brushend"}))})},x.x=function(t){return arguments.length?(u=As[!(N=t)<<1|!A],x):N},x.y=function(t){return arguments.length?(u=As[!N<<1|!(A=t)],x):A},x.clamp=function(t){return arguments.length?(N&&A?(L=!!t[0],R=!!t[1]):N?L=!!t:A&&(R=!!t),x):N&&A?[L,R]:N?L:A?R:null},x.extent=function(t){var n,e,r,i,a;return arguments.length?(N&&(n=t[0],e=t[1],A&&(n=n[0],e=e[0]),k=[n,e],N.invert&&(n=N(n),e=N(e)),e<n&&(a=n,n=e,e=a),(n!=E[0]||e!=E[1])&&(E=[n,e])),A&&(r=t[0],i=t[1],N&&(r=r[1],i=i[1]),S=[r,i],A.invert&&(r=A(r),i=A(i)),i<r&&(a=r,r=i,i=a),(r!=C[0]||i!=C[1])&&(C=[r,i])),x):(N&&(k?(n=k[0],e=k[1]):(n=E[0],e=E[1],N.invert&&(n=N.invert(n),e=N.invert(e)),e<n&&(a=n,n=e,e=a))),A&&(S?(r=S[0],i=S[1]):(r=C[0],i=C[1],A.invert&&(r=A.invert(r),i=A.invert(i)),i<r&&(a=r,r=i,i=a))),N&&A?[[n,r],[e,i]]:N?[n,e]:A&&[r,i])},x.clear=function(){return x.empty()||(E=[0,0],C=[0,0],k=S=null),x},x.empty=function(){return!!N&&E[0]==E[1]||!!A&&C[0]==C[1]},Va.rebind(x,$,"on")};var Ns={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},As=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Es=Va.time={},Cs=Date,Ls=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];aa.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Rs.setUTCDate.apply(this._,arguments)},setDay:function(){Rs.setUTCDay.apply(this._,arguments)},setFullYear:function(){Rs.setUTCFullYear.apply(this._,arguments)},setHours:function(){Rs.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Rs.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Rs.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Rs.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Rs.setUTCSeconds.apply(this._,arguments)},setTime:function(){Rs.setTime.apply(this._,arguments)}};var Rs=Date.prototype,Ts="%a %b %e %X %Y",zs="%m/%d/%Y",Fs="%H:%M:%S",Ds=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],qs=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Ps=["January","February","March","April","May","June","July","August","September","October","November","December"],js=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];Es.year=oa(function(t){return(t=Es.day(t)).setMonth(0,1),t},function(t,n){t.setFullYear(t.getFullYear()+n)},function(t){return t.getFullYear()}),Es.years=Es.year.range,Es.years.utc=Es.year.utc.range,Es.day=oa(function(t){var n=new Cs(2e3,0);return n.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),n},function(t,n){t.setDate(t.getDate()+n)},function(t){return t.getDate()-1}),Es.days=Es.day.range,Es.days.utc=Es.day.utc.range,Es.dayOfYear=function(t){var n=Es.year(t);return Math.floor((t-n-6e4*(t.getTimezoneOffset()-n.getTimezoneOffset()))/864e5)},Ls.forEach(function(t,e){t=t.toLowerCase(),e=7-e;var n=Es[t]=oa(function(t){return(t=Es.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t},function(t,n){t.setDate(t.getDate()+7*Math.floor(n))},function(t){var n=Es.year(t).getDay();return Math.floor((Es.dayOfYear(t)+(n+e)%7)/7)-(n!==e)});Es[t+"s"]=n.range,Es[t+"s"].utc=n.utc.range,Es[t+"OfYear"]=function(t){var n=Es.year(t).getDay();return Math.floor((Es.dayOfYear(t)+(n+e)%7)/7)}}),Es.week=Es.sunday,Es.weeks=Es.sunday.range,Es.weeks.utc=Es.sunday.utc.range,Es.weekOfYear=Es.sundayOfYear,Es.format=sa;var Os=ca(Ds),Us=fa(Ds),Hs=ca(qs),Is=fa(qs),Vs=ca(Ps),Ys=fa(Ps),Bs=ca(js),Gs=fa(js),Ws=/^%/,Xs={"-":"",_:" ",0:"0"},Zs={a:function(t){return qs[t.getDay()]},A:function(t){return Ds[t.getDay()]},b:function(t){return js[t.getMonth()]},B:function(t){return Ps[t.getMonth()]},c:sa(Ts),d:function(t,n){return ha(t.getDate(),n,2)},e:function(t,n){return ha(t.getDate(),n,2)},H:function(t,n){return ha(t.getHours(),n,2)},I:function(t,n){return ha(t.getHours()%12||12,n,2)},j:function(t,n){return ha(1+Es.dayOfYear(t),n,3)},L:function(t,n){return ha(t.getMilliseconds(),n,3)},m:function(t,n){return ha(t.getMonth()+1,n,2)},M:function(t,n){return ha(t.getMinutes(),n,2)},p:function(t){return 12<=t.getHours()?"PM":"AM"},S:function(t,n){return ha(t.getSeconds(),n,2)},U:function(t,n){return ha(Es.sundayOfYear(t),n,2)},w:function(t){return t.getDay()},W:function(t,n){return ha(Es.mondayOfYear(t),n,2)},x:sa(zs),X:sa(Fs),y:function(t,n){return ha(t.getFullYear()%100,n,2)},Y:function(t,n){return ha(t.getFullYear()%1e4,n,4)},Z:Fa,"%":function(){return"%"}},Ks={a:ga,A:da,b:ya,B:ma,c:xa,d:Aa,e:Aa,H:Ca,I:Ca,j:Ea,L:Ta,m:Na,M:La,p:za,S:Ra,U:_a,w:pa,W:va,x:ba,X:Ma,y:ka,Y:wa,Z:Sa,"%":Da},Js=/^\s*\d+/,Qs=Va.map({am:0,pm:1}),tl=(sa.utc=qa)("%Y-%m-%dT%H:%M:%S.%LZ");sa.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Pa:tl,Pa.parse=function(t){var n=new Date(t);return isNaN(n)?null:n},Pa.toString=tl.toString,Es.second=oa(function(t){return new Cs(1e3*Math.floor(t/1e3))},function(t,n){t.setTime(t.getTime()+1e3*Math.floor(n))},function(t){return t.getSeconds()}),Es.seconds=Es.second.range,Es.seconds.utc=Es.second.utc.range,Es.minute=oa(function(t){return new Cs(6e4*Math.floor(t/6e4))},function(t,n){t.setTime(t.getTime()+6e4*Math.floor(n))},function(t){return t.getMinutes()}),Es.minutes=Es.minute.range,Es.minutes.utc=Es.minute.utc.range,Es.hour=oa(function(t){var n=t.getTimezoneOffset()/60;return new Cs(36e5*(Math.floor(t/36e5-n)+n))},function(t,n){t.setTime(t.getTime()+36e5*Math.floor(n))},function(t){return t.getHours()}),Es.hours=Es.hour.range,Es.hours.utc=Es.hour.utc.range,Es.month=oa(function(t){return(t=Es.day(t)).setDate(1),t},function(t,n){t.setMonth(t.getMonth()+n)},function(t){return t.getMonth()}),Es.months=Es.month.range,Es.months.utc=Es.month.utc.range;var nl=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],el=[[Es.second,1],[Es.second,5],[Es.second,15],[Es.second,30],[Es.minute,1],[Es.minute,5],[Es.minute,15],[Es.minute,30],[Es.hour,1],[Es.hour,3],[Es.hour,6],[Es.hour,12],[Es.day,1],[Es.day,2],[Es.week,1],[Es.month,1],[Es.month,3],[Es.year,1]],rl=Ua([[sa("%Y"),Vt],[sa("%B"),function(t){return t.getMonth()}],[sa("%b %d"),function(t){return 1!=t.getDate()}],[sa("%a %d"),function(t){return t.getDay()&&1!=t.getDate()}],[sa("%I %p"),function(t){return t.getHours()}],[sa("%I:%M"),function(t){return t.getMinutes()}],[sa(":%S"),function(t){return t.getSeconds()}],[sa(".%L"),function(t){return t.getMilliseconds()}]]);el.year=Es.year,Es.scale=function(){return ja(Va.scale.linear(),el,rl)};var il={range:function(t,n,e){return Va.range(+t,+n,e).map(Oa)}},al=el.map(function(t){return[t[0].utc,t[1]]}),ol=Ua([[qa("%Y"),Vt],[qa("%B"),function(t){return t.getUTCMonth()}],[qa("%b %d"),function(t){return 1!=t.getUTCDate()}],[qa("%a %d"),function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],[qa("%I %p"),function(t){return t.getUTCHours()}],[qa("%I:%M"),function(t){return t.getUTCMinutes()}],[qa(":%S"),function(t){return t.getUTCSeconds()}],[qa(".%L"),function(t){return t.getUTCMilliseconds()}]]);return al.year=Es.year.utc,Es.scale.utc=function(){return ja(Va.scale.linear(),al,ol)},Va.text=_t(function(t){return t.responseText}),Va.json=function(t,n){return vt(t,"application/json",Ha,n)},Va.html=function(t,n){return vt(t,"text/html",Ia,n)},Va.xml=_t(function(t){return t.responseXML}),Va}(),RecipeData.prototype.load=function(t,n){$.getJSON("https://www.alacalc.com/api/recipes/"+t,function(t){this.post_load(t),n()}.bind(this))},RecipeData.prototype.load_from_shared_key=function(t,n,e){$.getJSON("/api/recipes/"+t+"?key="+n,function(t){this.post_load(t),e()}.bind(this))},RecipeData.prototype.parse=function(t,n,e){$.getJSON("/api/v1/recipes/parse?ingredients="+encodeURIComponent(t)+"&num_servings="+encodeURIComponent(n),function(t){this.post_load(t),e()
}.bind(this))},RecipeData.prototype.post_load=function(t){this.recipe=t,this.ingredient_items=t.ingredient_items,this.orig_recipe=$.extend(!0,{},this.recipe),this.orig_ingredient_items=$.extend(!0,{},this.ingredient_items)},RecipeData.prototype.save=function(){var e={};$.each(["id","name","serving_size","notes"],function(t,n){e[n]=this.recipe[n]}.bind(this));var n=[];$.each(this.ingredient_items,function(t,e){ingitem={},$.each(["id","quantity"],function(t,n){ingitem[n]=e[n]}),n.push(ingitem)}),e.ingredient_items_attributes=n,$.ajax({url:"/api/v1/recipes/"+e.id,type:"PUT",data:{recipes:e},success:function(){}})},RecipeData.prototype.serving_size=function(t){return t==undefined&&(t="g"),"g"==t?this.recipe.serving_size:"oz"==t?.0352739619*this.recipe.serving_size:void 0},RecipeData.prototype.total_weight_after_cooking=function(){return this.total_weight()*(1-this.weight_loss())},RecipeData.prototype.total_weight=function(){return this.ingredient_items.map(function(t){return this.weight_of_ingredient_per_recipe(t)}.bind(this)).reduce(function(t,n){return t+n},0)},RecipeData.prototype.weight_of_ingredient_per_quantity=function(t){return t.quantity_unit.gm_wgt*t.quantity_unit.amount},RecipeData.prototype.weight_of_ingredient_per_recipe=function(t){return t.quantity*this.weight_of_ingredient_per_quantity(t)},RecipeData.prototype.weight_of_ingredient_per_g=function(t){return this.weight_of_ingredient_per_recipe(t)/this.total_weight()},RecipeData.prototype.reference_intake=function(t){var n={Energ_KJ:8400,Energ_Kcal:2e3,Lipid_Tot:70,FA_Sat:20,Carbohydrt:260,Sugar_Tot:90,Protein:50,Salt:6};return this.nutritional_value_per_serving(t)/n[t]*100},RecipeData.prototype.daily_value=function(t){var n={Energ_Kcal:2e3,Lipid_Tot:78,FA_Sat:20,Cholestrl:300,Sodium:2300,Potassium:4700,Carbohydrt:275,Fiber_TD:28,Protein:50,Vit_A_RAE:900,Vit_C:90,Calcium:1300,Iron:18,Vit_D_mcg:20,Sugar_Added:50,Thiamin:1.2,Riboflavin:1.3,Niacin:16};return this.nutritional_value_per_serving(t)/n[t]*100},RecipeData.prototype.daily_value_man=function(t){return 2e3*this.daily_value(t)/2500},RecipeData.prototype.weight_of_ingredient_per_serving=function(t){return this.weight_of_ingredient_per_g(t)*this.serving_size()},RecipeData.prototype.nutritional_value_per_100g=function(n){return this.ingredient_items.map(function(t){return this.nutritional_value_of_ingredient_per_100g(t,n)}.bind(this)).reduce(function(t,n){return t+n},0)},RecipeData.prototype.nutritional_value_per_serving=function(n){return this.ingredient_items.map(function(t){return this.nutritional_value_of_ingredient_per_serving(t,n)}.bind(this)).reduce(function(t,n){return t+n},0)},RecipeData.prototype.nutritional_value_of_ingredient_per_100g=function(t,n){return 100*this.nutritional_value_of_ingredient_per_g(t,n)},RecipeData.prototype.nutritional_value_of_ingredient_per_g=function(t,n){var e=1/(1-this.weight_loss());return t.ingredient.nutrients[n]/100*this.weight_of_ingredient_per_g(t)*e},RecipeData.prototype.weight_loss=function(){return this.recipe.weight_loss/100},RecipeData.prototype.pack_size=function(){return this.recipe.pack_size},RecipeData.prototype.nutritional_value_of_ingredient_per_recipe=function(t,n){return this.nutritional_value_of_ingredient_per_g(t,n)*this.total_weight()},RecipeData.prototype.number_of_servings=function(){return this.pack_size()/this.serving_size()},RecipeData.prototype.nutritional_value_of_ingredient_per_serving=function(t,n){return this.nutritional_value_of_ingredient_per_g(t,n)*this.serving_size()},RecipeData.prototype.sulphites_ppm=function(){var r=0;return $.each(this.ingredient_items,function(t,n){var e=n.quantity_unit.gm_wgt*n.quantity;n.ingredient.allergens.sulphites&&(r+=n.ingredient.allergens.sulphites_ppm*e)}),r/=this.total_weight()},RecipeData.prototype.derivative_of_nutritional_value_per_serving_wrt_ingredient_quantity=function(t,n){var e=Math.pow(10,-10),r=this.nutritional_value_per_serving(n),i=t.quantity;t.quantity=parseFloat(i)+e;var a=this.nutritional_value_per_serving(n);return t.quantity=i,(a-r)/e},RecipeData.prototype.derivative_of_nutritional_value_per_serving_wrt_ingredient_g=function(t,n){return this.derivative_of_nutritional_value_per_serving_wrt_ingredient_quantity(t,n)/this.weight_of_ingredient_per_quantity(t)},RecipeData.prototype.has_traffic_light_color=function(t){return this.traffic_light_limits[t]!=undefined},RecipeData.prototype.traffic_light_color_drink=function(t){var n=this.traffic_light_drink_limits[t],e=this.traffic_light_drink_portion_limit[t];if(e!=undefined&&150<this.serving_size()&&this.nutritional_value_per_serving(t)>e[1])return["red","HIGH"];if(n!=undefined){var r=this.nutritional_value_per_100g(t);return r<=n[0]?["green","LOW"]:r>n[1]?["red","HIGH"]:["orange","MED"]}},RecipeData.prototype.traffic_light_color=function(t){var n=this.traffic_light_limits[t],e=this.traffic_light_portion_limit[t];if(e!=undefined&&100<=this.serving_size()&&this.nutritional_value_per_serving(t)>e[1])return["red","HIGH"];if(n!=undefined){var r=this.nutritional_value_per_100g(t);return r<=n[0]?["green","LOW"]:r>n[1]?["red","HIGH"]:["orange","MED"]}},RecipeData.prototype.contains_gluten=function(){return-1!==$.inArray("gluten",this.allergens())},RecipeData.prototype.allergens=function(t){var r=this;if(t==undefined)t=this.ingredient_items;var i=new Array;$.each(t,function(t,n){var e=n.ingredient;e.sub_recipe==undefined?$.each(e.allergens,function(t,n){n&&i.push(t)}):i.push.apply(i,r.allergens(e.sub_recipe.ingredient_items))});var n=this.sulphites_ppm();i=i.filter(function(t){return!("sulphites"==t&&n<10||"sulphites_ppm"==t)});var e=[];return $.each(i,function(t,n){-1===$.inArray(n,e)&&e.push(n)}),e},RecipeData.prototype.declaration_names=function(t){var u=this;if(t==undefined)t=this.ingredient_items;var s=new Array,l=this.allergens();return $.each(t,function(t,n){var e=n.ingredient;if(e.sub_recipe==undefined){var r=$.trim(e.declaration_name);""==r&&(r=$.trim(e.Long_Desc));var i=new Array;$.each(e.allergens,function(t,n){n&&("sulphites_ppm"==t||"sulphites"==t&&-1==l.indexOf("sulphites")||i.push(t))}),s.push({name:r,allergens:i})}else{var a=e.Long_Desc,o=u.declaration_names(e.sub_recipe.ingredient_items);s.push({name:a,sub_names:o})}}),s},RecipeData.prototype.reset=function(){this.recipe=$.extend(!0,{},this.orig_recipe);var t=$.extend(!0,{},this.orig_ingredient_items);for(var n in this.ingredient_items=new Array,t)this.ingredient_items.push(t[n]);$("body").trigger("ingredient_values_changed")},InputFields.prototype.draw=function(){var a=this.recipe_data,r='<div class="row"><div class="col-xs-3"></div><div class="col-xs-2"></div>';$.each(targets,function(e,t){$.each(t,function(t,n){r+='<div id="header_'+e+t+'" class="col-xs-2">'+translate[e]+" "+to_math_symbol[n[0]]+" "+n[1]+" "+nutrient_unit[e]+"</div>"})}),r+="</div>",$("#ingredient_table").append(r),a.ingredient_items.map(function(i,t){var e='<div class="row input_ing input_ing_'+i.id+'">';e+='<div class="col-xs-3">',e+='<div class="name" style="display:inline;"><i class="icon-square" style = "color:'+color_code(t)+';"></i>'+i.ingredient.Long_Desc+"</div>",e+="</div>",e+='<div class="col-xs-2">',e+='<form class="form-horizontal" onsubmit="return false;">',e+='<div class="input-group">',e+='<input name="'+i.ingredient.Long_Desc+'" id="input_id'+i.id+'" min="0" value="'+i.quantity+'" class="form-control input-sm" type="number">',e+='<span class="input-group-addon">'+i.quantity_unit.desc+"</span>",e+="</div></form></div>",$.each(targets,function(n,t){$.each(t,function(t){e+='<div id="target_'+n+t+"_ing_"+i.id+'" class="col-xs-2"></div>'})}),$("#ingredient_table").append(e);var n=function(t,n){var e=i.id,r=a.ingredient_items.map(function(t){return t.id}).indexOf(e);a.ingredient_items[r].quantity=n.value||this.value,a.save(),update_targets(a),$("body").trigger("ingredient_values_changed")};$("#input_id"+i.id).spinner({step:.1,min:0,numberFormat:"n",spin:n,change:n}),$("#input_id"+i.id).trigger("change"),update_targets(a)})},InputFields.prototype["delete"]=function(){$("#ingredient_table").empty()},InputFields.prototype.redraw=function(){this["delete"](),this.draw()};var targets={};Plot.prototype.draw=function(t,n,e){this.current_style=t,this.current_divcontainer=n,this.current_svg_template=e;var r=this.plot_functions[t];if("declaration-names"==t)r(this.recipe_data,n);else if("de-svg"==t||"de-breakdown-svg"==t||"eu-svg"==t||"fda-svg"==t)r(this.recipe_data,n,e);else for(var i=0;i<nutrients.length;i++)r(this.recipe_data,nutrients[i],n)},Plot.prototype["delete"]=function(){$("#viz_top").empty().html("<div class='graph-section-label'>Nurtients</div>"),$("#viz_middle").empty().html("<div class='graph-section-label'>Colour Thresholds</div>"),$("#viz").empty().html("<div class='graph-section-label'>Ingredient Contribution</div>")},Plot.prototype.redraw=function(){this["delete"](),this.draw(this.current_style,this.current_divcontainer,this.current_svg_template)},Plot.prototype.update=function(t){this.redraw(t)};var nutrients=["Energ_Kcal","Lipid_Tot","FA_Sat","Sugar_Tot","Salt"],translate={Energ_Kcal:"Energy",Lipid_Tot:"Fat",FA_Sat:"Saturates",Sugar_Tot:"Sugar",Salt:"Salt"},translate_de={Energ_Kcal:"Energie",Lipid_Tot:"Fett",FA_Sat:"Ges\xe4ttigtes Fett",Sugar_Tot:"Zucker",Salt:"Salz"},to_math_symbol={"equal to":"=","less than":"<","more than":">"},nutrient_unit={Energ_Kcal:"kcal",Lipid_Tot:"g",FA_Sat:"g",Sugar_Tot:"g",Salt:"g"},format_number=function(t,n){n==undefined&&(n=t<10?1:0);var e=Math.pow(10,n);return Math.round(t*e)/e},color_code=d3.scale.category20b();Function.prototype.bind=function(t){var n=this;return function(){return n.apply(t,arguments)}},String.prototype.capitalize=function(){return this.replace(/(?:^|\s)\S/g,function(t){return t.toUpperCase()})};